{"ast":null,"code":"import { defineComponent, h, computed } from 'vue';\nimport { hsv2rgb, hsva, toRgbaString } from 'seemly';\nimport { convertColor, getModeFromValue } from './utils';\nimport { warn } from '../../_utils'; // Try to normalize the color values to ensure that they are valid CSS colors\n\nfunction normalizeColor(color, mode) {\n  if (mode === 'hsv') {\n    const [h, s, v, a] = hsva(color);\n    return toRgbaString([...hsv2rgb(h, s, v), a]);\n  } // For the mode that is not in preset, we keep the original value.\n  // For color names, they are legal to CSS, so we don’t deal with them,\n  // and only standardize them when outputting.\n\n\n  return color;\n}\n\nfunction getHexFromName(color) {\n  const ctx = document.createElement('canvas').getContext('2d');\n  ctx.fillStyle = color;\n  return ctx.fillStyle;\n}\n\nexport default defineComponent({\n  name: 'ColorPickerSwatches',\n  props: {\n    clsPrefix: {\n      type: String,\n      required: true\n    },\n    mode: {\n      type: String,\n      required: true\n    },\n    swatches: {\n      type: Array,\n      required: true\n    },\n    onUpdateColor: {\n      type: Function,\n      required: true\n    }\n  },\n\n  setup(props) {\n    const parsedSwatchesRef = computed(() => props.swatches.map(value => {\n      const mode = getModeFromValue(value);\n      return {\n        value,\n        mode,\n        legalValue: normalizeColor(value, mode)\n      };\n    }));\n\n    function normalizeOutput(parsed) {\n      const {\n        mode: modeProp\n      } = props;\n      let {\n        value,\n        mode: swatchColorMode\n      } = parsed; // color name is converted to hex\n\n      if (!swatchColorMode) {\n        swatchColorMode = 'hex';\n\n        if (/^[a-zA-Z]+$/.test(value)) {\n          value = getHexFromName(value);\n        } else {\n          // for invalid color, we make it black\n          warn('color-picker', `color ${value} in swatches is invalid.`);\n          value = '#000000';\n        }\n      }\n\n      if (swatchColorMode === modeProp) return value; // swatch value to current mode value\n\n      return convertColor(value, modeProp, swatchColorMode);\n    }\n\n    function handleSwatchSelect(parsed) {\n      props.onUpdateColor(normalizeOutput(parsed));\n    }\n\n    function handleSwatchKeyDown(e, parsed) {\n      if (e.key === 'Enter') handleSwatchSelect(parsed);\n    }\n\n    return {\n      parsedSwatchesRef,\n      handleSwatchSelect,\n      handleSwatchKeyDown\n    };\n  },\n\n  render() {\n    const {\n      clsPrefix\n    } = this;\n    return h(\"div\", {\n      class: `${clsPrefix}-color-picker-swatches`\n    }, this.parsedSwatchesRef.map(swatch => h(\"div\", {\n      class: `${clsPrefix}-color-picker-swatch`,\n      tabindex: 0,\n      onClick: () => this.handleSwatchSelect(swatch),\n      onKeydown: e => this.handleSwatchKeyDown(e, swatch)\n    }, h(\"div\", {\n      class: `${clsPrefix}-color-picker-swatch__fill`,\n      style: {\n        background: swatch.legalValue\n      }\n    }))));\n  }\n\n});","map":{"version":3,"sources":["G:/VUE_FDS/fluent-vue/node_modules/naive-ui/es/color-picker/src/ColorPickerSwatches.js"],"names":["defineComponent","h","computed","hsv2rgb","hsva","toRgbaString","convertColor","getModeFromValue","warn","normalizeColor","color","mode","s","v","a","getHexFromName","ctx","document","createElement","getContext","fillStyle","name","props","clsPrefix","type","String","required","swatches","Array","onUpdateColor","Function","setup","parsedSwatchesRef","map","value","legalValue","normalizeOutput","parsed","modeProp","swatchColorMode","test","handleSwatchSelect","handleSwatchKeyDown","e","key","render","class","swatch","tabindex","onClick","onKeydown","style","background"],"mappings":"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","sourcesContent":["import { defineComponent, h, computed } from 'vue';\nimport { hsv2rgb, hsva, toRgbaString } from 'seemly';\nimport { convertColor, getModeFromValue } from './utils';\nimport { warn } from '../../_utils';\n// Try to normalize the color values to ensure that they are valid CSS colors\nfunction normalizeColor(color, mode) {\n    if (mode === 'hsv') {\n        const [h, s, v, a] = hsva(color);\n        return toRgbaString([...hsv2rgb(h, s, v), a]);\n    }\n    // For the mode that is not in preset, we keep the original value.\n    // For color names, they are legal to CSS, so we don’t deal with them,\n    // and only standardize them when outputting.\n    return color;\n}\nfunction getHexFromName(color) {\n    const ctx = document\n        .createElement('canvas')\n        .getContext('2d');\n    ctx.fillStyle = color;\n    return ctx.fillStyle;\n}\nexport default defineComponent({\n    name: 'ColorPickerSwatches',\n    props: {\n        clsPrefix: {\n            type: String,\n            required: true\n        },\n        mode: {\n            type: String,\n            required: true\n        },\n        swatches: {\n            type: Array,\n            required: true\n        },\n        onUpdateColor: {\n            type: Function,\n            required: true\n        }\n    },\n    setup(props) {\n        const parsedSwatchesRef = computed(() => props.swatches.map((value) => {\n            const mode = getModeFromValue(value);\n            return {\n                value,\n                mode,\n                legalValue: normalizeColor(value, mode)\n            };\n        }));\n        function normalizeOutput(parsed) {\n            const { mode: modeProp } = props;\n            let { value, mode: swatchColorMode } = parsed;\n            // color name is converted to hex\n            if (!swatchColorMode) {\n                swatchColorMode = 'hex';\n                if (/^[a-zA-Z]+$/.test(value)) {\n                    value = getHexFromName(value);\n                }\n                else {\n                    // for invalid color, we make it black\n                    warn('color-picker', `color ${value} in swatches is invalid.`);\n                    value = '#000000';\n                }\n            }\n            if (swatchColorMode === modeProp)\n                return value;\n            // swatch value to current mode value\n            return convertColor(value, modeProp, swatchColorMode);\n        }\n        function handleSwatchSelect(parsed) {\n            props.onUpdateColor(normalizeOutput(parsed));\n        }\n        function handleSwatchKeyDown(e, parsed) {\n            if (e.key === 'Enter')\n                handleSwatchSelect(parsed);\n        }\n        return {\n            parsedSwatchesRef,\n            handleSwatchSelect,\n            handleSwatchKeyDown\n        };\n    },\n    render() {\n        const { clsPrefix } = this;\n        return (h(\"div\", { class: `${clsPrefix}-color-picker-swatches` }, this.parsedSwatchesRef.map((swatch) => (h(\"div\", { class: `${clsPrefix}-color-picker-swatch`, tabindex: 0, onClick: () => this.handleSwatchSelect(swatch), onKeydown: (e) => this.handleSwatchKeyDown(e, swatch) },\n            h(\"div\", { class: `${clsPrefix}-color-picker-swatch__fill`, style: { background: swatch.legalValue } }))))));\n    }\n});\n"]},"metadata":{},"sourceType":"module"}