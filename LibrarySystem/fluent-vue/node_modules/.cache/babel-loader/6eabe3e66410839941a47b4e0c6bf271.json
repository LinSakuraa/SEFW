{"ast":null,"code":"import { h, computed, inject, defineComponent, Transition } from 'vue';\nimport { useMemo } from 'vooks';\nimport { NCheckbox } from '../../checkbox';\nimport { NBaseLoading, NBaseIcon } from '../../_internal';\nimport { ChevronRightIcon, CheckmarkIcon } from '../../_internal/icons';\nimport { cascaderInjectionKey } from './interface';\nimport { happensIn } from 'seemly';\nexport default defineComponent({\n  name: 'NCascaderOption',\n  props: {\n    tmNode: {\n      type: Object,\n      required: true\n    }\n  },\n\n  setup(props) {\n    const {\n      expandTriggerRef,\n      remoteRef,\n      multipleRef,\n      mergedValueRef,\n      checkedKeysRef,\n      indeterminateKeysRef,\n      hoverKeyPathRef,\n      keyboardKeyRef,\n      loadingKeySetRef,\n      cascadeRef,\n      mergedCheckStrategyRef,\n      onLoadRef,\n      mergedClsPrefixRef,\n      mergedThemeRef,\n      labelFieldRef,\n      updateHoverKey,\n      updateKeyboardKey,\n      addLoadingKey,\n      deleteLoadingKey,\n      closeMenu,\n      doCheck,\n      doUncheck,\n      renderLabelRef // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n\n    } = inject(cascaderInjectionKey);\n    const valueRef = computed(() => props.tmNode.key);\n    const useHoverTriggerRef = computed(() => {\n      const {\n        value: expandTrigger\n      } = expandTriggerRef;\n      const {\n        value: remote\n      } = remoteRef;\n      return !remote && expandTrigger === 'hover';\n    });\n    const mergedHandleMouseEnterRef = computed(() => {\n      if (useHoverTriggerRef.value) {\n        return handleMouseEnter;\n      }\n\n      return undefined;\n    });\n    const mergedHandleMouseMoveRef = computed(() => {\n      if (useHoverTriggerRef.value) {\n        return handleMouseMove;\n      }\n\n      return undefined;\n    });\n    const checkedRef = useMemo(() => {\n      const {\n        value: multiple\n      } = multipleRef;\n      if (!multiple) return mergedValueRef.value === valueRef.value;\n      return checkedKeysRef.value.includes(valueRef.value);\n    });\n    const indeterminateRef = useMemo(() => {\n      if (!multipleRef.value) return false;\n      return indeterminateKeysRef.value.includes(valueRef.value);\n    });\n    const hoverPendingRef = useMemo(() => {\n      return hoverKeyPathRef.value.includes(valueRef.value);\n    });\n    const keyboardPendingRef = useMemo(() => {\n      const {\n        value: keyboardKey\n      } = keyboardKeyRef;\n      if (keyboardKey === null) return false;\n      return keyboardKey === valueRef.value;\n    });\n    const isLoadingRef = useMemo(() => {\n      if (remoteRef.value) {\n        return loadingKeySetRef.value.has(valueRef.value);\n      }\n\n      return false;\n    });\n    const showCheckboxRef = computed(() => {\n      if (multipleRef.value && cascadeRef.value) return true;\n      if (mergedCheckStrategyRef.value !== 'child') return true;\n    });\n    const isLeafRef = computed(() => props.tmNode.isLeaf);\n    const disabledRef = computed(() => props.tmNode.disabled);\n    const labelRef = computed(() => props.tmNode.rawNode[labelFieldRef.value]);\n    const isShallowLoadedRef = computed(() => {\n      return props.tmNode.shallowLoaded;\n    });\n\n    function handleClick(e) {\n      if (disabledRef.value) return;\n      const {\n        value: remote\n      } = remoteRef;\n      const {\n        value: loadingKeySet\n      } = loadingKeySetRef;\n      const {\n        value: onLoad\n      } = onLoadRef;\n      const {\n        value\n      } = valueRef;\n      const {\n        value: isLeaf\n      } = isLeafRef;\n      const {\n        value: isShallowLoaded\n      } = isShallowLoadedRef;\n\n      if (!happensIn(e, 'checkbox')) {\n        if (remote && !isShallowLoaded && !loadingKeySet.has(value) && onLoad) {\n          addLoadingKey(value);\n          onLoad(props.tmNode.rawNode).then(() => {\n            deleteLoadingKey(value);\n          }).catch(() => {\n            deleteLoadingKey(value);\n          });\n        }\n\n        updateHoverKey(value);\n        updateKeyboardKey(value);\n      }\n\n      if (isLeaf) {\n        toggleCheckbox();\n      }\n    }\n\n    function handleMouseEnter() {\n      if (!useHoverTriggerRef.value || disabledRef.value) return;\n      const {\n        value\n      } = valueRef;\n      updateHoverKey(value);\n      updateKeyboardKey(value);\n    }\n\n    function handleMouseMove() {\n      if (!useHoverTriggerRef.value) return;\n      handleMouseEnter();\n    }\n\n    function handleCheckboxUpdateValue() {\n      const {\n        value: isLeaf\n      } = isLeafRef;\n      if (!isLeaf) toggleCheckbox();\n    }\n\n    function toggleCheckbox() {\n      const {\n        value: multiple\n      } = multipleRef;\n      const {\n        value\n      } = valueRef;\n\n      if (multiple) {\n        if (indeterminateRef.value || checkedRef.value) {\n          doUncheck(value);\n        } else {\n          doCheck(value);\n        }\n      } else {\n        doCheck(value);\n        closeMenu(true);\n      }\n    }\n\n    return {\n      checkStrategy: mergedCheckStrategyRef,\n      multiple: multipleRef,\n      cascade: cascadeRef,\n      checked: checkedRef,\n      indeterminate: indeterminateRef,\n      hoverPending: hoverPendingRef,\n      keyboardPending: keyboardPendingRef,\n      isLoading: isLoadingRef,\n      showCheckbox: showCheckboxRef,\n      isLeaf: isLeafRef,\n      disabled: disabledRef,\n      label: labelRef,\n      mergedClsPrefix: mergedClsPrefixRef,\n      mergedTheme: mergedThemeRef,\n      handleClick,\n      handleCheckboxUpdateValue,\n      mergedHandleMouseEnter: mergedHandleMouseEnterRef,\n      mergedHandleMouseMove: mergedHandleMouseMoveRef,\n      renderLabel: renderLabelRef\n    };\n  },\n\n  render() {\n    const {\n      mergedClsPrefix,\n      renderLabel\n    } = this;\n    return h(\"div\", {\n      class: [`${mergedClsPrefix}-cascader-option`, {\n        [`${mergedClsPrefix}-cascader-option--pending`]: this.keyboardPending || this.hoverPending,\n        [`${mergedClsPrefix}-cascader-option--disabled`]: this.disabled,\n        [`${mergedClsPrefix}-cascader-option--show-prefix`]: this.showCheckbox\n      }],\n      onMouseenter: this.mergedHandleMouseEnter,\n      onMousemove: this.mergedHandleMouseMove,\n      onClick: this.handleClick\n    }, this.showCheckbox ? h(\"div\", {\n      class: `${mergedClsPrefix}-cascader-option__prefix`\n    }, h(NCheckbox, {\n      focusable: false,\n      \"data-checkbox\": true,\n      disabled: this.disabled,\n      checked: this.checked,\n      indeterminate: this.indeterminate,\n      theme: this.mergedTheme.peers.Checkbox,\n      themeOverrides: this.mergedTheme.peerOverrides.Checkbox,\n      onUpdateChecked: this.handleCheckboxUpdateValue\n    })) : null, h(\"span\", {\n      class: `${mergedClsPrefix}-cascader-option__label`\n    }, renderLabel ? renderLabel(this.tmNode.rawNode, this.checked) : this.label), h(\"div\", {\n      class: `${mergedClsPrefix}-cascader-option__suffix`\n    }, h(\"div\", {\n      class: `${mergedClsPrefix}-cascader-option-icon-placeholder`\n    }, !this.isLeaf ? h(NBaseLoading, {\n      clsPrefix: mergedClsPrefix,\n      scale: 0.85,\n      strokeWidth: 24,\n      show: this.isLoading,\n      class: `${mergedClsPrefix}-cascader-option-icon`\n    }, {\n      default: () => h(NBaseIcon, {\n        clsPrefix: mergedClsPrefix,\n        key: \"arrow\",\n        class: `${mergedClsPrefix}-cascader-option-icon ${mergedClsPrefix}-cascader-option-icon--arrow`\n      }, {\n        default: () => h(ChevronRightIcon, null)\n      })\n    }) : this.checkStrategy === 'child' && !(this.multiple && this.cascade) ? h(Transition, {\n      name: \"fade-in-scale-up-transition\"\n    }, {\n      default: () => this.checked ? h(NBaseIcon, {\n        clsPrefix: mergedClsPrefix,\n        class: `${mergedClsPrefix}-cascader-option-icon ${mergedClsPrefix}-cascader-option-icon--checkmark`\n      }, {\n        default: () => h(CheckmarkIcon, null)\n      }) : null\n    }) : null)));\n  }\n\n});","map":{"version":3,"sources":["G:/VUE_FDS/fluent-vue/node_modules/naive-ui/es/cascader/src/CascaderOption.js"],"names":["h","computed","inject","defineComponent","Transition","useMemo","NCheckbox","NBaseLoading","NBaseIcon","ChevronRightIcon","CheckmarkIcon","cascaderInjectionKey","happensIn","name","props","tmNode","type","Object","required","setup","expandTriggerRef","remoteRef","multipleRef","mergedValueRef","checkedKeysRef","indeterminateKeysRef","hoverKeyPathRef","keyboardKeyRef","loadingKeySetRef","cascadeRef","mergedCheckStrategyRef","onLoadRef","mergedClsPrefixRef","mergedThemeRef","labelFieldRef","updateHoverKey","updateKeyboardKey","addLoadingKey","deleteLoadingKey","closeMenu","doCheck","doUncheck","renderLabelRef","valueRef","key","useHoverTriggerRef","value","expandTrigger","remote","mergedHandleMouseEnterRef","handleMouseEnter","undefined","mergedHandleMouseMoveRef","handleMouseMove","checkedRef","multiple","includes","indeterminateRef","hoverPendingRef","keyboardPendingRef","keyboardKey","isLoadingRef","has","showCheckboxRef","isLeafRef","isLeaf","disabledRef","disabled","labelRef","rawNode","isShallowLoadedRef","shallowLoaded","handleClick","e","loadingKeySet","onLoad","isShallowLoaded","then","catch","toggleCheckbox","handleCheckboxUpdateValue","checkStrategy","cascade","checked","indeterminate","hoverPending","keyboardPending","isLoading","showCheckbox","label","mergedClsPrefix","mergedTheme","mergedHandleMouseEnter","mergedHandleMouseMove","renderLabel","render","class","onMouseenter","onMousemove","onClick","focusable","theme","peers","Checkbox","themeOverrides","peerOverrides","onUpdateChecked","clsPrefix","scale","strokeWidth","show","default"],"mappings":"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","sourcesContent":["import { h, computed, inject, defineComponent, Transition } from 'vue';\nimport { useMemo } from 'vooks';\nimport { NCheckbox } from '../../checkbox';\nimport { NBaseLoading, NBaseIcon } from '../../_internal';\nimport { ChevronRightIcon, CheckmarkIcon } from '../../_internal/icons';\nimport { cascaderInjectionKey } from './interface';\nimport { happensIn } from 'seemly';\nexport default defineComponent({\n    name: 'NCascaderOption',\n    props: {\n        tmNode: {\n            type: Object,\n            required: true\n        }\n    },\n    setup(props) {\n        const { expandTriggerRef, remoteRef, multipleRef, mergedValueRef, checkedKeysRef, indeterminateKeysRef, hoverKeyPathRef, keyboardKeyRef, loadingKeySetRef, cascadeRef, mergedCheckStrategyRef, onLoadRef, mergedClsPrefixRef, mergedThemeRef, labelFieldRef, updateHoverKey, updateKeyboardKey, addLoadingKey, deleteLoadingKey, closeMenu, doCheck, doUncheck, renderLabelRef\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n         } = inject(cascaderInjectionKey);\n        const valueRef = computed(() => props.tmNode.key);\n        const useHoverTriggerRef = computed(() => {\n            const { value: expandTrigger } = expandTriggerRef;\n            const { value: remote } = remoteRef;\n            return !remote && expandTrigger === 'hover';\n        });\n        const mergedHandleMouseEnterRef = computed(() => {\n            if (useHoverTriggerRef.value) {\n                return handleMouseEnter;\n            }\n            return undefined;\n        });\n        const mergedHandleMouseMoveRef = computed(() => {\n            if (useHoverTriggerRef.value) {\n                return handleMouseMove;\n            }\n            return undefined;\n        });\n        const checkedRef = useMemo(() => {\n            const { value: multiple } = multipleRef;\n            if (!multiple)\n                return mergedValueRef.value === valueRef.value;\n            return checkedKeysRef.value.includes(valueRef.value);\n        });\n        const indeterminateRef = useMemo(() => {\n            if (!multipleRef.value)\n                return false;\n            return indeterminateKeysRef.value.includes(valueRef.value);\n        });\n        const hoverPendingRef = useMemo(() => {\n            return hoverKeyPathRef.value.includes(valueRef.value);\n        });\n        const keyboardPendingRef = useMemo(() => {\n            const { value: keyboardKey } = keyboardKeyRef;\n            if (keyboardKey === null)\n                return false;\n            return keyboardKey === valueRef.value;\n        });\n        const isLoadingRef = useMemo(() => {\n            if (remoteRef.value) {\n                return loadingKeySetRef.value.has(valueRef.value);\n            }\n            return false;\n        });\n        const showCheckboxRef = computed(() => {\n            if (multipleRef.value && cascadeRef.value)\n                return true;\n            if (mergedCheckStrategyRef.value !== 'child')\n                return true;\n        });\n        const isLeafRef = computed(() => props.tmNode.isLeaf);\n        const disabledRef = computed(() => props.tmNode.disabled);\n        const labelRef = computed(() => props.tmNode.rawNode[labelFieldRef.value]);\n        const isShallowLoadedRef = computed(() => {\n            return props.tmNode.shallowLoaded;\n        });\n        function handleClick(e) {\n            if (disabledRef.value)\n                return;\n            const { value: remote } = remoteRef;\n            const { value: loadingKeySet } = loadingKeySetRef;\n            const { value: onLoad } = onLoadRef;\n            const { value } = valueRef;\n            const { value: isLeaf } = isLeafRef;\n            const { value: isShallowLoaded } = isShallowLoadedRef;\n            if (!happensIn(e, 'checkbox')) {\n                if (remote && !isShallowLoaded && !loadingKeySet.has(value) && onLoad) {\n                    addLoadingKey(value);\n                    onLoad(props.tmNode.rawNode)\n                        .then(() => {\n                        deleteLoadingKey(value);\n                    })\n                        .catch(() => {\n                        deleteLoadingKey(value);\n                    });\n                }\n                updateHoverKey(value);\n                updateKeyboardKey(value);\n            }\n            if (isLeaf) {\n                toggleCheckbox();\n            }\n        }\n        function handleMouseEnter() {\n            if (!useHoverTriggerRef.value || disabledRef.value)\n                return;\n            const { value } = valueRef;\n            updateHoverKey(value);\n            updateKeyboardKey(value);\n        }\n        function handleMouseMove() {\n            if (!useHoverTriggerRef.value)\n                return;\n            handleMouseEnter();\n        }\n        function handleCheckboxUpdateValue() {\n            const { value: isLeaf } = isLeafRef;\n            if (!isLeaf)\n                toggleCheckbox();\n        }\n        function toggleCheckbox() {\n            const { value: multiple } = multipleRef;\n            const { value } = valueRef;\n            if (multiple) {\n                if (indeterminateRef.value || checkedRef.value) {\n                    doUncheck(value);\n                }\n                else {\n                    doCheck(value);\n                }\n            }\n            else {\n                doCheck(value);\n                closeMenu(true);\n            }\n        }\n        return {\n            checkStrategy: mergedCheckStrategyRef,\n            multiple: multipleRef,\n            cascade: cascadeRef,\n            checked: checkedRef,\n            indeterminate: indeterminateRef,\n            hoverPending: hoverPendingRef,\n            keyboardPending: keyboardPendingRef,\n            isLoading: isLoadingRef,\n            showCheckbox: showCheckboxRef,\n            isLeaf: isLeafRef,\n            disabled: disabledRef,\n            label: labelRef,\n            mergedClsPrefix: mergedClsPrefixRef,\n            mergedTheme: mergedThemeRef,\n            handleClick,\n            handleCheckboxUpdateValue,\n            mergedHandleMouseEnter: mergedHandleMouseEnterRef,\n            mergedHandleMouseMove: mergedHandleMouseMoveRef,\n            renderLabel: renderLabelRef\n        };\n    },\n    render() {\n        const { mergedClsPrefix, renderLabel } = this;\n        return (h(\"div\", { class: [\n                `${mergedClsPrefix}-cascader-option`,\n                {\n                    [`${mergedClsPrefix}-cascader-option--pending`]: this.keyboardPending || this.hoverPending,\n                    [`${mergedClsPrefix}-cascader-option--disabled`]: this.disabled,\n                    [`${mergedClsPrefix}-cascader-option--show-prefix`]: this.showCheckbox\n                }\n            ], onMouseenter: this.mergedHandleMouseEnter, onMousemove: this.mergedHandleMouseMove, onClick: this.handleClick },\n            this.showCheckbox ? (h(\"div\", { class: `${mergedClsPrefix}-cascader-option__prefix` },\n                h(NCheckbox, { focusable: false, \"data-checkbox\": true, disabled: this.disabled, checked: this.checked, indeterminate: this.indeterminate, theme: this.mergedTheme.peers.Checkbox, themeOverrides: this.mergedTheme.peerOverrides.Checkbox, onUpdateChecked: this.handleCheckboxUpdateValue }))) : null,\n            h(\"span\", { class: `${mergedClsPrefix}-cascader-option__label` }, renderLabel\n                ? renderLabel(this.tmNode.rawNode, this.checked)\n                : this.label),\n            h(\"div\", { class: `${mergedClsPrefix}-cascader-option__suffix` },\n                h(\"div\", { class: `${mergedClsPrefix}-cascader-option-icon-placeholder` }, !this.isLeaf ? (h(NBaseLoading, { clsPrefix: mergedClsPrefix, scale: 0.85, strokeWidth: 24, show: this.isLoading, class: `${mergedClsPrefix}-cascader-option-icon` }, {\n                    default: () => (h(NBaseIcon, { clsPrefix: mergedClsPrefix, key: \"arrow\", class: `${mergedClsPrefix}-cascader-option-icon ${mergedClsPrefix}-cascader-option-icon--arrow` }, {\n                        default: () => h(ChevronRightIcon, null)\n                    }))\n                })) : this.checkStrategy === 'child' &&\n                    !(this.multiple && this.cascade) ? (h(Transition, { name: \"fade-in-scale-up-transition\" }, {\n                    default: () => this.checked ? (h(NBaseIcon, { clsPrefix: mergedClsPrefix, class: `${mergedClsPrefix}-cascader-option-icon ${mergedClsPrefix}-cascader-option-icon--checkmark` }, { default: () => h(CheckmarkIcon, null) })) : null\n                })) : null))));\n    }\n});\n"]},"metadata":{},"sourceType":"module"}