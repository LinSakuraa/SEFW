{"ast":null,"code":"/* eslint-disable @typescript-eslint/strict-boolean-expressions */\n\n/* eslint-disable @typescript-eslint/no-non-null-assertion */\nimport { ref, readonly, onBeforeMount, onBeforeUnmount } from 'vue';\nimport { hasInstance } from './utils';\nlet usedCount = 0; // Mql means media query list\n\nconst supportMatchMedia = typeof window !== 'undefined' && window.matchMedia !== undefined;\nconst osTheme = ref(null);\nlet darkMql;\nlet lightMql;\n\nfunction handleDarkMqlChange(e) {\n  if (e.matches) {\n    osTheme.value = 'dark';\n  }\n}\n\nfunction handleLightMqlChange(e) {\n  if (e.matches) {\n    osTheme.value = 'light';\n  }\n}\n\nfunction init() {\n  darkMql = window.matchMedia('(prefers-color-scheme: dark)');\n  lightMql = window.matchMedia('(prefers-color-scheme: light)');\n\n  if (darkMql.matches) {\n    osTheme.value = 'dark';\n  } else if (lightMql.matches) {\n    osTheme.value = 'light';\n  } else {\n    osTheme.value = null;\n  }\n\n  if (darkMql.addEventListener) {\n    darkMql.addEventListener('change', handleDarkMqlChange);\n    lightMql.addEventListener('change', handleLightMqlChange);\n  } else if (darkMql.addListener) {\n    darkMql.addListener(handleDarkMqlChange);\n    lightMql.addListener(handleLightMqlChange);\n  }\n}\n\nfunction clean() {\n  if ('removeEventListener' in darkMql) {\n    darkMql.removeEventListener('change', handleDarkMqlChange);\n    lightMql.removeEventListener('change', handleLightMqlChange);\n  } else if ('removeListener' in darkMql) {\n    darkMql.removeListener(handleDarkMqlChange);\n    lightMql.removeListener(handleLightMqlChange);\n  }\n\n  darkMql = undefined;\n  lightMql = undefined;\n}\n\nlet managable = true;\nexport default function useOsTheme() {\n  /* istanbul ignore next */\n  if (process.env.NODE_ENV !== 'test' && !supportMatchMedia) {\n    return readonly(osTheme);\n  }\n\n  if (process.env.NODE_ENV === 'test' && window.matchMedia === undefined) {\n    return readonly(osTheme);\n  }\n\n  if (usedCount === 0) init();\n\n  if (managable && (managable = hasInstance())) {\n    onBeforeMount(() => {\n      usedCount += 1;\n    });\n    onBeforeUnmount(() => {\n      usedCount -= 1;\n      if (usedCount === 0) clean();\n    });\n  }\n\n  return readonly(osTheme);\n}","map":{"version":3,"sources":["G:/VUE_FDS/fluent-vue/node_modules/vooks/es/use-os-theme.js"],"names":["ref","readonly","onBeforeMount","onBeforeUnmount","hasInstance","usedCount","supportMatchMedia","window","matchMedia","undefined","osTheme","darkMql","lightMql","handleDarkMqlChange","e","matches","value","handleLightMqlChange","init","addEventListener","addListener","clean","removeEventListener","removeListener","managable","useOsTheme","process","env","NODE_ENV"],"mappings":"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","sourcesContent":["/* eslint-disable @typescript-eslint/strict-boolean-expressions */\n/* eslint-disable @typescript-eslint/no-non-null-assertion */\nimport { ref, readonly, onBeforeMount, onBeforeUnmount } from 'vue';\nimport { hasInstance } from './utils';\nlet usedCount = 0;\n// Mql means media query list\nconst supportMatchMedia = typeof window !== 'undefined' && window.matchMedia !== undefined;\nconst osTheme = ref(null);\nlet darkMql;\nlet lightMql;\nfunction handleDarkMqlChange(e) {\n    if (e.matches) {\n        osTheme.value = 'dark';\n    }\n}\nfunction handleLightMqlChange(e) {\n    if (e.matches) {\n        osTheme.value = 'light';\n    }\n}\nfunction init() {\n    darkMql = window.matchMedia('(prefers-color-scheme: dark)');\n    lightMql = window.matchMedia('(prefers-color-scheme: light)');\n    if (darkMql.matches) {\n        osTheme.value = 'dark';\n    }\n    else if (lightMql.matches) {\n        osTheme.value = 'light';\n    }\n    else {\n        osTheme.value = null;\n    }\n    if (darkMql.addEventListener) {\n        darkMql.addEventListener('change', handleDarkMqlChange);\n        lightMql.addEventListener('change', handleLightMqlChange);\n    }\n    else if (darkMql.addListener) {\n        darkMql.addListener(handleDarkMqlChange);\n        lightMql.addListener(handleLightMqlChange);\n    }\n}\nfunction clean() {\n    if ('removeEventListener' in darkMql) {\n        darkMql.removeEventListener('change', handleDarkMqlChange);\n        lightMql.removeEventListener('change', handleLightMqlChange);\n    }\n    else if ('removeListener' in darkMql) {\n        darkMql.removeListener(handleDarkMqlChange);\n        lightMql.removeListener(handleLightMqlChange);\n    }\n    darkMql = undefined;\n    lightMql = undefined;\n}\nlet managable = true;\nexport default function useOsTheme() {\n    /* istanbul ignore next */\n    if (process.env.NODE_ENV !== 'test' && !supportMatchMedia) {\n        return readonly(osTheme);\n    }\n    if (process.env.NODE_ENV === 'test' && window.matchMedia === undefined) {\n        return readonly(osTheme);\n    }\n    if (usedCount === 0)\n        init();\n    if (managable && (managable = hasInstance())) {\n        onBeforeMount(() => {\n            usedCount += 1;\n        });\n        onBeforeUnmount(() => {\n            usedCount -= 1;\n            if (usedCount === 0)\n                clean();\n        });\n    }\n    return readonly(osTheme);\n}\n"]},"metadata":{},"sourceType":"module"}