{"ast":null,"code":"import { h, ref, defineComponent, watch, toRef, inject, nextTick, Transition, withDirectives } from 'vue';\nimport { clickoutside } from 'vdirs';\nimport FocusDetector from '../../_internal/focus-detector';\nimport { resolveSlot, resolveWrappedSlot } from '../../_utils';\nimport { NEmpty } from '../../empty';\nimport { NBaseMenuMask } from '../../_internal';\nimport NCascaderSubmenu from './CascaderSubmenu';\nimport { cascaderInjectionKey } from './interface';\nexport default defineComponent({\n  name: 'NCascaderMenu',\n  props: {\n    value: [String, Number, Array],\n    placement: {\n      type: String,\n      default: 'bottom-start'\n    },\n    show: Boolean,\n    menuModel: {\n      type: Array,\n      required: true\n    },\n    loading: Boolean,\n    onFocus: {\n      type: Function,\n      required: true\n    },\n    onBlur: {\n      type: Function,\n      required: true\n    },\n    onKeyup: {\n      type: Function,\n      required: true\n    },\n    onMousedown: {\n      type: Function,\n      required: true\n    },\n    onTabout: {\n      type: Function,\n      required: true\n    }\n  },\n\n  setup(props) {\n    const {\n      localeRef,\n      isMountedRef,\n      mergedClsPrefixRef,\n      syncCascaderMenuPosition,\n      handleCascaderMenuClickOutside,\n      mergedThemeRef // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n\n    } = inject(cascaderInjectionKey);\n    const submenuInstRefs = [];\n    const maskInstRef = ref(null);\n    const selfElRef = ref(null);\n    watch(toRef(props, 'value'), () => {\n      void nextTick(() => {\n        syncCascaderMenuPosition();\n      });\n    });\n    watch(toRef(props, 'menuModel'), () => {\n      void nextTick(() => {\n        syncCascaderMenuPosition();\n      });\n    });\n\n    function showErrorMessage(label) {\n      var _a;\n\n      const {\n        value: {\n          loadingRequiredMessage\n        }\n      } = localeRef;\n      (_a = maskInstRef.value) === null || _a === void 0 ? void 0 : _a.showOnce(loadingRequiredMessage(label));\n    }\n\n    function handleClickOutside(e) {\n      handleCascaderMenuClickOutside(e);\n    }\n\n    function handleFocusin(e) {\n      const {\n        value: selfEl\n      } = selfElRef;\n      if (!selfEl) return;\n\n      if (!selfEl.contains(e.relatedTarget)) {\n        props.onFocus(e);\n      }\n    }\n\n    function handleFocusout(e) {\n      const {\n        value: selfEl\n      } = selfElRef;\n      if (!selfEl) return;\n\n      if (!selfEl.contains(e.relatedTarget)) {\n        props.onBlur(e);\n      }\n    }\n\n    const exposedRef = {\n      scroll(depth, index, elSize) {\n        const submenuInst = submenuInstRefs[depth];\n\n        if (submenuInst) {\n          submenuInst.scroll(index, elSize);\n        }\n      },\n\n      showErrorMessage\n    };\n    return Object.assign({\n      isMounted: isMountedRef,\n      mergedClsPrefix: mergedClsPrefixRef,\n      selfElRef,\n      submenuInstRefs,\n      maskInstRef,\n      mergedTheme: mergedThemeRef,\n      handleFocusin,\n      handleFocusout,\n      handleClickOutside\n    }, exposedRef);\n  },\n\n  render() {\n    const {\n      submenuInstRefs,\n      mergedClsPrefix,\n      mergedTheme\n    } = this;\n    return h(Transition, {\n      name: \"fade-in-scale-up-transition\",\n      appear: this.isMounted\n    }, {\n      default: () => {\n        if (!this.show) return null;\n        return withDirectives(h(\"div\", {\n          tabindex: \"0\",\n          ref: \"selfElRef\",\n          class: `${mergedClsPrefix}-cascader-menu`,\n          onMousedown: this.onMousedown,\n          onFocusin: this.handleFocusin,\n          onFocusout: this.handleFocusout,\n          onKeyup: this.onKeyup,\n          style: {\n            '--n-col-count': this.menuModel.length\n          }\n        }, this.menuModel[0].length ? h(\"div\", {\n          class: `${mergedClsPrefix}-cascader-submenu-wrapper`\n        }, this.menuModel.map((submenuOptions, index) => h(NCascaderSubmenu, {\n          ref: instance => {\n            if (instance) {\n              submenuInstRefs[index] = instance;\n            }\n          },\n          key: index,\n          tmNodes: submenuOptions,\n          depth: index + 1\n        })), h(NBaseMenuMask, {\n          clsPrefix: mergedClsPrefix,\n          ref: \"maskInstRef\"\n        })) : h(\"div\", {\n          class: `${mergedClsPrefix}-cascader-menu__empty`\n        }, resolveSlot(this.$slots.empty, () => [h(NEmpty, {\n          theme: mergedTheme.peers.Empty,\n          themeOverrides: mergedTheme.peerOverrides.Empty\n        })])), resolveWrappedSlot(this.$slots.action, children => children && h(\"div\", {\n          class: `${mergedClsPrefix}-cascader-menu-action`,\n          \"data-action\": true\n        }, children)), h(FocusDetector, {\n          onFocus: this.onTabout\n        })), [[clickoutside, this.handleClickOutside, undefined, {\n          capture: true\n        }]]);\n      }\n    });\n  }\n\n});","map":{"version":3,"sources":["G:/VUE_FDS/fluent-vue/node_modules/naive-ui/es/cascader/src/CascaderMenu.js"],"names":["h","ref","defineComponent","watch","toRef","inject","nextTick","Transition","withDirectives","clickoutside","FocusDetector","resolveSlot","resolveWrappedSlot","NEmpty","NBaseMenuMask","NCascaderSubmenu","cascaderInjectionKey","name","props","value","String","Number","Array","placement","type","default","show","Boolean","menuModel","required","loading","onFocus","Function","onBlur","onKeyup","onMousedown","onTabout","setup","localeRef","isMountedRef","mergedClsPrefixRef","syncCascaderMenuPosition","handleCascaderMenuClickOutside","mergedThemeRef","submenuInstRefs","maskInstRef","selfElRef","showErrorMessage","label","_a","loadingRequiredMessage","showOnce","handleClickOutside","e","handleFocusin","selfEl","contains","relatedTarget","handleFocusout","exposedRef","scroll","depth","index","elSize","submenuInst","Object","assign","isMounted","mergedClsPrefix","mergedTheme","render","appear","tabindex","class","onFocusin","onFocusout","style","length","map","submenuOptions","instance","key","tmNodes","clsPrefix","$slots","empty","theme","peers","Empty","themeOverrides","peerOverrides","action","children","undefined","capture"],"mappings":"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","sourcesContent":["import { h, ref, defineComponent, watch, toRef, inject, nextTick, Transition, withDirectives } from 'vue';\nimport { clickoutside } from 'vdirs';\nimport FocusDetector from '../../_internal/focus-detector';\nimport { resolveSlot, resolveWrappedSlot } from '../../_utils';\nimport { NEmpty } from '../../empty';\nimport { NBaseMenuMask } from '../../_internal';\nimport NCascaderSubmenu from './CascaderSubmenu';\nimport { cascaderInjectionKey } from './interface';\nexport default defineComponent({\n    name: 'NCascaderMenu',\n    props: {\n        value: [String, Number, Array],\n        placement: {\n            type: String,\n            default: 'bottom-start'\n        },\n        show: Boolean,\n        menuModel: {\n            type: Array,\n            required: true\n        },\n        loading: Boolean,\n        onFocus: {\n            type: Function,\n            required: true\n        },\n        onBlur: {\n            type: Function,\n            required: true\n        },\n        onKeyup: {\n            type: Function,\n            required: true\n        },\n        onMousedown: {\n            type: Function,\n            required: true\n        },\n        onTabout: {\n            type: Function,\n            required: true\n        }\n    },\n    setup(props) {\n        const { localeRef, isMountedRef, mergedClsPrefixRef, syncCascaderMenuPosition, handleCascaderMenuClickOutside, mergedThemeRef\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n         } = inject(cascaderInjectionKey);\n        const submenuInstRefs = [];\n        const maskInstRef = ref(null);\n        const selfElRef = ref(null);\n        watch(toRef(props, 'value'), () => {\n            void nextTick(() => {\n                syncCascaderMenuPosition();\n            });\n        });\n        watch(toRef(props, 'menuModel'), () => {\n            void nextTick(() => {\n                syncCascaderMenuPosition();\n            });\n        });\n        function showErrorMessage(label) {\n            var _a;\n            const { value: { loadingRequiredMessage } } = localeRef;\n            (_a = maskInstRef.value) === null || _a === void 0 ? void 0 : _a.showOnce(loadingRequiredMessage(label));\n        }\n        function handleClickOutside(e) {\n            handleCascaderMenuClickOutside(e);\n        }\n        function handleFocusin(e) {\n            const { value: selfEl } = selfElRef;\n            if (!selfEl)\n                return;\n            if (!selfEl.contains(e.relatedTarget)) {\n                props.onFocus(e);\n            }\n        }\n        function handleFocusout(e) {\n            const { value: selfEl } = selfElRef;\n            if (!selfEl)\n                return;\n            if (!selfEl.contains(e.relatedTarget)) {\n                props.onBlur(e);\n            }\n        }\n        const exposedRef = {\n            scroll(depth, index, elSize) {\n                const submenuInst = submenuInstRefs[depth];\n                if (submenuInst) {\n                    submenuInst.scroll(index, elSize);\n                }\n            },\n            showErrorMessage\n        };\n        return Object.assign({ isMounted: isMountedRef, mergedClsPrefix: mergedClsPrefixRef, selfElRef,\n            submenuInstRefs,\n            maskInstRef, mergedTheme: mergedThemeRef, handleFocusin,\n            handleFocusout,\n            handleClickOutside }, exposedRef);\n    },\n    render() {\n        const { submenuInstRefs, mergedClsPrefix, mergedTheme } = this;\n        return (h(Transition, { name: \"fade-in-scale-up-transition\", appear: this.isMounted }, {\n            default: () => {\n                if (!this.show)\n                    return null;\n                return withDirectives(h(\"div\", { tabindex: \"0\", ref: \"selfElRef\", class: `${mergedClsPrefix}-cascader-menu`, onMousedown: this.onMousedown, onFocusin: this.handleFocusin, onFocusout: this.handleFocusout, onKeyup: this.onKeyup, style: {\n                        '--n-col-count': this.menuModel.length\n                    } },\n                    this.menuModel[0].length ? (h(\"div\", { class: `${mergedClsPrefix}-cascader-submenu-wrapper` },\n                        this.menuModel.map((submenuOptions, index) => (h(NCascaderSubmenu, { ref: ((instance) => {\n                                if (instance) {\n                                    submenuInstRefs[index] = instance;\n                                }\n                            }), key: index, tmNodes: submenuOptions, depth: index + 1 }))),\n                        h(NBaseMenuMask, { clsPrefix: mergedClsPrefix, ref: \"maskInstRef\" }))) : (h(\"div\", { class: `${mergedClsPrefix}-cascader-menu__empty` }, resolveSlot(this.$slots.empty, () => [\n                        h(NEmpty, { theme: mergedTheme.peers.Empty, themeOverrides: mergedTheme.peerOverrides.Empty })\n                    ]))),\n                    resolveWrappedSlot(this.$slots.action, (children) => children && (h(\"div\", { class: `${mergedClsPrefix}-cascader-menu-action`, \"data-action\": true }, children))),\n                    h(FocusDetector, { onFocus: this.onTabout })), [\n                    [\n                        clickoutside,\n                        this.handleClickOutside,\n                        undefined,\n                        { capture: true }\n                    ]\n                ]);\n            }\n        }));\n    }\n});\n"]},"metadata":{},"sourceType":"module"}