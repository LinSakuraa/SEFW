{"ast":null,"code":"var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nimport { h, defineComponent, provide, ref } from 'vue';\nimport { useConfig, useTheme } from '../../_mixins';\nimport { formLight } from '../styles';\nimport style from './styles/form.cssr';\nimport { keysOf } from '../../_utils';\nimport { formInjectionKey, formItemInstsInjectionKey } from './context';\nconst formProps = Object.assign(Object.assign({}, useTheme.props), {\n  inline: Boolean,\n  labelWidth: [Number, String],\n  labelAlign: String,\n  labelPlacement: {\n    type: String,\n    default: 'top'\n  },\n  model: {\n    type: Object,\n    default: () => {}\n  },\n  rules: Object,\n  disabled: Boolean,\n  size: String,\n  showRequireMark: {\n    type: Boolean,\n    default: undefined\n  },\n  requireMarkPlacement: String,\n  showFeedback: {\n    type: Boolean,\n    default: true\n  },\n  onSubmit: {\n    type: Function,\n    default: e => e.preventDefault()\n  },\n  showLabel: {\n    type: Boolean,\n    default: undefined\n  },\n  validateMessages: Object\n});\nexport default defineComponent({\n  name: 'Form',\n  props: formProps,\n\n  setup(props) {\n    const {\n      mergedClsPrefixRef\n    } = useConfig(props);\n    useTheme('Form', '-form', style, formLight, props, mergedClsPrefixRef); // from path to form-item\n\n    const formItems = {}; // for label-width = 'auto'\n\n    const maxChildLabelWidthRef = ref(undefined);\n\n    const deriveMaxChildLabelWidth = currentWidth => {\n      const currentMaxChildLabelWidth = maxChildLabelWidthRef.value;\n\n      if (currentMaxChildLabelWidth === undefined || currentWidth >= currentMaxChildLabelWidth) {\n        maxChildLabelWidthRef.value = currentWidth;\n      }\n    };\n\n    function validate(validateCallback, shouldRuleBeApplied = () => true) {\n      return __awaiter(this, void 0, void 0, function* () {\n        return yield new Promise((resolve, reject) => {\n          const formItemValidationPromises = [];\n\n          for (const key of keysOf(formItems)) {\n            const formItemInstances = formItems[key];\n\n            for (const formItemInstance of formItemInstances) {\n              if (formItemInstance.path) {\n                formItemValidationPromises.push(formItemInstance.internalValidate(null, shouldRuleBeApplied));\n              }\n            }\n          }\n\n          void Promise.all(formItemValidationPromises).then(results => {\n            if (results.some(result => !result.valid)) {\n              const errors = results.filter(result => result.errors).map(result => result.errors);\n\n              if (validateCallback) {\n                validateCallback(errors);\n              }\n\n              reject(errors);\n            } else {\n              if (validateCallback) validateCallback();\n              resolve();\n            }\n          });\n        });\n      });\n    }\n\n    function restoreValidation() {\n      for (const key of keysOf(formItems)) {\n        const formItemInstances = formItems[key];\n\n        for (const formItemInstance of formItemInstances) {\n          formItemInstance.restoreValidation();\n        }\n      }\n    }\n\n    provide(formInjectionKey, {\n      props,\n      maxChildLabelWidthRef,\n      deriveMaxChildLabelWidth\n    });\n    provide(formItemInstsInjectionKey, {\n      formItems\n    });\n    const formExposedMethod = {\n      validate,\n      restoreValidation\n    };\n    return Object.assign(formExposedMethod, {\n      mergedClsPrefix: mergedClsPrefixRef\n    });\n  },\n\n  render() {\n    const {\n      mergedClsPrefix\n    } = this;\n    return h(\"form\", {\n      class: [`${mergedClsPrefix}-form`, this.inline && `${mergedClsPrefix}-form--inline`],\n      onSubmit: this.onSubmit\n    }, this.$slots);\n  }\n\n});","map":{"version":3,"sources":["G:/VUE_FDS/fluent-vue/node_modules/naive-ui/es/form/src/Form.js"],"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","h","defineComponent","provide","ref","useConfig","useTheme","formLight","style","keysOf","formInjectionKey","formItemInstsInjectionKey","formProps","Object","assign","props","inline","Boolean","labelWidth","Number","String","labelAlign","labelPlacement","type","default","model","rules","disabled","size","showRequireMark","undefined","requireMarkPlacement","showFeedback","onSubmit","Function","preventDefault","showLabel","validateMessages","name","setup","mergedClsPrefixRef","formItems","maxChildLabelWidthRef","deriveMaxChildLabelWidth","currentWidth","currentMaxChildLabelWidth","validate","validateCallback","shouldRuleBeApplied","formItemValidationPromises","key","formItemInstances","formItemInstance","path","push","internalValidate","all","results","some","valid","errors","filter","map","restoreValidation","formExposedMethod","mergedClsPrefix","render","class","$slots"],"mappings":"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","sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { h, defineComponent, provide, ref } from 'vue';\nimport { useConfig, useTheme } from '../../_mixins';\nimport { formLight } from '../styles';\nimport style from './styles/form.cssr';\nimport { keysOf } from '../../_utils';\nimport { formInjectionKey, formItemInstsInjectionKey } from './context';\nconst formProps = Object.assign(Object.assign({}, useTheme.props), { inline: Boolean, labelWidth: [Number, String], labelAlign: String, labelPlacement: {\n        type: String,\n        default: 'top'\n    }, model: {\n        type: Object,\n        default: () => { }\n    }, rules: Object, disabled: Boolean, size: String, showRequireMark: {\n        type: Boolean,\n        default: undefined\n    }, requireMarkPlacement: String, showFeedback: {\n        type: Boolean,\n        default: true\n    }, onSubmit: {\n        type: Function,\n        default: (e) => e.preventDefault()\n    }, showLabel: {\n        type: Boolean,\n        default: undefined\n    }, validateMessages: Object });\nexport default defineComponent({\n    name: 'Form',\n    props: formProps,\n    setup(props) {\n        const { mergedClsPrefixRef } = useConfig(props);\n        useTheme('Form', '-form', style, formLight, props, mergedClsPrefixRef);\n        // from path to form-item\n        const formItems = {};\n        // for label-width = 'auto'\n        const maxChildLabelWidthRef = ref(undefined);\n        const deriveMaxChildLabelWidth = (currentWidth) => {\n            const currentMaxChildLabelWidth = maxChildLabelWidthRef.value;\n            if (currentMaxChildLabelWidth === undefined ||\n                currentWidth >= currentMaxChildLabelWidth) {\n                maxChildLabelWidthRef.value = currentWidth;\n            }\n        };\n        function validate(validateCallback, shouldRuleBeApplied = () => true) {\n            return __awaiter(this, void 0, void 0, function* () {\n                return yield new Promise((resolve, reject) => {\n                    const formItemValidationPromises = [];\n                    for (const key of keysOf(formItems)) {\n                        const formItemInstances = formItems[key];\n                        for (const formItemInstance of formItemInstances) {\n                            if (formItemInstance.path) {\n                                formItemValidationPromises.push(formItemInstance.internalValidate(null, shouldRuleBeApplied));\n                            }\n                        }\n                    }\n                    void Promise.all(formItemValidationPromises).then((results) => {\n                        if (results.some((result) => !result.valid)) {\n                            const errors = results\n                                .filter((result) => result.errors)\n                                .map((result) => result.errors);\n                            if (validateCallback) {\n                                validateCallback(errors);\n                            }\n                            reject(errors);\n                        }\n                        else {\n                            if (validateCallback)\n                                validateCallback();\n                            resolve();\n                        }\n                    });\n                });\n            });\n        }\n        function restoreValidation() {\n            for (const key of keysOf(formItems)) {\n                const formItemInstances = formItems[key];\n                for (const formItemInstance of formItemInstances) {\n                    formItemInstance.restoreValidation();\n                }\n            }\n        }\n        provide(formInjectionKey, {\n            props,\n            maxChildLabelWidthRef,\n            deriveMaxChildLabelWidth\n        });\n        provide(formItemInstsInjectionKey, { formItems });\n        const formExposedMethod = {\n            validate,\n            restoreValidation\n        };\n        return Object.assign(formExposedMethod, {\n            mergedClsPrefix: mergedClsPrefixRef\n        });\n    },\n    render() {\n        const { mergedClsPrefix } = this;\n        return (h(\"form\", { class: [\n                `${mergedClsPrefix}-form`,\n                this.inline && `${mergedClsPrefix}-form--inline`\n            ], onSubmit: this.onSubmit }, this.$slots));\n    }\n});\n"]},"metadata":{},"sourceType":"module"}