{"ast":null,"code":"import { h, vShow, withDirectives, Transition, ref, defineComponent, computed, mergeProps, inject, onBeforeUnmount, watch, toRef, provide } from 'vue';\nimport { VFollower, VFocusTrap } from 'vueuc';\nimport { clickoutside, mousemoveoutside } from 'vdirs';\nimport { useTheme, useConfig, useThemeClass } from '../../_mixins';\nimport { formatLength, isSlotEmpty, resolveWrappedSlot, useAdjustedTo } from '../../_utils';\nimport { popoverLight } from '../styles';\nimport style from './styles/index.cssr';\nimport { popoverBodyInjectionKey } from './interface';\nimport { drawerBodyInjectionKey } from '../../drawer/src/interface';\nimport { modalBodyInjectionKey } from '../../modal/src/interface';\nexport const popoverBodyProps = Object.assign(Object.assign({}, useTheme.props), {\n  to: useAdjustedTo.propTo,\n  show: Boolean,\n  trigger: String,\n  showArrow: Boolean,\n  delay: Number,\n  duration: Number,\n  raw: Boolean,\n  arrowPointToCenter: Boolean,\n  arrowStyle: [String, Object],\n  displayDirective: String,\n  x: Number,\n  y: Number,\n  flip: Boolean,\n  overlap: Boolean,\n  placement: String,\n  width: [Number, String],\n  keepAliveOnHover: Boolean,\n  internalTrapFocus: Boolean,\n  // private\n  animated: Boolean,\n  onClickoutside: Function,\n\n  /** @deprecated */\n  minWidth: Number,\n  maxWidth: Number\n});\nexport const renderArrow = ({\n  arrowStyle,\n  clsPrefix\n}) => {\n  return h(\"div\", {\n    key: \"__popover-arrow__\",\n    class: `${clsPrefix}-popover-arrow-wrapper`\n  }, h(\"div\", {\n    class: `${clsPrefix}-popover-arrow`,\n    style: arrowStyle\n  }));\n};\nexport default defineComponent({\n  name: 'PopoverBody',\n  inheritAttrs: false,\n  props: popoverBodyProps,\n\n  setup(props, {\n    slots,\n    attrs\n  }) {\n    const {\n      namespaceRef,\n      mergedClsPrefixRef,\n      inlineThemeDisabled\n    } = useConfig(props);\n    const themeRef = useTheme('Popover', '-popover', style, popoverLight, props, mergedClsPrefixRef);\n    const followerRef = ref(null);\n    const NPopover = inject('NPopover');\n    const bodyRef = ref(null);\n    const followerEnabledRef = ref(props.show);\n    const directivesRef = computed(() => {\n      const {\n        trigger,\n        onClickoutside\n      } = props;\n      const directives = [];\n      const {\n        positionManuallyRef: {\n          value: positionManually\n        }\n      } = NPopover;\n\n      if (!positionManually) {\n        if (trigger === 'click' && !onClickoutside) {\n          directives.push([clickoutside, handleClickOutside, undefined, {\n            capture: true\n          }]);\n        }\n\n        if (trigger === 'hover') {\n          directives.push([mousemoveoutside, handleMouseMoveOutside]);\n        }\n      }\n\n      if (onClickoutside) {\n        directives.push([clickoutside, handleClickOutside, undefined, {\n          capture: true\n        }]);\n      }\n\n      if (props.displayDirective === 'show') {\n        directives.push([vShow, props.show]);\n      }\n\n      return directives;\n    });\n    const styleRef = computed(() => {\n      return [{\n        width: props.width === 'trigger' ? '' : formatLength(props.width)\n      }, props.maxWidth ? {\n        maxWidth: formatLength(props.maxWidth)\n      } : {}, props.minWidth ? {\n        minWidth: formatLength(props.minWidth)\n      } : {}, inlineThemeDisabled ? undefined : cssVarsRef.value];\n    });\n    const cssVarsRef = computed(() => {\n      const {\n        common: {\n          cubicBezierEaseInOut,\n          cubicBezierEaseIn,\n          cubicBezierEaseOut\n        },\n        self: {\n          space,\n          spaceArrow,\n          padding,\n          fontSize,\n          textColor,\n          dividerColor,\n          color,\n          boxShadow,\n          borderRadius,\n          arrowHeight,\n          arrowOffset,\n          arrowOffsetVertical\n        }\n      } = themeRef.value;\n      return {\n        '--n-box-shadow': boxShadow,\n        '--n-bezier': cubicBezierEaseInOut,\n        '--n-bezier-ease-in': cubicBezierEaseIn,\n        '--n-bezier-ease-out': cubicBezierEaseOut,\n        '--n-font-size': fontSize,\n        '--n-text-color': textColor,\n        '--n-color': color,\n        '--n-divider-color': dividerColor,\n        '--n-border-radius': borderRadius,\n        '--n-arrow-height': arrowHeight,\n        '--n-arrow-offset': arrowOffset,\n        '--n-arrow-offset-vertical': arrowOffsetVertical,\n        '--n-padding': padding,\n        '--n-space': space,\n        '--n-space-arrow': spaceArrow\n      };\n    });\n    const themeClassHandle = inlineThemeDisabled ? useThemeClass('popover', undefined, cssVarsRef, props) : undefined;\n    NPopover.setBodyInstance({\n      syncPosition\n    });\n    onBeforeUnmount(() => {\n      NPopover.setBodyInstance(null);\n    });\n    watch(toRef(props, 'show'), value => {\n      // If no animation, no transition component will be applied to the\n      // component. So we need to trigger follower manaully.\n      if (props.animated) return;\n\n      if (value) {\n        followerEnabledRef.value = true;\n      } else {\n        followerEnabledRef.value = false;\n      }\n    });\n\n    function syncPosition() {\n      var _a;\n\n      (_a = followerRef.value) === null || _a === void 0 ? void 0 : _a.syncPosition();\n    }\n\n    function handleMouseEnter(e) {\n      if (props.trigger === 'hover' && props.keepAliveOnHover) {\n        NPopover.handleMouseEnter(e);\n      }\n    }\n\n    function handleMouseLeave(e) {\n      if (props.trigger === 'hover' && props.keepAliveOnHover) {\n        NPopover.handleMouseLeave(e);\n      }\n    }\n\n    function handleMouseMoveOutside(e) {\n      if (props.trigger === 'hover' && !getTriggerElement().contains(e.target)) {\n        NPopover.handleMouseMoveOutside(e);\n      }\n    }\n\n    function handleClickOutside(e) {\n      if (props.trigger === 'click' && !getTriggerElement().contains(e.target) || props.onClickoutside) {\n        NPopover.handleClickOutside(e);\n      }\n    }\n\n    function getTriggerElement() {\n      return NPopover.getTriggerElement();\n    }\n\n    provide(popoverBodyInjectionKey, bodyRef);\n    provide(drawerBodyInjectionKey, null);\n    provide(modalBodyInjectionKey, null);\n\n    function renderContentNode() {\n      themeClassHandle === null || themeClassHandle === void 0 ? void 0 : themeClassHandle.onRender();\n      let contentNode;\n      const {\n        internalRenderBodyRef: {\n          value: renderBody\n        }\n      } = NPopover;\n      const {\n        value: mergedClsPrefix\n      } = mergedClsPrefixRef;\n\n      if (!renderBody) {\n        const {\n          value: extraClass\n        } = NPopover.extraClassRef;\n        const {\n          internalTrapFocus\n        } = props;\n\n        const renderContentInnerNode = () => {\n          var _a;\n\n          return [resolveWrappedSlot(slots.header, children => children && [h(\"div\", {\n            class: `${mergedClsPrefix}-popover__header`\n          }, children), h(\"div\", {\n            class: `${mergedClsPrefix}-popover__content`\n          }, slots)]) || ((_a = slots.default) === null || _a === void 0 ? void 0 : _a.call(slots)), props.showArrow ? renderArrow({\n            arrowStyle: props.arrowStyle,\n            clsPrefix: mergedClsPrefix\n          }) : null];\n        };\n\n        contentNode = h('div', mergeProps({\n          class: [`${mergedClsPrefix}-popover`, themeClassHandle === null || themeClassHandle === void 0 ? void 0 : themeClassHandle.themeClass.value, extraClass.map(v => `${mergedClsPrefix}-${v}`), {\n            [`${mergedClsPrefix}-popover--overlap`]: props.overlap,\n            [`${mergedClsPrefix}-popover--show-arrow`]: props.showArrow,\n            [`${mergedClsPrefix}-popover--show-header`]: !isSlotEmpty(slots.header),\n            [`${mergedClsPrefix}-popover--raw`]: props.raw,\n            [`${mergedClsPrefix}-popover--manual-trigger`]: props.trigger === 'manual',\n            [`${mergedClsPrefix}-popover--center-arrow`]: props.arrowPointToCenter\n          }],\n          ref: bodyRef,\n          style: styleRef.value,\n          onKeydown: NPopover.handleKeydown,\n          onMouseenter: handleMouseEnter,\n          onMouseleave: handleMouseLeave\n        }, attrs), internalTrapFocus ? h(VFocusTrap, {\n          active: props.show,\n          autoFocus: true\n        }, {\n          default: renderContentInnerNode\n        }) : renderContentInnerNode());\n      } else {\n        contentNode = renderBody( // The popover class and overlap class must exists, they will be used\n        // to place the body & transition animation.\n        // Shadow class exists for reuse box-shadow.\n        [`${mergedClsPrefix}-popover`, themeClassHandle === null || themeClassHandle === void 0 ? void 0 : themeClassHandle.themeClass.value, props.overlap && `${mergedClsPrefix}-popover--overlap`], bodyRef, styleRef.value, handleMouseEnter, handleMouseLeave);\n      }\n\n      return props.displayDirective === 'show' || props.show ? withDirectives(contentNode, directivesRef.value) : null;\n    }\n\n    return {\n      namespace: namespaceRef,\n      isMounted: NPopover.isMountedRef,\n      zIndex: NPopover.zIndexRef,\n      followerRef,\n      adjustedTo: useAdjustedTo(props),\n      followerEnabled: followerEnabledRef,\n      renderContentNode\n    };\n  },\n\n  render() {\n    return h(VFollower, {\n      zIndex: this.zIndex,\n      show: this.show,\n      enabled: this.followerEnabled,\n      to: this.adjustedTo,\n      x: this.x,\n      y: this.y,\n      flip: this.flip,\n      placement: this.placement,\n      containerClass: this.namespace,\n      ref: \"followerRef\",\n      overlap: this.overlap,\n      width: this.width === 'trigger' ? 'target' : undefined,\n      teleportDisabled: this.adjustedTo === useAdjustedTo.tdkey\n    }, {\n      default: () => {\n        return this.animated ? h(Transition, {\n          name: \"popover-transition\",\n          appear: this.isMounted,\n          // Don't use watch to enable follower, since the transition may\n          // make position sync timing very subtle and buggy.\n          onEnter: () => {\n            this.followerEnabled = true;\n          },\n          onAfterLeave: () => {\n            this.followerEnabled = false;\n          }\n        }, {\n          default: this.renderContentNode\n        }) : this.renderContentNode();\n      }\n    });\n  }\n\n});","map":{"version":3,"sources":["G:/VUE_FDS/fluent-vue/node_modules/naive-ui/es/popover/src/PopoverBody.js"],"names":["h","vShow","withDirectives","Transition","ref","defineComponent","computed","mergeProps","inject","onBeforeUnmount","watch","toRef","provide","VFollower","VFocusTrap","clickoutside","mousemoveoutside","useTheme","useConfig","useThemeClass","formatLength","isSlotEmpty","resolveWrappedSlot","useAdjustedTo","popoverLight","style","popoverBodyInjectionKey","drawerBodyInjectionKey","modalBodyInjectionKey","popoverBodyProps","Object","assign","props","to","propTo","show","Boolean","trigger","String","showArrow","delay","Number","duration","raw","arrowPointToCenter","arrowStyle","displayDirective","x","y","flip","overlap","placement","width","keepAliveOnHover","internalTrapFocus","animated","onClickoutside","Function","minWidth","maxWidth","renderArrow","clsPrefix","key","class","name","inheritAttrs","setup","slots","attrs","namespaceRef","mergedClsPrefixRef","inlineThemeDisabled","themeRef","followerRef","NPopover","bodyRef","followerEnabledRef","directivesRef","directives","positionManuallyRef","value","positionManually","push","handleClickOutside","undefined","capture","handleMouseMoveOutside","styleRef","cssVarsRef","common","cubicBezierEaseInOut","cubicBezierEaseIn","cubicBezierEaseOut","self","space","spaceArrow","padding","fontSize","textColor","dividerColor","color","boxShadow","borderRadius","arrowHeight","arrowOffset","arrowOffsetVertical","themeClassHandle","setBodyInstance","syncPosition","_a","handleMouseEnter","e","handleMouseLeave","getTriggerElement","contains","target","renderContentNode","onRender","contentNode","internalRenderBodyRef","renderBody","mergedClsPrefix","extraClass","extraClassRef","renderContentInnerNode","header","children","default","call","themeClass","map","v","onKeydown","handleKeydown","onMouseenter","onMouseleave","active","autoFocus","namespace","isMounted","isMountedRef","zIndex","zIndexRef","adjustedTo","followerEnabled","render","enabled","containerClass","teleportDisabled","tdkey","appear","onEnter","onAfterLeave"],"mappings":"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","sourcesContent":["import { h, vShow, withDirectives, Transition, ref, defineComponent, computed, mergeProps, inject, onBeforeUnmount, watch, toRef, provide } from 'vue';\nimport { VFollower, VFocusTrap } from 'vueuc';\nimport { clickoutside, mousemoveoutside } from 'vdirs';\nimport { useTheme, useConfig, useThemeClass } from '../../_mixins';\nimport { formatLength, isSlotEmpty, resolveWrappedSlot, useAdjustedTo } from '../../_utils';\nimport { popoverLight } from '../styles';\nimport style from './styles/index.cssr';\nimport { popoverBodyInjectionKey } from './interface';\nimport { drawerBodyInjectionKey } from '../../drawer/src/interface';\nimport { modalBodyInjectionKey } from '../../modal/src/interface';\nexport const popoverBodyProps = Object.assign(Object.assign({}, useTheme.props), { to: useAdjustedTo.propTo, show: Boolean, trigger: String, showArrow: Boolean, delay: Number, duration: Number, raw: Boolean, arrowPointToCenter: Boolean, arrowStyle: [String, Object], displayDirective: String, x: Number, y: Number, flip: Boolean, overlap: Boolean, placement: String, width: [Number, String], keepAliveOnHover: Boolean, internalTrapFocus: Boolean, \n    // private\n    animated: Boolean, onClickoutside: Function, \n    /** @deprecated */\n    minWidth: Number, maxWidth: Number });\nexport const renderArrow = ({ arrowStyle, clsPrefix }) => {\n    return (h(\"div\", { key: \"__popover-arrow__\", class: `${clsPrefix}-popover-arrow-wrapper` },\n        h(\"div\", { class: `${clsPrefix}-popover-arrow`, style: arrowStyle })));\n};\nexport default defineComponent({\n    name: 'PopoverBody',\n    inheritAttrs: false,\n    props: popoverBodyProps,\n    setup(props, { slots, attrs }) {\n        const { namespaceRef, mergedClsPrefixRef, inlineThemeDisabled } = useConfig(props);\n        const themeRef = useTheme('Popover', '-popover', style, popoverLight, props, mergedClsPrefixRef);\n        const followerRef = ref(null);\n        const NPopover = inject('NPopover');\n        const bodyRef = ref(null);\n        const followerEnabledRef = ref(props.show);\n        const directivesRef = computed(() => {\n            const { trigger, onClickoutside } = props;\n            const directives = [];\n            const { positionManuallyRef: { value: positionManually } } = NPopover;\n            if (!positionManually) {\n                if (trigger === 'click' && !onClickoutside) {\n                    directives.push([\n                        clickoutside,\n                        handleClickOutside,\n                        undefined,\n                        { capture: true }\n                    ]);\n                }\n                if (trigger === 'hover') {\n                    directives.push([mousemoveoutside, handleMouseMoveOutside]);\n                }\n            }\n            if (onClickoutside) {\n                directives.push([\n                    clickoutside,\n                    handleClickOutside,\n                    undefined,\n                    { capture: true }\n                ]);\n            }\n            if (props.displayDirective === 'show') {\n                directives.push([vShow, props.show]);\n            }\n            return directives;\n        });\n        const styleRef = computed(() => {\n            return [\n                {\n                    width: props.width === 'trigger' ? '' : formatLength(props.width)\n                },\n                props.maxWidth ? { maxWidth: formatLength(props.maxWidth) } : {},\n                props.minWidth ? { minWidth: formatLength(props.minWidth) } : {},\n                inlineThemeDisabled ? undefined : cssVarsRef.value\n            ];\n        });\n        const cssVarsRef = computed(() => {\n            const { common: { cubicBezierEaseInOut, cubicBezierEaseIn, cubicBezierEaseOut }, self: { space, spaceArrow, padding, fontSize, textColor, dividerColor, color, boxShadow, borderRadius, arrowHeight, arrowOffset, arrowOffsetVertical } } = themeRef.value;\n            return {\n                '--n-box-shadow': boxShadow,\n                '--n-bezier': cubicBezierEaseInOut,\n                '--n-bezier-ease-in': cubicBezierEaseIn,\n                '--n-bezier-ease-out': cubicBezierEaseOut,\n                '--n-font-size': fontSize,\n                '--n-text-color': textColor,\n                '--n-color': color,\n                '--n-divider-color': dividerColor,\n                '--n-border-radius': borderRadius,\n                '--n-arrow-height': arrowHeight,\n                '--n-arrow-offset': arrowOffset,\n                '--n-arrow-offset-vertical': arrowOffsetVertical,\n                '--n-padding': padding,\n                '--n-space': space,\n                '--n-space-arrow': spaceArrow\n            };\n        });\n        const themeClassHandle = inlineThemeDisabled\n            ? useThemeClass('popover', undefined, cssVarsRef, props)\n            : undefined;\n        NPopover.setBodyInstance({\n            syncPosition\n        });\n        onBeforeUnmount(() => {\n            NPopover.setBodyInstance(null);\n        });\n        watch(toRef(props, 'show'), (value) => {\n            // If no animation, no transition component will be applied to the\n            // component. So we need to trigger follower manaully.\n            if (props.animated)\n                return;\n            if (value) {\n                followerEnabledRef.value = true;\n            }\n            else {\n                followerEnabledRef.value = false;\n            }\n        });\n        function syncPosition() {\n            var _a;\n            (_a = followerRef.value) === null || _a === void 0 ? void 0 : _a.syncPosition();\n        }\n        function handleMouseEnter(e) {\n            if (props.trigger === 'hover' && props.keepAliveOnHover) {\n                NPopover.handleMouseEnter(e);\n            }\n        }\n        function handleMouseLeave(e) {\n            if (props.trigger === 'hover' && props.keepAliveOnHover) {\n                NPopover.handleMouseLeave(e);\n            }\n        }\n        function handleMouseMoveOutside(e) {\n            if (props.trigger === 'hover' &&\n                !getTriggerElement().contains(e.target)) {\n                NPopover.handleMouseMoveOutside(e);\n            }\n        }\n        function handleClickOutside(e) {\n            if ((props.trigger === 'click' &&\n                !getTriggerElement().contains(e.target)) ||\n                props.onClickoutside) {\n                NPopover.handleClickOutside(e);\n            }\n        }\n        function getTriggerElement() {\n            return NPopover.getTriggerElement();\n        }\n        provide(popoverBodyInjectionKey, bodyRef);\n        provide(drawerBodyInjectionKey, null);\n        provide(modalBodyInjectionKey, null);\n        function renderContentNode() {\n            themeClassHandle === null || themeClassHandle === void 0 ? void 0 : themeClassHandle.onRender();\n            let contentNode;\n            const { internalRenderBodyRef: { value: renderBody } } = NPopover;\n            const { value: mergedClsPrefix } = mergedClsPrefixRef;\n            if (!renderBody) {\n                const { value: extraClass } = NPopover.extraClassRef;\n                const { internalTrapFocus } = props;\n                const renderContentInnerNode = () => {\n                    var _a;\n                    return [\n                        resolveWrappedSlot(slots.header, (children) => children && [\n                            h(\"div\", { class: `${mergedClsPrefix}-popover__header` }, children),\n                            h(\"div\", { class: `${mergedClsPrefix}-popover__content` }, slots)\n                        ]) || ((_a = slots.default) === null || _a === void 0 ? void 0 : _a.call(slots)),\n                        props.showArrow\n                            ? renderArrow({\n                                arrowStyle: props.arrowStyle,\n                                clsPrefix: mergedClsPrefix\n                            })\n                            : null\n                    ];\n                };\n                contentNode = h('div', mergeProps({\n                    class: [\n                        `${mergedClsPrefix}-popover`,\n                        themeClassHandle === null || themeClassHandle === void 0 ? void 0 : themeClassHandle.themeClass.value,\n                        extraClass.map((v) => `${mergedClsPrefix}-${v}`),\n                        {\n                            [`${mergedClsPrefix}-popover--overlap`]: props.overlap,\n                            [`${mergedClsPrefix}-popover--show-arrow`]: props.showArrow,\n                            [`${mergedClsPrefix}-popover--show-header`]: !isSlotEmpty(slots.header),\n                            [`${mergedClsPrefix}-popover--raw`]: props.raw,\n                            [`${mergedClsPrefix}-popover--manual-trigger`]: props.trigger === 'manual',\n                            [`${mergedClsPrefix}-popover--center-arrow`]: props.arrowPointToCenter\n                        }\n                    ],\n                    ref: bodyRef,\n                    style: styleRef.value,\n                    onKeydown: NPopover.handleKeydown,\n                    onMouseenter: handleMouseEnter,\n                    onMouseleave: handleMouseLeave\n                }, attrs), internalTrapFocus ? (h(VFocusTrap, { active: props.show, autoFocus: true }, { default: renderContentInnerNode })) : (renderContentInnerNode()));\n            }\n            else {\n                contentNode = renderBody(\n                // The popover class and overlap class must exists, they will be used\n                // to place the body & transition animation.\n                // Shadow class exists for reuse box-shadow.\n                [\n                    `${mergedClsPrefix}-popover`,\n                    themeClassHandle === null || themeClassHandle === void 0 ? void 0 : themeClassHandle.themeClass.value,\n                    props.overlap && `${mergedClsPrefix}-popover--overlap`\n                ], bodyRef, styleRef.value, handleMouseEnter, handleMouseLeave);\n            }\n            return props.displayDirective === 'show' || props.show\n                ? withDirectives(contentNode, directivesRef.value)\n                : null;\n        }\n        return {\n            namespace: namespaceRef,\n            isMounted: NPopover.isMountedRef,\n            zIndex: NPopover.zIndexRef,\n            followerRef,\n            adjustedTo: useAdjustedTo(props),\n            followerEnabled: followerEnabledRef,\n            renderContentNode\n        };\n    },\n    render() {\n        return (h(VFollower, { zIndex: this.zIndex, show: this.show, enabled: this.followerEnabled, to: this.adjustedTo, x: this.x, y: this.y, flip: this.flip, placement: this.placement, containerClass: this.namespace, ref: \"followerRef\", overlap: this.overlap, width: this.width === 'trigger' ? 'target' : undefined, teleportDisabled: this.adjustedTo === useAdjustedTo.tdkey }, {\n            default: () => {\n                return this.animated ? (h(Transition, { name: \"popover-transition\", appear: this.isMounted, \n                    // Don't use watch to enable follower, since the transition may\n                    // make position sync timing very subtle and buggy.\n                    onEnter: () => {\n                        this.followerEnabled = true;\n                    }, onAfterLeave: () => {\n                        this.followerEnabled = false;\n                    } }, {\n                    default: this.renderContentNode\n                })) : (this.renderContentNode());\n            }\n        }));\n    }\n});\n"]},"metadata":{},"sourceType":"module"}