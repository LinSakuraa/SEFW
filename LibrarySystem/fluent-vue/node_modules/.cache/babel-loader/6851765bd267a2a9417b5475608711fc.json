{"ast":null,"code":"import { computed } from 'vue';\nimport { getColKey, createCustomWidthStyle } from './utils';\n\nfunction getRowsAndCols(columns) {\n  const rows = [];\n  const cols = [];\n  const dataRelatedCols = [];\n  const rowItemMap = new WeakMap();\n  let maxDepth = -1;\n  let totalRowSpan = 0;\n  let hasEllipsis = false;\n\n  function ensureMaxDepth(columns, currentDepth) {\n    if (currentDepth > maxDepth) {\n      rows[currentDepth] = [];\n      maxDepth = currentDepth;\n    }\n\n    for (const column of columns) {\n      if ('children' in column) {\n        ensureMaxDepth(column.children, currentDepth + 1);\n      } else {\n        cols.push({\n          key: getColKey(column),\n          style: createCustomWidthStyle(column),\n          column\n        });\n        totalRowSpan += 1;\n\n        if (!hasEllipsis) {\n          hasEllipsis = !!column.ellipsis;\n        }\n\n        dataRelatedCols.push(column);\n      }\n    }\n  }\n\n  ensureMaxDepth(columns, 0);\n  let currentLeafIndex = 0;\n\n  function ensureColLayout(columns, currentDepth) {\n    let hideUntilIndex = 0;\n    columns.forEach((column, index) => {\n      var _a;\n\n      if ('children' in column) {\n        // do not allow colSpan > 1 for non-leaf th\n        // we will execute the calculation logic\n        const cachedCurrentLeafIndex = currentLeafIndex;\n        const rowItem = {\n          column,\n          colSpan: 0,\n          rowSpan: 1,\n          isLast: false\n        };\n        ensureColLayout(column.children, currentDepth + 1);\n        column.children.forEach(childColumn => {\n          var _a, _b;\n\n          rowItem.colSpan += (_b = (_a = rowItemMap.get(childColumn)) === null || _a === void 0 ? void 0 : _a.colSpan) !== null && _b !== void 0 ? _b : 0;\n        });\n\n        if (cachedCurrentLeafIndex + rowItem.colSpan === totalRowSpan) {\n          rowItem.isLast = true;\n        }\n\n        rowItemMap.set(column, rowItem);\n        rows[currentDepth].push(rowItem);\n      } else {\n        if (currentLeafIndex < hideUntilIndex) {\n          currentLeafIndex += 1;\n          return;\n        }\n\n        let colSpan = 1;\n\n        if ('titleColSpan' in column) {\n          colSpan = (_a = column.titleColSpan) !== null && _a !== void 0 ? _a : 1;\n        }\n\n        if (colSpan > 1) {\n          hideUntilIndex = currentLeafIndex + colSpan;\n        }\n\n        const isLast = currentLeafIndex + colSpan === totalRowSpan;\n        const rowItem = {\n          column,\n          colSpan: colSpan,\n          rowSpan: maxDepth - currentDepth + 1,\n          isLast\n        };\n        rowItemMap.set(column, rowItem);\n        rows[currentDepth].push(rowItem);\n        currentLeafIndex += 1;\n      }\n    });\n  }\n\n  ensureColLayout(columns, 0);\n  return {\n    hasEllipsis,\n    rows,\n    cols,\n    dataRelatedCols\n  };\n}\n\nexport function useGroupHeader(props) {\n  const rowsAndCols = computed(() => getRowsAndCols(props.columns));\n  return {\n    rowsRef: computed(() => rowsAndCols.value.rows),\n    colsRef: computed(() => rowsAndCols.value.cols),\n    hasEllipsisRef: computed(() => rowsAndCols.value.hasEllipsis),\n    dataRelatedColsRef: computed(() => rowsAndCols.value.dataRelatedCols)\n  };\n}","map":{"version":3,"sources":["G:/VUE_FDS/fluent-vue/node_modules/naive-ui/es/data-table/src/use-group-header.js"],"names":["computed","getColKey","createCustomWidthStyle","getRowsAndCols","columns","rows","cols","dataRelatedCols","rowItemMap","WeakMap","maxDepth","totalRowSpan","hasEllipsis","ensureMaxDepth","currentDepth","column","children","push","key","style","ellipsis","currentLeafIndex","ensureColLayout","hideUntilIndex","forEach","index","_a","cachedCurrentLeafIndex","rowItem","colSpan","rowSpan","isLast","childColumn","_b","get","set","titleColSpan","useGroupHeader","props","rowsAndCols","rowsRef","value","colsRef","hasEllipsisRef","dataRelatedColsRef"],"mappings":"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","sourcesContent":["import { computed } from 'vue';\nimport { getColKey, createCustomWidthStyle } from './utils';\nfunction getRowsAndCols(columns) {\n    const rows = [];\n    const cols = [];\n    const dataRelatedCols = [];\n    const rowItemMap = new WeakMap();\n    let maxDepth = -1;\n    let totalRowSpan = 0;\n    let hasEllipsis = false;\n    function ensureMaxDepth(columns, currentDepth) {\n        if (currentDepth > maxDepth) {\n            rows[currentDepth] = [];\n            maxDepth = currentDepth;\n        }\n        for (const column of columns) {\n            if ('children' in column) {\n                ensureMaxDepth(column.children, currentDepth + 1);\n            }\n            else {\n                cols.push({\n                    key: getColKey(column),\n                    style: createCustomWidthStyle(column),\n                    column\n                });\n                totalRowSpan += 1;\n                if (!hasEllipsis) {\n                    hasEllipsis = !!column.ellipsis;\n                }\n                dataRelatedCols.push(column);\n            }\n        }\n    }\n    ensureMaxDepth(columns, 0);\n    let currentLeafIndex = 0;\n    function ensureColLayout(columns, currentDepth) {\n        let hideUntilIndex = 0;\n        columns.forEach((column, index) => {\n            var _a;\n            if ('children' in column) {\n                // do not allow colSpan > 1 for non-leaf th\n                // we will execute the calculation logic\n                const cachedCurrentLeafIndex = currentLeafIndex;\n                const rowItem = {\n                    column,\n                    colSpan: 0,\n                    rowSpan: 1,\n                    isLast: false\n                };\n                ensureColLayout(column.children, currentDepth + 1);\n                column.children.forEach((childColumn) => {\n                    var _a, _b;\n                    rowItem.colSpan += (_b = (_a = rowItemMap.get(childColumn)) === null || _a === void 0 ? void 0 : _a.colSpan) !== null && _b !== void 0 ? _b : 0;\n                });\n                if (cachedCurrentLeafIndex + rowItem.colSpan === totalRowSpan) {\n                    rowItem.isLast = true;\n                }\n                rowItemMap.set(column, rowItem);\n                rows[currentDepth].push(rowItem);\n            }\n            else {\n                if (currentLeafIndex < hideUntilIndex) {\n                    currentLeafIndex += 1;\n                    return;\n                }\n                let colSpan = 1;\n                if ('titleColSpan' in column) {\n                    colSpan = (_a = column.titleColSpan) !== null && _a !== void 0 ? _a : 1;\n                }\n                if (colSpan > 1) {\n                    hideUntilIndex = currentLeafIndex + colSpan;\n                }\n                const isLast = currentLeafIndex + colSpan === totalRowSpan;\n                const rowItem = {\n                    column,\n                    colSpan: colSpan,\n                    rowSpan: maxDepth - currentDepth + 1,\n                    isLast\n                };\n                rowItemMap.set(column, rowItem);\n                rows[currentDepth].push(rowItem);\n                currentLeafIndex += 1;\n            }\n        });\n    }\n    ensureColLayout(columns, 0);\n    return {\n        hasEllipsis,\n        rows,\n        cols,\n        dataRelatedCols\n    };\n}\nexport function useGroupHeader(props) {\n    const rowsAndCols = computed(() => getRowsAndCols(props.columns));\n    return {\n        rowsRef: computed(() => rowsAndCols.value.rows),\n        colsRef: computed(() => rowsAndCols.value.cols),\n        hasEllipsisRef: computed(() => rowsAndCols.value.hasEllipsis),\n        dataRelatedColsRef: computed(() => rowsAndCols.value.dataRelatedCols)\n    };\n}\n"]},"metadata":{},"sourceType":"module"}