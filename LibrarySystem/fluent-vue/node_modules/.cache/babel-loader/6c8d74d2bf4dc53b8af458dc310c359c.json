{"ast":null,"code":"import { h, ref, computed, createTextVNode, defineComponent, provide, toRef, cloneVNode, watchEffect, withDirectives } from 'vue';\nimport { VBinder, VTarget } from 'vueuc';\nimport { useMergedState, useCompitable, useIsMounted, useMemo } from 'vooks';\nimport { call, keep, getFirstSlotVNode, warnOnce, useAdjustedTo } from '../../_utils';\nimport { useTheme } from '../../_mixins';\nimport NPopoverBody, { popoverBodyProps } from './PopoverBody';\nimport { zindexable } from 'vdirs';\nconst bodyPropKeys = Object.keys(popoverBodyProps);\nconst triggerEventMap = {\n  focus: ['onFocus', 'onBlur'],\n  click: ['onClick'],\n  hover: ['onMouseenter', 'onMouseleave'],\n  manual: [],\n  nested: ['onFocus', 'onBlur', 'onMouseenter', 'onMouseleave', 'onClick']\n};\n\nfunction appendEvents(vNode, trigger, events) {\n  triggerEventMap[trigger].forEach(eventName => {\n    if (!vNode.props) vNode.props = {};else {\n      vNode.props = Object.assign({}, vNode.props);\n    }\n    const originalHandler = vNode.props[eventName];\n    const handler = events[eventName];\n    if (!originalHandler) vNode.props[eventName] = handler;else {\n      vNode.props[eventName] = (...args) => {\n        originalHandler(...args);\n        handler(...args);\n      };\n    }\n  });\n}\n\nconst textVNodeType = createTextVNode('').type;\nexport const popoverBaseProps = {\n  show: {\n    type: Boolean,\n    default: undefined\n  },\n  defaultShow: Boolean,\n  showArrow: {\n    type: Boolean,\n    default: true\n  },\n  trigger: {\n    type: String,\n    default: 'hover'\n  },\n  delay: {\n    type: Number,\n    default: 100\n  },\n  duration: {\n    type: Number,\n    default: 100\n  },\n  raw: Boolean,\n  placement: {\n    type: String,\n    default: 'top'\n  },\n  x: Number,\n  y: Number,\n  arrowPointToCenter: Boolean,\n  disabled: Boolean,\n  getDisabled: Function,\n  displayDirective: {\n    type: String,\n    default: 'if'\n  },\n  arrowStyle: [String, Object],\n  flip: {\n    type: Boolean,\n    default: true\n  },\n  animated: {\n    type: Boolean,\n    default: true\n  },\n  width: {\n    type: [Number, String],\n    default: undefined\n  },\n  overlap: Boolean,\n  keepAliveOnHover: {\n    type: Boolean,\n    default: true\n  },\n  onClickoutside: Function,\n  internalExtraClass: {\n    type: Array,\n    default: () => []\n  },\n  // events\n  'onUpdate:show': [Function, Array],\n  onUpdateShow: [Function, Array],\n  zIndex: Number,\n  to: useAdjustedTo.propTo,\n  internalSyncTargetWithParent: Boolean,\n  internalInheritedEventHandlers: {\n    type: Array,\n    default: () => []\n  },\n  internalTrapFocus: Boolean,\n\n  /** @deprecated */\n  onShow: [Function, Array],\n\n  /** @deprecated */\n  onHide: [Function, Array],\n\n  /** @deprecated */\n  arrow: {\n    type: Boolean,\n    default: undefined\n  },\n\n  /** @deprecated */\n  minWidth: Number,\n\n  /** @deprecated */\n  maxWidth: Number\n};\nconst popoverProps = Object.assign(Object.assign(Object.assign({}, useTheme.props), popoverBaseProps), {\n  internalRenderBody: Function\n});\nexport default defineComponent({\n  name: 'Popover',\n  inheritAttrs: false,\n  props: popoverProps,\n  __popover__: true,\n\n  setup(props) {\n    if (process.env.NODE_ENV !== 'production') {\n      watchEffect(() => {\n        if (props.maxWidth !== undefined) {\n          warnOnce('popover', '`max-width` is deprecated, please use `style` instead.');\n        }\n\n        if (props.minWidth !== undefined) {\n          warnOnce('popover', '`min-width` is deprecated, please use `style` instead.');\n        }\n\n        if (props.arrow !== undefined) {\n          warnOnce('popover', '`arrow` is deprecated, please use `showArrow` instead.');\n        }\n\n        if (props.onHide !== undefined) {\n          warnOnce('popover', '`on-hide` is deprecated, please use `on-update:show` instead.');\n        }\n\n        if (props.onShow !== undefined) {\n          warnOnce('popover', '`on-show` is deprecated, please use `on-update:show` instead.');\n        }\n      });\n    }\n\n    const isMountedRef = useIsMounted();\n    const binderInstRef = ref(null); // setup show\n\n    const controlledShowRef = computed(() => props.show);\n    const uncontrolledShowRef = ref(props.defaultShow);\n    const mergedShowWithoutDisabledRef = useMergedState(controlledShowRef, uncontrolledShowRef);\n    const mergedShowConsideringDisabledPropRef = useMemo(() => {\n      if (props.disabled) return false;\n      return mergedShowWithoutDisabledRef.value;\n    });\n\n    const getMergedDisabled = () => {\n      if (props.disabled) return true;\n      const {\n        getDisabled\n      } = props;\n      if (getDisabled === null || getDisabled === void 0 ? void 0 : getDisabled()) return true;\n      return false;\n    };\n\n    const getMergedShow = () => {\n      if (getMergedDisabled()) return false;\n      return mergedShowWithoutDisabledRef.value;\n    }; // setup show-arrow\n\n\n    const compatibleShowArrowRef = useCompitable(props, ['arrow', 'showArrow']);\n    const mergedShowArrowRef = computed(() => {\n      if (props.overlap) return false;\n      return compatibleShowArrowRef.value;\n    }); // bodyInstance\n\n    let bodyInstance = null;\n    const showTimerIdRef = ref(null);\n    const hideTimerIdRef = ref(null);\n    const positionManuallyRef = useMemo(() => {\n      return props.x !== undefined && props.y !== undefined;\n    }); // methods\n\n    function doUpdateShow(value) {\n      const {\n        'onUpdate:show': _onUpdateShow,\n        onUpdateShow,\n        onShow,\n        onHide\n      } = props;\n      uncontrolledShowRef.value = value;\n\n      if (_onUpdateShow) {\n        call(_onUpdateShow, value);\n      }\n\n      if (onUpdateShow) {\n        call(onUpdateShow, value);\n      }\n\n      if (value && onShow) {\n        call(onShow, true);\n      }\n\n      if (value && onHide) {\n        call(onHide, false);\n      }\n    }\n\n    function syncPosition() {\n      if (bodyInstance) {\n        bodyInstance.syncPosition();\n      }\n    }\n\n    function clearShowTimer() {\n      const {\n        value: showTimerId\n      } = showTimerIdRef;\n\n      if (showTimerId) {\n        window.clearTimeout(showTimerId);\n        showTimerIdRef.value = null;\n      }\n    }\n\n    function clearHideTimer() {\n      const {\n        value: hideTimerId\n      } = hideTimerIdRef;\n\n      if (hideTimerId) {\n        window.clearTimeout(hideTimerId);\n        hideTimerIdRef.value = null;\n      }\n    }\n\n    function handleFocus() {\n      const mergedDisabled = getMergedDisabled();\n\n      if (props.trigger === 'focus' && !mergedDisabled) {\n        if (getMergedShow()) return;\n        doUpdateShow(true);\n      }\n    }\n\n    function handleBlur() {\n      const mergedDisabled = getMergedDisabled();\n\n      if (props.trigger === 'focus' && !mergedDisabled) {\n        if (!getMergedShow()) return;\n        doUpdateShow(false);\n      }\n    }\n\n    function handleMouseEnter() {\n      const mergedDisabled = getMergedDisabled();\n\n      if (props.trigger === 'hover' && !mergedDisabled) {\n        clearHideTimer();\n        if (showTimerIdRef.value !== null) return;\n        if (getMergedShow()) return;\n\n        const delayCallback = () => {\n          doUpdateShow(true);\n          showTimerIdRef.value = null;\n        };\n\n        const {\n          delay\n        } = props;\n\n        if (delay === 0) {\n          delayCallback();\n        } else {\n          showTimerIdRef.value = window.setTimeout(delayCallback, delay);\n        }\n      }\n    }\n\n    function handleMouseLeave() {\n      const mergedDisabled = getMergedDisabled();\n\n      if (props.trigger === 'hover' && !mergedDisabled) {\n        clearShowTimer();\n        if (hideTimerIdRef.value !== null) return;\n        if (!getMergedShow()) return;\n\n        const delayedCallback = () => {\n          doUpdateShow(false);\n          hideTimerIdRef.value = null;\n        };\n\n        const {\n          duration\n        } = props;\n\n        if (duration === 0) {\n          delayedCallback();\n        } else {\n          hideTimerIdRef.value = window.setTimeout(delayedCallback, duration);\n        }\n      }\n    } // will be called in popover-content\n\n\n    function handleMouseMoveOutside() {\n      handleMouseLeave();\n    } // will be called in popover-content\n\n\n    function handleClickOutside(e) {\n      var _a;\n\n      if (!getMergedShow()) return;\n\n      if (props.trigger === 'click') {\n        clearShowTimer();\n        clearHideTimer();\n        doUpdateShow(false);\n      }\n\n      (_a = props.onClickoutside) === null || _a === void 0 ? void 0 : _a.call(props, e);\n    }\n\n    function handleClick() {\n      if (props.trigger === 'click' && !getMergedDisabled()) {\n        clearShowTimer();\n        clearHideTimer();\n        const nextShow = !getMergedShow();\n        doUpdateShow(nextShow);\n      }\n    }\n\n    function handleKeydown(e) {\n      if (!props.internalTrapFocus) return;\n\n      if (e.code === 'Escape') {\n        clearShowTimer();\n        clearHideTimer();\n        doUpdateShow(false);\n      }\n    }\n\n    function setShow(value) {\n      uncontrolledShowRef.value = value;\n    }\n\n    function getTriggerElement() {\n      var _a;\n\n      return (_a = binderInstRef.value) === null || _a === void 0 ? void 0 : _a.targetRef;\n    }\n\n    function setBodyInstance(value) {\n      bodyInstance = value;\n    }\n\n    provide('NPopover', {\n      getTriggerElement,\n      handleKeydown,\n      handleMouseEnter,\n      handleMouseLeave,\n      handleClickOutside,\n      handleMouseMoveOutside,\n      setBodyInstance,\n      positionManuallyRef: positionManuallyRef,\n      isMountedRef: isMountedRef,\n      zIndexRef: toRef(props, 'zIndex'),\n      extraClassRef: toRef(props, 'internalExtraClass'),\n      internalRenderBodyRef: toRef(props, 'internalRenderBody')\n    });\n    return {\n      binderInstRef,\n      positionManually: positionManuallyRef,\n      mergedShowConsideringDisabledProp: mergedShowConsideringDisabledPropRef,\n      // if to show popover body\n      uncontrolledShow: uncontrolledShowRef,\n      mergedShowArrow: mergedShowArrowRef,\n      getMergedShow,\n      setShow,\n      handleClick,\n      handleMouseEnter,\n      handleMouseLeave,\n      handleFocus,\n      handleBlur,\n      syncPosition\n    };\n  },\n\n  render() {\n    var _a;\n\n    const {\n      positionManually,\n      $slots: slots\n    } = this;\n    let triggerVNode;\n    let popoverInside = false;\n\n    if (!positionManually) {\n      if (slots.activator) {\n        triggerVNode = getFirstSlotVNode(slots, 'activator');\n      } else {\n        triggerVNode = getFirstSlotVNode(slots, 'trigger');\n      }\n\n      if (triggerVNode) {\n        triggerVNode = cloneVNode(triggerVNode);\n        triggerVNode = triggerVNode.type === textVNodeType ? h('span', [triggerVNode]) : triggerVNode;\n        const handlers = {\n          onClick: this.handleClick,\n          onMouseenter: this.handleMouseEnter,\n          onMouseleave: this.handleMouseLeave,\n          onFocus: this.handleFocus,\n          onBlur: this.handleBlur\n        };\n\n        if ((_a = triggerVNode.type) === null || _a === void 0 ? void 0 : _a.__popover__) {\n          popoverInside = true; // We assume that there's no DOM event handlers on popover element\n\n          if (!triggerVNode.props) {\n            triggerVNode.props = {\n              internalSyncTargetWithParent: true,\n              internalInheritedEventHandlers: []\n            };\n          }\n\n          triggerVNode.props.internalSyncTargetWithParent = true;\n\n          if (!triggerVNode.props.internalInheritedEventHandlers) {\n            triggerVNode.props.internalInheritedEventHandlers = [handlers];\n          } else {\n            triggerVNode.props.internalInheritedEventHandlers = [handlers, ...triggerVNode.props.internalInheritedEventHandlers];\n          }\n        } else {\n          const {\n            internalInheritedEventHandlers\n          } = this;\n          const ascendantAndCurrentHandlers = [handlers, ...internalInheritedEventHandlers];\n          const mergedHandlers = {\n            onBlur: e => {\n              ascendantAndCurrentHandlers.forEach(_handlers => {\n                _handlers.onBlur(e);\n              });\n            },\n            onFocus: e => {\n              ascendantAndCurrentHandlers.forEach(_handlers => {\n                _handlers.onFocus(e);\n              });\n            },\n            onClick: e => {\n              ascendantAndCurrentHandlers.forEach(_handlers => {\n                _handlers.onClick(e);\n              });\n            },\n            onMouseenter: e => {\n              ascendantAndCurrentHandlers.forEach(_handlers => {\n                _handlers.onMouseenter(e);\n              });\n            },\n            onMouseleave: e => {\n              ascendantAndCurrentHandlers.forEach(_handlers => {\n                _handlers.onMouseleave(e);\n              });\n            }\n          };\n          appendEvents(triggerVNode, internalInheritedEventHandlers ? 'nested' : positionManually ? 'manual' : this.trigger, mergedHandlers);\n        }\n      }\n    }\n\n    return h(VBinder, {\n      ref: \"binderInstRef\",\n      syncTarget: !popoverInside,\n      syncTargetWithParent: this.internalSyncTargetWithParent\n    }, {\n      default: () => {\n        // We need to subscribe it. Sometimes rerender won't ge triggered.\n        // `mergedShowConsideringDisabledProp` is not the final disabled status.\n        // In ellpisis it's dynamic.\n        void this.mergedShowConsideringDisabledProp;\n        const mergedShow = this.getMergedShow();\n        return [this.internalTrapFocus && mergedShow ? withDirectives(h(\"div\", {\n          style: {\n            position: 'fixed',\n            inset: 0\n          }\n        }), [[zindexable, {\n          enabled: mergedShow,\n          zIndex: this.zIndex\n        }]]) : null, positionManually ? null : h(VTarget, null, {\n          default: () => triggerVNode\n        }), h(NPopoverBody, keep(this.$props, bodyPropKeys, Object.assign(Object.assign({}, this.$attrs), {\n          showArrow: this.mergedShowArrow,\n          show: mergedShow\n        })), {\n          default: () => {\n            var _a, _b;\n\n            return (_b = (_a = this.$slots).default) === null || _b === void 0 ? void 0 : _b.call(_a);\n          },\n          header: () => {\n            var _a, _b;\n\n            return (_b = (_a = this.$slots).header) === null || _b === void 0 ? void 0 : _b.call(_a);\n          }\n        })];\n      }\n    });\n  }\n\n});","map":{"version":3,"sources":["G:/VUE_FDS/fluent-vue/node_modules/naive-ui/es/popover/src/Popover.js"],"names":["h","ref","computed","createTextVNode","defineComponent","provide","toRef","cloneVNode","watchEffect","withDirectives","VBinder","VTarget","useMergedState","useCompitable","useIsMounted","useMemo","call","keep","getFirstSlotVNode","warnOnce","useAdjustedTo","useTheme","NPopoverBody","popoverBodyProps","zindexable","bodyPropKeys","Object","keys","triggerEventMap","focus","click","hover","manual","nested","appendEvents","vNode","trigger","events","forEach","eventName","props","assign","originalHandler","handler","args","textVNodeType","type","popoverBaseProps","show","Boolean","default","undefined","defaultShow","showArrow","String","delay","Number","duration","raw","placement","x","y","arrowPointToCenter","disabled","getDisabled","Function","displayDirective","arrowStyle","flip","animated","width","overlap","keepAliveOnHover","onClickoutside","internalExtraClass","Array","onUpdateShow","zIndex","to","propTo","internalSyncTargetWithParent","internalInheritedEventHandlers","internalTrapFocus","onShow","onHide","arrow","minWidth","maxWidth","popoverProps","internalRenderBody","name","inheritAttrs","__popover__","setup","process","env","NODE_ENV","isMountedRef","binderInstRef","controlledShowRef","uncontrolledShowRef","mergedShowWithoutDisabledRef","mergedShowConsideringDisabledPropRef","value","getMergedDisabled","getMergedShow","compatibleShowArrowRef","mergedShowArrowRef","bodyInstance","showTimerIdRef","hideTimerIdRef","positionManuallyRef","doUpdateShow","_onUpdateShow","syncPosition","clearShowTimer","showTimerId","window","clearTimeout","clearHideTimer","hideTimerId","handleFocus","mergedDisabled","handleBlur","handleMouseEnter","delayCallback","setTimeout","handleMouseLeave","delayedCallback","handleMouseMoveOutside","handleClickOutside","e","_a","handleClick","nextShow","handleKeydown","code","setShow","getTriggerElement","targetRef","setBodyInstance","zIndexRef","extraClassRef","internalRenderBodyRef","positionManually","mergedShowConsideringDisabledProp","uncontrolledShow","mergedShowArrow","render","$slots","slots","triggerVNode","popoverInside","activator","handlers","onClick","onMouseenter","onMouseleave","onFocus","onBlur","ascendantAndCurrentHandlers","mergedHandlers","_handlers","syncTarget","syncTargetWithParent","mergedShow","style","position","inset","enabled","$props","$attrs","_b","header"],"mappings":"AAAA,SAASA,CAAT,EAAYC,GAAZ,EAAiBC,QAAjB,EAA2BC,eAA3B,EAA4CC,eAA5C,EAA6DC,OAA7D,EAAsEC,KAAtE,EAA6EC,UAA7E,EAAyFC,WAAzF,EAAsGC,cAAtG,QAA4H,KAA5H;AACA,SAASC,OAAT,EAAkBC,OAAlB,QAAiC,OAAjC;AACA,SAASC,cAAT,EAAyBC,aAAzB,EAAwCC,YAAxC,EAAsDC,OAAtD,QAAqE,OAArE;AACA,SAASC,IAAT,EAAeC,IAAf,EAAqBC,iBAArB,EAAwCC,QAAxC,EAAkDC,aAAlD,QAAuE,cAAvE;AACA,SAASC,QAAT,QAAyB,eAAzB;AACA,OAAOC,YAAP,IAAuBC,gBAAvB,QAA+C,eAA/C;AACA,SAASC,UAAT,QAA2B,OAA3B;AACA,MAAMC,YAAY,GAAGC,MAAM,CAACC,IAAP,CAAYJ,gBAAZ,CAArB;AACA,MAAMK,eAAe,GAAG;AACpBC,EAAAA,KAAK,EAAE,CAAC,SAAD,EAAY,QAAZ,CADa;AAEpBC,EAAAA,KAAK,EAAE,CAAC,SAAD,CAFa;AAGpBC,EAAAA,KAAK,EAAE,CAAC,cAAD,EAAiB,cAAjB,CAHa;AAIpBC,EAAAA,MAAM,EAAE,EAJY;AAKpBC,EAAAA,MAAM,EAAE,CAAC,SAAD,EAAY,QAAZ,EAAsB,cAAtB,EAAsC,cAAtC,EAAsD,SAAtD;AALY,CAAxB;;AAOA,SAASC,YAAT,CAAsBC,KAAtB,EAA6BC,OAA7B,EAAsCC,MAAtC,EAA8C;AAC1CT,EAAAA,eAAe,CAACQ,OAAD,CAAf,CAAyBE,OAAzB,CAAkCC,SAAD,IAAe;AAC5C,QAAI,CAACJ,KAAK,CAACK,KAAX,EACIL,KAAK,CAACK,KAAN,GAAc,EAAd,CADJ,KAEK;AACDL,MAAAA,KAAK,CAACK,KAAN,GAAcd,MAAM,CAACe,MAAP,CAAc,EAAd,EAAkBN,KAAK,CAACK,KAAxB,CAAd;AACH;AACD,UAAME,eAAe,GAAGP,KAAK,CAACK,KAAN,CAAYD,SAAZ,CAAxB;AACA,UAAMI,OAAO,GAAGN,MAAM,CAACE,SAAD,CAAtB;AACA,QAAI,CAACG,eAAL,EACIP,KAAK,CAACK,KAAN,CAAYD,SAAZ,IAAyBI,OAAzB,CADJ,KAEK;AACDR,MAAAA,KAAK,CAACK,KAAN,CAAYD,SAAZ,IAAyB,CAAC,GAAGK,IAAJ,KAAa;AAClCF,QAAAA,eAAe,CAAC,GAAGE,IAAJ,CAAf;AACAD,QAAAA,OAAO,CAAC,GAAGC,IAAJ,CAAP;AACH,OAHD;AAIH;AACJ,GAhBD;AAiBH;;AACD,MAAMC,aAAa,GAAG1C,eAAe,CAAC,EAAD,CAAf,CAAoB2C,IAA1C;AACA,OAAO,MAAMC,gBAAgB,GAAG;AAC5BC,EAAAA,IAAI,EAAE;AACFF,IAAAA,IAAI,EAAEG,OADJ;AAEFC,IAAAA,OAAO,EAAEC;AAFP,GADsB;AAK5BC,EAAAA,WAAW,EAAEH,OALe;AAM5BI,EAAAA,SAAS,EAAE;AACPP,IAAAA,IAAI,EAAEG,OADC;AAEPC,IAAAA,OAAO,EAAE;AAFF,GANiB;AAU5Bd,EAAAA,OAAO,EAAE;AACLU,IAAAA,IAAI,EAAEQ,MADD;AAELJ,IAAAA,OAAO,EAAE;AAFJ,GAVmB;AAc5BK,EAAAA,KAAK,EAAE;AACHT,IAAAA,IAAI,EAAEU,MADH;AAEHN,IAAAA,OAAO,EAAE;AAFN,GAdqB;AAkB5BO,EAAAA,QAAQ,EAAE;AACNX,IAAAA,IAAI,EAAEU,MADA;AAENN,IAAAA,OAAO,EAAE;AAFH,GAlBkB;AAsB5BQ,EAAAA,GAAG,EAAET,OAtBuB;AAuB5BU,EAAAA,SAAS,EAAE;AACPb,IAAAA,IAAI,EAAEQ,MADC;AAEPJ,IAAAA,OAAO,EAAE;AAFF,GAvBiB;AA2B5BU,EAAAA,CAAC,EAAEJ,MA3ByB;AA4B5BK,EAAAA,CAAC,EAAEL,MA5ByB;AA6B5BM,EAAAA,kBAAkB,EAAEb,OA7BQ;AA8B5Bc,EAAAA,QAAQ,EAAEd,OA9BkB;AA+B5Be,EAAAA,WAAW,EAAEC,QA/Be;AAgC5BC,EAAAA,gBAAgB,EAAE;AACdpB,IAAAA,IAAI,EAAEQ,MADQ;AAEdJ,IAAAA,OAAO,EAAE;AAFK,GAhCU;AAoC5BiB,EAAAA,UAAU,EAAE,CAACb,MAAD,EAAS5B,MAAT,CApCgB;AAqC5B0C,EAAAA,IAAI,EAAE;AACFtB,IAAAA,IAAI,EAAEG,OADJ;AAEFC,IAAAA,OAAO,EAAE;AAFP,GArCsB;AAyC5BmB,EAAAA,QAAQ,EAAE;AACNvB,IAAAA,IAAI,EAAEG,OADA;AAENC,IAAAA,OAAO,EAAE;AAFH,GAzCkB;AA6C5BoB,EAAAA,KAAK,EAAE;AACHxB,IAAAA,IAAI,EAAE,CAACU,MAAD,EAASF,MAAT,CADH;AAEHJ,IAAAA,OAAO,EAAEC;AAFN,GA7CqB;AAiD5BoB,EAAAA,OAAO,EAAEtB,OAjDmB;AAkD5BuB,EAAAA,gBAAgB,EAAE;AACd1B,IAAAA,IAAI,EAAEG,OADQ;AAEdC,IAAAA,OAAO,EAAE;AAFK,GAlDU;AAsD5BuB,EAAAA,cAAc,EAAER,QAtDY;AAuD5BS,EAAAA,kBAAkB,EAAE;AAChB5B,IAAAA,IAAI,EAAE6B,KADU;AAEhBzB,IAAAA,OAAO,EAAE,MAAM;AAFC,GAvDQ;AA2D5B;AACA,mBAAiB,CAACe,QAAD,EAAWU,KAAX,CA5DW;AA6D5BC,EAAAA,YAAY,EAAE,CAACX,QAAD,EAAWU,KAAX,CA7Dc;AA8D5BE,EAAAA,MAAM,EAAErB,MA9DoB;AA+D5BsB,EAAAA,EAAE,EAAE1D,aAAa,CAAC2D,MA/DU;AAgE5BC,EAAAA,4BAA4B,EAAE/B,OAhEF;AAiE5BgC,EAAAA,8BAA8B,EAAE;AAC5BnC,IAAAA,IAAI,EAAE6B,KADsB;AAE5BzB,IAAAA,OAAO,EAAE,MAAM;AAFa,GAjEJ;AAqE5BgC,EAAAA,iBAAiB,EAAEjC,OArES;;AAsE5B;AACAkC,EAAAA,MAAM,EAAE,CAAClB,QAAD,EAAWU,KAAX,CAvEoB;;AAwE5B;AACAS,EAAAA,MAAM,EAAE,CAACnB,QAAD,EAAWU,KAAX,CAzEoB;;AA0E5B;AACAU,EAAAA,KAAK,EAAE;AACHvC,IAAAA,IAAI,EAAEG,OADH;AAEHC,IAAAA,OAAO,EAAEC;AAFN,GA3EqB;;AA+E5B;AACAmC,EAAAA,QAAQ,EAAE9B,MAhFkB;;AAiF5B;AACA+B,EAAAA,QAAQ,EAAE/B;AAlFkB,CAAzB;AAoFP,MAAMgC,YAAY,GAAG9D,MAAM,CAACe,MAAP,CAAcf,MAAM,CAACe,MAAP,CAAcf,MAAM,CAACe,MAAP,CAAc,EAAd,EAAkBpB,QAAQ,CAACmB,KAA3B,CAAd,EAAiDO,gBAAjD,CAAd,EAAkF;AAAE0C,EAAAA,kBAAkB,EAAExB;AAAtB,CAAlF,CAArB;AACA,eAAe7D,eAAe,CAAC;AAC3BsF,EAAAA,IAAI,EAAE,SADqB;AAE3BC,EAAAA,YAAY,EAAE,KAFa;AAG3BnD,EAAAA,KAAK,EAAEgD,YAHoB;AAI3BI,EAAAA,WAAW,EAAE,IAJc;;AAK3BC,EAAAA,KAAK,CAACrD,KAAD,EAAQ;AACT,QAAIsD,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAA7B,EAA2C;AACvCxF,MAAAA,WAAW,CAAC,MAAM;AACd,YAAIgC,KAAK,CAAC+C,QAAN,KAAmBpC,SAAvB,EAAkC;AAC9BhC,UAAAA,QAAQ,CAAC,SAAD,EAAY,wDAAZ,CAAR;AACH;;AACD,YAAIqB,KAAK,CAAC8C,QAAN,KAAmBnC,SAAvB,EAAkC;AAC9BhC,UAAAA,QAAQ,CAAC,SAAD,EAAY,wDAAZ,CAAR;AACH;;AACD,YAAIqB,KAAK,CAAC6C,KAAN,KAAgBlC,SAApB,EAA+B;AAC3BhC,UAAAA,QAAQ,CAAC,SAAD,EAAY,wDAAZ,CAAR;AACH;;AACD,YAAIqB,KAAK,CAAC4C,MAAN,KAAiBjC,SAArB,EAAgC;AAC5BhC,UAAAA,QAAQ,CAAC,SAAD,EAAY,+DAAZ,CAAR;AACH;;AACD,YAAIqB,KAAK,CAAC2C,MAAN,KAAiBhC,SAArB,EAAgC;AAC5BhC,UAAAA,QAAQ,CAAC,SAAD,EAAY,+DAAZ,CAAR;AACH;AACJ,OAhBU,CAAX;AAiBH;;AACD,UAAM8E,YAAY,GAAGnF,YAAY,EAAjC;AACA,UAAMoF,aAAa,GAAGjG,GAAG,CAAC,IAAD,CAAzB,CArBS,CAsBT;;AACA,UAAMkG,iBAAiB,GAAGjG,QAAQ,CAAC,MAAMsC,KAAK,CAACQ,IAAb,CAAlC;AACA,UAAMoD,mBAAmB,GAAGnG,GAAG,CAACuC,KAAK,CAACY,WAAP,CAA/B;AACA,UAAMiD,4BAA4B,GAAGzF,cAAc,CAACuF,iBAAD,EAAoBC,mBAApB,CAAnD;AACA,UAAME,oCAAoC,GAAGvF,OAAO,CAAC,MAAM;AACvD,UAAIyB,KAAK,CAACuB,QAAV,EACI,OAAO,KAAP;AACJ,aAAOsC,4BAA4B,CAACE,KAApC;AACH,KAJmD,CAApD;;AAKA,UAAMC,iBAAiB,GAAG,MAAM;AAC5B,UAAIhE,KAAK,CAACuB,QAAV,EACI,OAAO,IAAP;AACJ,YAAM;AAAEC,QAAAA;AAAF,UAAkBxB,KAAxB;AACA,UAAIwB,WAAW,KAAK,IAAhB,IAAwBA,WAAW,KAAK,KAAK,CAA7C,GAAiD,KAAK,CAAtD,GAA0DA,WAAW,EAAzE,EACI,OAAO,IAAP;AACJ,aAAO,KAAP;AACH,KAPD;;AAQA,UAAMyC,aAAa,GAAG,MAAM;AACxB,UAAID,iBAAiB,EAArB,EACI,OAAO,KAAP;AACJ,aAAOH,4BAA4B,CAACE,KAApC;AACH,KAJD,CAvCS,CA4CT;;;AACA,UAAMG,sBAAsB,GAAG7F,aAAa,CAAC2B,KAAD,EAAQ,CAAC,OAAD,EAAU,WAAV,CAAR,CAA5C;AACA,UAAMmE,kBAAkB,GAAGzG,QAAQ,CAAC,MAAM;AACtC,UAAIsC,KAAK,CAAC+B,OAAV,EACI,OAAO,KAAP;AACJ,aAAOmC,sBAAsB,CAACH,KAA9B;AACH,KAJkC,CAAnC,CA9CS,CAmDT;;AACA,QAAIK,YAAY,GAAG,IAAnB;AACA,UAAMC,cAAc,GAAG5G,GAAG,CAAC,IAAD,CAA1B;AACA,UAAM6G,cAAc,GAAG7G,GAAG,CAAC,IAAD,CAA1B;AACA,UAAM8G,mBAAmB,GAAGhG,OAAO,CAAC,MAAM;AACtC,aAAOyB,KAAK,CAACoB,CAAN,KAAYT,SAAZ,IAAyBX,KAAK,CAACqB,CAAN,KAAYV,SAA5C;AACH,KAFkC,CAAnC,CAvDS,CA0DT;;AACA,aAAS6D,YAAT,CAAsBT,KAAtB,EAA6B;AACzB,YAAM;AAAE,yBAAiBU,aAAnB;AAAkCrC,QAAAA,YAAlC;AAAgDO,QAAAA,MAAhD;AAAwDC,QAAAA;AAAxD,UAAmE5C,KAAzE;AACA4D,MAAAA,mBAAmB,CAACG,KAApB,GAA4BA,KAA5B;;AACA,UAAIU,aAAJ,EAAmB;AACfjG,QAAAA,IAAI,CAACiG,aAAD,EAAgBV,KAAhB,CAAJ;AACH;;AACD,UAAI3B,YAAJ,EAAkB;AACd5D,QAAAA,IAAI,CAAC4D,YAAD,EAAe2B,KAAf,CAAJ;AACH;;AACD,UAAIA,KAAK,IAAIpB,MAAb,EAAqB;AACjBnE,QAAAA,IAAI,CAACmE,MAAD,EAAS,IAAT,CAAJ;AACH;;AACD,UAAIoB,KAAK,IAAInB,MAAb,EAAqB;AACjBpE,QAAAA,IAAI,CAACoE,MAAD,EAAS,KAAT,CAAJ;AACH;AACJ;;AACD,aAAS8B,YAAT,GAAwB;AACpB,UAAIN,YAAJ,EAAkB;AACdA,QAAAA,YAAY,CAACM,YAAb;AACH;AACJ;;AACD,aAASC,cAAT,GAA0B;AACtB,YAAM;AAAEZ,QAAAA,KAAK,EAAEa;AAAT,UAAyBP,cAA/B;;AACA,UAAIO,WAAJ,EAAiB;AACbC,QAAAA,MAAM,CAACC,YAAP,CAAoBF,WAApB;AACAP,QAAAA,cAAc,CAACN,KAAf,GAAuB,IAAvB;AACH;AACJ;;AACD,aAASgB,cAAT,GAA0B;AACtB,YAAM;AAAEhB,QAAAA,KAAK,EAAEiB;AAAT,UAAyBV,cAA/B;;AACA,UAAIU,WAAJ,EAAiB;AACbH,QAAAA,MAAM,CAACC,YAAP,CAAoBE,WAApB;AACAV,QAAAA,cAAc,CAACP,KAAf,GAAuB,IAAvB;AACH;AACJ;;AACD,aAASkB,WAAT,GAAuB;AACnB,YAAMC,cAAc,GAAGlB,iBAAiB,EAAxC;;AACA,UAAIhE,KAAK,CAACJ,OAAN,KAAkB,OAAlB,IAA6B,CAACsF,cAAlC,EAAkD;AAC9C,YAAIjB,aAAa,EAAjB,EACI;AACJO,QAAAA,YAAY,CAAC,IAAD,CAAZ;AACH;AACJ;;AACD,aAASW,UAAT,GAAsB;AAClB,YAAMD,cAAc,GAAGlB,iBAAiB,EAAxC;;AACA,UAAIhE,KAAK,CAACJ,OAAN,KAAkB,OAAlB,IAA6B,CAACsF,cAAlC,EAAkD;AAC9C,YAAI,CAACjB,aAAa,EAAlB,EACI;AACJO,QAAAA,YAAY,CAAC,KAAD,CAAZ;AACH;AACJ;;AACD,aAASY,gBAAT,GAA4B;AACxB,YAAMF,cAAc,GAAGlB,iBAAiB,EAAxC;;AACA,UAAIhE,KAAK,CAACJ,OAAN,KAAkB,OAAlB,IAA6B,CAACsF,cAAlC,EAAkD;AAC9CH,QAAAA,cAAc;AACd,YAAIV,cAAc,CAACN,KAAf,KAAyB,IAA7B,EACI;AACJ,YAAIE,aAAa,EAAjB,EACI;;AACJ,cAAMoB,aAAa,GAAG,MAAM;AACxBb,UAAAA,YAAY,CAAC,IAAD,CAAZ;AACAH,UAAAA,cAAc,CAACN,KAAf,GAAuB,IAAvB;AACH,SAHD;;AAIA,cAAM;AAAEhD,UAAAA;AAAF,YAAYf,KAAlB;;AACA,YAAIe,KAAK,KAAK,CAAd,EAAiB;AACbsE,UAAAA,aAAa;AAChB,SAFD,MAGK;AACDhB,UAAAA,cAAc,CAACN,KAAf,GAAuBc,MAAM,CAACS,UAAP,CAAkBD,aAAlB,EAAiCtE,KAAjC,CAAvB;AACH;AACJ;AACJ;;AACD,aAASwE,gBAAT,GAA4B;AACxB,YAAML,cAAc,GAAGlB,iBAAiB,EAAxC;;AACA,UAAIhE,KAAK,CAACJ,OAAN,KAAkB,OAAlB,IAA6B,CAACsF,cAAlC,EAAkD;AAC9CP,QAAAA,cAAc;AACd,YAAIL,cAAc,CAACP,KAAf,KAAyB,IAA7B,EACI;AACJ,YAAI,CAACE,aAAa,EAAlB,EACI;;AACJ,cAAMuB,eAAe,GAAG,MAAM;AAC1BhB,UAAAA,YAAY,CAAC,KAAD,CAAZ;AACAF,UAAAA,cAAc,CAACP,KAAf,GAAuB,IAAvB;AACH,SAHD;;AAIA,cAAM;AAAE9C,UAAAA;AAAF,YAAejB,KAArB;;AACA,YAAIiB,QAAQ,KAAK,CAAjB,EAAoB;AAChBuE,UAAAA,eAAe;AAClB,SAFD,MAGK;AACDlB,UAAAA,cAAc,CAACP,KAAf,GAAuBc,MAAM,CAACS,UAAP,CAAkBE,eAAlB,EAAmCvE,QAAnC,CAAvB;AACH;AACJ;AACJ,KAvJQ,CAwJT;;;AACA,aAASwE,sBAAT,GAAkC;AAC9BF,MAAAA,gBAAgB;AACnB,KA3JQ,CA4JT;;;AACA,aAASG,kBAAT,CAA4BC,CAA5B,EAA+B;AAC3B,UAAIC,EAAJ;;AACA,UAAI,CAAC3B,aAAa,EAAlB,EACI;;AACJ,UAAIjE,KAAK,CAACJ,OAAN,KAAkB,OAAtB,EAA+B;AAC3B+E,QAAAA,cAAc;AACdI,QAAAA,cAAc;AACdP,QAAAA,YAAY,CAAC,KAAD,CAAZ;AACH;;AACD,OAACoB,EAAE,GAAG5F,KAAK,CAACiC,cAAZ,MAAgC,IAAhC,IAAwC2D,EAAE,KAAK,KAAK,CAApD,GAAwD,KAAK,CAA7D,GAAiEA,EAAE,CAACpH,IAAH,CAAQwB,KAAR,EAAe2F,CAAf,CAAjE;AACH;;AACD,aAASE,WAAT,GAAuB;AACnB,UAAI7F,KAAK,CAACJ,OAAN,KAAkB,OAAlB,IAA6B,CAACoE,iBAAiB,EAAnD,EAAuD;AACnDW,QAAAA,cAAc;AACdI,QAAAA,cAAc;AACd,cAAMe,QAAQ,GAAG,CAAC7B,aAAa,EAA/B;AACAO,QAAAA,YAAY,CAACsB,QAAD,CAAZ;AACH;AACJ;;AACD,aAASC,aAAT,CAAuBJ,CAAvB,EAA0B;AACtB,UAAI,CAAC3F,KAAK,CAAC0C,iBAAX,EACI;;AACJ,UAAIiD,CAAC,CAACK,IAAF,KAAW,QAAf,EAAyB;AACrBrB,QAAAA,cAAc;AACdI,QAAAA,cAAc;AACdP,QAAAA,YAAY,CAAC,KAAD,CAAZ;AACH;AACJ;;AACD,aAASyB,OAAT,CAAiBlC,KAAjB,EAAwB;AACpBH,MAAAA,mBAAmB,CAACG,KAApB,GAA4BA,KAA5B;AACH;;AACD,aAASmC,iBAAT,GAA6B;AACzB,UAAIN,EAAJ;;AACA,aAAO,CAACA,EAAE,GAAGlC,aAAa,CAACK,KAApB,MAA+B,IAA/B,IAAuC6B,EAAE,KAAK,KAAK,CAAnD,GAAuD,KAAK,CAA5D,GAAgEA,EAAE,CAACO,SAA1E;AACH;;AACD,aAASC,eAAT,CAAyBrC,KAAzB,EAAgC;AAC5BK,MAAAA,YAAY,GAAGL,KAAf;AACH;;AACDlG,IAAAA,OAAO,CAAC,UAAD,EAAa;AAChBqI,MAAAA,iBADgB;AAEhBH,MAAAA,aAFgB;AAGhBX,MAAAA,gBAHgB;AAIhBG,MAAAA,gBAJgB;AAKhBG,MAAAA,kBALgB;AAMhBD,MAAAA,sBANgB;AAOhBW,MAAAA,eAPgB;AAQhB7B,MAAAA,mBAAmB,EAAEA,mBARL;AAShBd,MAAAA,YAAY,EAAEA,YATE;AAUhB4C,MAAAA,SAAS,EAAEvI,KAAK,CAACkC,KAAD,EAAQ,QAAR,CAVA;AAWhBsG,MAAAA,aAAa,EAAExI,KAAK,CAACkC,KAAD,EAAQ,oBAAR,CAXJ;AAYhBuG,MAAAA,qBAAqB,EAAEzI,KAAK,CAACkC,KAAD,EAAQ,oBAAR;AAZZ,KAAb,CAAP;AAcA,WAAO;AACH0D,MAAAA,aADG;AAEH8C,MAAAA,gBAAgB,EAAEjC,mBAFf;AAGHkC,MAAAA,iCAAiC,EAAE3C,oCAHhC;AAIH;AACA4C,MAAAA,gBAAgB,EAAE9C,mBALf;AAMH+C,MAAAA,eAAe,EAAExC,kBANd;AAOHF,MAAAA,aAPG;AAQHgC,MAAAA,OARG;AASHJ,MAAAA,WATG;AAUHT,MAAAA,gBAVG;AAWHG,MAAAA,gBAXG;AAYHN,MAAAA,WAZG;AAaHE,MAAAA,UAbG;AAcHT,MAAAA;AAdG,KAAP;AAgBH,GAtO0B;;AAuO3BkC,EAAAA,MAAM,GAAG;AACL,QAAIhB,EAAJ;;AACA,UAAM;AAAEY,MAAAA,gBAAF;AAAoBK,MAAAA,MAAM,EAAEC;AAA5B,QAAsC,IAA5C;AACA,QAAIC,YAAJ;AACA,QAAIC,aAAa,GAAG,KAApB;;AACA,QAAI,CAACR,gBAAL,EAAuB;AACnB,UAAIM,KAAK,CAACG,SAAV,EAAqB;AACjBF,QAAAA,YAAY,GAAGrI,iBAAiB,CAACoI,KAAD,EAAQ,WAAR,CAAhC;AACH,OAFD,MAGK;AACDC,QAAAA,YAAY,GAAGrI,iBAAiB,CAACoI,KAAD,EAAQ,SAAR,CAAhC;AACH;;AACD,UAAIC,YAAJ,EAAkB;AACdA,QAAAA,YAAY,GAAGhJ,UAAU,CAACgJ,YAAD,CAAzB;AACAA,QAAAA,YAAY,GACRA,YAAY,CAACzG,IAAb,KAAsBD,aAAtB,GACM7C,CAAC,CAAC,MAAD,EAAS,CAACuJ,YAAD,CAAT,CADP,GAEMA,YAHV;AAIA,cAAMG,QAAQ,GAAG;AACbC,UAAAA,OAAO,EAAE,KAAKtB,WADD;AAEbuB,UAAAA,YAAY,EAAE,KAAKhC,gBAFN;AAGbiC,UAAAA,YAAY,EAAE,KAAK9B,gBAHN;AAIb+B,UAAAA,OAAO,EAAE,KAAKrC,WAJD;AAKbsC,UAAAA,MAAM,EAAE,KAAKpC;AALA,SAAjB;;AAOA,YAAI,CAACS,EAAE,GAAGmB,YAAY,CAACzG,IAAnB,MAA6B,IAA7B,IAAqCsF,EAAE,KAAK,KAAK,CAAjD,GAAqD,KAAK,CAA1D,GAA8DA,EAAE,CAACxC,WAArE,EAAkF;AAC9E4D,UAAAA,aAAa,GAAG,IAAhB,CAD8E,CAE9E;;AACA,cAAI,CAACD,YAAY,CAAC/G,KAAlB,EAAyB;AACrB+G,YAAAA,YAAY,CAAC/G,KAAb,GAAqB;AACjBwC,cAAAA,4BAA4B,EAAE,IADb;AAEjBC,cAAAA,8BAA8B,EAAE;AAFf,aAArB;AAIH;;AACDsE,UAAAA,YAAY,CAAC/G,KAAb,CAAmBwC,4BAAnB,GAAkD,IAAlD;;AACA,cAAI,CAACuE,YAAY,CAAC/G,KAAb,CAAmByC,8BAAxB,EAAwD;AACpDsE,YAAAA,YAAY,CAAC/G,KAAb,CAAmByC,8BAAnB,GAAoD,CAACyE,QAAD,CAApD;AACH,WAFD,MAGK;AACDH,YAAAA,YAAY,CAAC/G,KAAb,CAAmByC,8BAAnB,GAAoD,CAChDyE,QADgD,EAEhD,GAAGH,YAAY,CAAC/G,KAAb,CAAmByC,8BAF0B,CAApD;AAIH;AACJ,SAnBD,MAoBK;AACD,gBAAM;AAAEA,YAAAA;AAAF,cAAqC,IAA3C;AACA,gBAAM+E,2BAA2B,GAAG,CAChCN,QADgC,EAEhC,GAAGzE,8BAF6B,CAApC;AAIA,gBAAMgF,cAAc,GAAG;AACnBF,YAAAA,MAAM,EAAG5B,CAAD,IAAO;AACX6B,cAAAA,2BAA2B,CAAC1H,OAA5B,CAAqC4H,SAAD,IAAe;AAC/CA,gBAAAA,SAAS,CAACH,MAAV,CAAiB5B,CAAjB;AACH,eAFD;AAGH,aALkB;AAMnB2B,YAAAA,OAAO,EAAG3B,CAAD,IAAO;AACZ6B,cAAAA,2BAA2B,CAAC1H,OAA5B,CAAqC4H,SAAD,IAAe;AAC/CA,gBAAAA,SAAS,CAACJ,OAAV,CAAkB3B,CAAlB;AACH,eAFD;AAGH,aAVkB;AAWnBwB,YAAAA,OAAO,EAAGxB,CAAD,IAAO;AACZ6B,cAAAA,2BAA2B,CAAC1H,OAA5B,CAAqC4H,SAAD,IAAe;AAC/CA,gBAAAA,SAAS,CAACP,OAAV,CAAkBxB,CAAlB;AACH,eAFD;AAGH,aAfkB;AAgBnByB,YAAAA,YAAY,EAAGzB,CAAD,IAAO;AACjB6B,cAAAA,2BAA2B,CAAC1H,OAA5B,CAAqC4H,SAAD,IAAe;AAC/CA,gBAAAA,SAAS,CAACN,YAAV,CAAuBzB,CAAvB;AACH,eAFD;AAGH,aApBkB;AAqBnB0B,YAAAA,YAAY,EAAG1B,CAAD,IAAO;AACjB6B,cAAAA,2BAA2B,CAAC1H,OAA5B,CAAqC4H,SAAD,IAAe;AAC/CA,gBAAAA,SAAS,CAACL,YAAV,CAAuB1B,CAAvB;AACH,eAFD;AAGH;AAzBkB,WAAvB;AA2BAjG,UAAAA,YAAY,CAACqH,YAAD,EAAetE,8BAA8B,GACnD,QADmD,GAEnD+D,gBAAgB,GACZ,QADY,GAEZ,KAAK5G,OAJH,EAIY6H,cAJZ,CAAZ;AAKH;AACJ;AACJ;;AACD,WAAQjK,CAAC,CAACU,OAAD,EAAU;AAAET,MAAAA,GAAG,EAAE,eAAP;AAAwBkK,MAAAA,UAAU,EAAE,CAACX,aAArC;AAAoDY,MAAAA,oBAAoB,EAAE,KAAKpF;AAA/E,KAAV,EAAyH;AAC9H9B,MAAAA,OAAO,EAAE,MAAM;AACX;AACA;AACA;AACA,aAAK,KAAK+F,iCAAV;AACA,cAAMoB,UAAU,GAAG,KAAK5D,aAAL,EAAnB;AACA,eAAO,CACH,KAAKvB,iBAAL,IAA0BmF,UAA1B,GACM5J,cAAc,CAACT,CAAC,CAAC,KAAD,EAAQ;AAAEsK,UAAAA,KAAK,EAAE;AAAEC,YAAAA,QAAQ,EAAE,OAAZ;AAAqBC,YAAAA,KAAK,EAAE;AAA5B;AAAT,SAAR,CAAF,EAAuD,CACnE,CACIhJ,UADJ,EAEI;AACIiJ,UAAAA,OAAO,EAAEJ,UADb;AAEIxF,UAAAA,MAAM,EAAE,KAAKA;AAFjB,SAFJ,CADmE,CAAvD,CADpB,GAUM,IAXH,EAYHmE,gBAAgB,GACV,IADU,GAEVhJ,CAAC,CAACW,OAAD,EAAU,IAAV,EAAgB;AACfuC,UAAAA,OAAO,EAAE,MAAMqG;AADA,SAAhB,CAdJ,EAiBHvJ,CAAC,CAACsB,YAAD,EAAeL,IAAI,CAAC,KAAKyJ,MAAN,EAAcjJ,YAAd,EAA4BC,MAAM,CAACe,MAAP,CAAcf,MAAM,CAACe,MAAP,CAAc,EAAd,EAAkB,KAAKkI,MAAvB,CAAd,EAA8C;AAAEtH,UAAAA,SAAS,EAAE,KAAK8F,eAAlB;AAAmCnG,UAAAA,IAAI,EAAEqH;AAAzC,SAA9C,CAA5B,CAAnB,EAAsJ;AACnJnH,UAAAA,OAAO,EAAE,MAAM;AAAE,gBAAIkF,EAAJ,EAAQwC,EAAR;;AAAY,mBAAO,CAACA,EAAE,GAAG,CAACxC,EAAE,GAAG,KAAKiB,MAAX,EAAmBnG,OAAzB,MAAsC,IAAtC,IAA8C0H,EAAE,KAAK,KAAK,CAA1D,GAA8D,KAAK,CAAnE,GAAuEA,EAAE,CAAC5J,IAAH,CAAQoH,EAAR,CAA9E;AAA4F,WAD0B;AAEnJyC,UAAAA,MAAM,EAAE,MAAM;AAAE,gBAAIzC,EAAJ,EAAQwC,EAAR;;AAAY,mBAAO,CAACA,EAAE,GAAG,CAACxC,EAAE,GAAG,KAAKiB,MAAX,EAAmBwB,MAAzB,MAAqC,IAArC,IAA6CD,EAAE,KAAK,KAAK,CAAzD,GAA6D,KAAK,CAAlE,GAAsEA,EAAE,CAAC5J,IAAH,CAAQoH,EAAR,CAA7E;AAA2F;AAF4B,SAAtJ,CAjBE,CAAP;AAsBH;AA7B6H,KAAzH,CAAT;AA+BH;;AA5V0B,CAAD,CAA9B","sourcesContent":["import { h, ref, computed, createTextVNode, defineComponent, provide, toRef, cloneVNode, watchEffect, withDirectives } from 'vue';\nimport { VBinder, VTarget } from 'vueuc';\nimport { useMergedState, useCompitable, useIsMounted, useMemo } from 'vooks';\nimport { call, keep, getFirstSlotVNode, warnOnce, useAdjustedTo } from '../../_utils';\nimport { useTheme } from '../../_mixins';\nimport NPopoverBody, { popoverBodyProps } from './PopoverBody';\nimport { zindexable } from 'vdirs';\nconst bodyPropKeys = Object.keys(popoverBodyProps);\nconst triggerEventMap = {\n    focus: ['onFocus', 'onBlur'],\n    click: ['onClick'],\n    hover: ['onMouseenter', 'onMouseleave'],\n    manual: [],\n    nested: ['onFocus', 'onBlur', 'onMouseenter', 'onMouseleave', 'onClick']\n};\nfunction appendEvents(vNode, trigger, events) {\n    triggerEventMap[trigger].forEach((eventName) => {\n        if (!vNode.props)\n            vNode.props = {};\n        else {\n            vNode.props = Object.assign({}, vNode.props);\n        }\n        const originalHandler = vNode.props[eventName];\n        const handler = events[eventName];\n        if (!originalHandler)\n            vNode.props[eventName] = handler;\n        else {\n            vNode.props[eventName] = (...args) => {\n                originalHandler(...args);\n                handler(...args);\n            };\n        }\n    });\n}\nconst textVNodeType = createTextVNode('').type;\nexport const popoverBaseProps = {\n    show: {\n        type: Boolean,\n        default: undefined\n    },\n    defaultShow: Boolean,\n    showArrow: {\n        type: Boolean,\n        default: true\n    },\n    trigger: {\n        type: String,\n        default: 'hover'\n    },\n    delay: {\n        type: Number,\n        default: 100\n    },\n    duration: {\n        type: Number,\n        default: 100\n    },\n    raw: Boolean,\n    placement: {\n        type: String,\n        default: 'top'\n    },\n    x: Number,\n    y: Number,\n    arrowPointToCenter: Boolean,\n    disabled: Boolean,\n    getDisabled: Function,\n    displayDirective: {\n        type: String,\n        default: 'if'\n    },\n    arrowStyle: [String, Object],\n    flip: {\n        type: Boolean,\n        default: true\n    },\n    animated: {\n        type: Boolean,\n        default: true\n    },\n    width: {\n        type: [Number, String],\n        default: undefined\n    },\n    overlap: Boolean,\n    keepAliveOnHover: {\n        type: Boolean,\n        default: true\n    },\n    onClickoutside: Function,\n    internalExtraClass: {\n        type: Array,\n        default: () => []\n    },\n    // events\n    'onUpdate:show': [Function, Array],\n    onUpdateShow: [Function, Array],\n    zIndex: Number,\n    to: useAdjustedTo.propTo,\n    internalSyncTargetWithParent: Boolean,\n    internalInheritedEventHandlers: {\n        type: Array,\n        default: () => []\n    },\n    internalTrapFocus: Boolean,\n    /** @deprecated */\n    onShow: [Function, Array],\n    /** @deprecated */\n    onHide: [Function, Array],\n    /** @deprecated */\n    arrow: {\n        type: Boolean,\n        default: undefined\n    },\n    /** @deprecated */\n    minWidth: Number,\n    /** @deprecated */\n    maxWidth: Number\n};\nconst popoverProps = Object.assign(Object.assign(Object.assign({}, useTheme.props), popoverBaseProps), { internalRenderBody: Function });\nexport default defineComponent({\n    name: 'Popover',\n    inheritAttrs: false,\n    props: popoverProps,\n    __popover__: true,\n    setup(props) {\n        if (process.env.NODE_ENV !== 'production') {\n            watchEffect(() => {\n                if (props.maxWidth !== undefined) {\n                    warnOnce('popover', '`max-width` is deprecated, please use `style` instead.');\n                }\n                if (props.minWidth !== undefined) {\n                    warnOnce('popover', '`min-width` is deprecated, please use `style` instead.');\n                }\n                if (props.arrow !== undefined) {\n                    warnOnce('popover', '`arrow` is deprecated, please use `showArrow` instead.');\n                }\n                if (props.onHide !== undefined) {\n                    warnOnce('popover', '`on-hide` is deprecated, please use `on-update:show` instead.');\n                }\n                if (props.onShow !== undefined) {\n                    warnOnce('popover', '`on-show` is deprecated, please use `on-update:show` instead.');\n                }\n            });\n        }\n        const isMountedRef = useIsMounted();\n        const binderInstRef = ref(null);\n        // setup show\n        const controlledShowRef = computed(() => props.show);\n        const uncontrolledShowRef = ref(props.defaultShow);\n        const mergedShowWithoutDisabledRef = useMergedState(controlledShowRef, uncontrolledShowRef);\n        const mergedShowConsideringDisabledPropRef = useMemo(() => {\n            if (props.disabled)\n                return false;\n            return mergedShowWithoutDisabledRef.value;\n        });\n        const getMergedDisabled = () => {\n            if (props.disabled)\n                return true;\n            const { getDisabled } = props;\n            if (getDisabled === null || getDisabled === void 0 ? void 0 : getDisabled())\n                return true;\n            return false;\n        };\n        const getMergedShow = () => {\n            if (getMergedDisabled())\n                return false;\n            return mergedShowWithoutDisabledRef.value;\n        };\n        // setup show-arrow\n        const compatibleShowArrowRef = useCompitable(props, ['arrow', 'showArrow']);\n        const mergedShowArrowRef = computed(() => {\n            if (props.overlap)\n                return false;\n            return compatibleShowArrowRef.value;\n        });\n        // bodyInstance\n        let bodyInstance = null;\n        const showTimerIdRef = ref(null);\n        const hideTimerIdRef = ref(null);\n        const positionManuallyRef = useMemo(() => {\n            return props.x !== undefined && props.y !== undefined;\n        });\n        // methods\n        function doUpdateShow(value) {\n            const { 'onUpdate:show': _onUpdateShow, onUpdateShow, onShow, onHide } = props;\n            uncontrolledShowRef.value = value;\n            if (_onUpdateShow) {\n                call(_onUpdateShow, value);\n            }\n            if (onUpdateShow) {\n                call(onUpdateShow, value);\n            }\n            if (value && onShow) {\n                call(onShow, true);\n            }\n            if (value && onHide) {\n                call(onHide, false);\n            }\n        }\n        function syncPosition() {\n            if (bodyInstance) {\n                bodyInstance.syncPosition();\n            }\n        }\n        function clearShowTimer() {\n            const { value: showTimerId } = showTimerIdRef;\n            if (showTimerId) {\n                window.clearTimeout(showTimerId);\n                showTimerIdRef.value = null;\n            }\n        }\n        function clearHideTimer() {\n            const { value: hideTimerId } = hideTimerIdRef;\n            if (hideTimerId) {\n                window.clearTimeout(hideTimerId);\n                hideTimerIdRef.value = null;\n            }\n        }\n        function handleFocus() {\n            const mergedDisabled = getMergedDisabled();\n            if (props.trigger === 'focus' && !mergedDisabled) {\n                if (getMergedShow())\n                    return;\n                doUpdateShow(true);\n            }\n        }\n        function handleBlur() {\n            const mergedDisabled = getMergedDisabled();\n            if (props.trigger === 'focus' && !mergedDisabled) {\n                if (!getMergedShow())\n                    return;\n                doUpdateShow(false);\n            }\n        }\n        function handleMouseEnter() {\n            const mergedDisabled = getMergedDisabled();\n            if (props.trigger === 'hover' && !mergedDisabled) {\n                clearHideTimer();\n                if (showTimerIdRef.value !== null)\n                    return;\n                if (getMergedShow())\n                    return;\n                const delayCallback = () => {\n                    doUpdateShow(true);\n                    showTimerIdRef.value = null;\n                };\n                const { delay } = props;\n                if (delay === 0) {\n                    delayCallback();\n                }\n                else {\n                    showTimerIdRef.value = window.setTimeout(delayCallback, delay);\n                }\n            }\n        }\n        function handleMouseLeave() {\n            const mergedDisabled = getMergedDisabled();\n            if (props.trigger === 'hover' && !mergedDisabled) {\n                clearShowTimer();\n                if (hideTimerIdRef.value !== null)\n                    return;\n                if (!getMergedShow())\n                    return;\n                const delayedCallback = () => {\n                    doUpdateShow(false);\n                    hideTimerIdRef.value = null;\n                };\n                const { duration } = props;\n                if (duration === 0) {\n                    delayedCallback();\n                }\n                else {\n                    hideTimerIdRef.value = window.setTimeout(delayedCallback, duration);\n                }\n            }\n        }\n        // will be called in popover-content\n        function handleMouseMoveOutside() {\n            handleMouseLeave();\n        }\n        // will be called in popover-content\n        function handleClickOutside(e) {\n            var _a;\n            if (!getMergedShow())\n                return;\n            if (props.trigger === 'click') {\n                clearShowTimer();\n                clearHideTimer();\n                doUpdateShow(false);\n            }\n            (_a = props.onClickoutside) === null || _a === void 0 ? void 0 : _a.call(props, e);\n        }\n        function handleClick() {\n            if (props.trigger === 'click' && !getMergedDisabled()) {\n                clearShowTimer();\n                clearHideTimer();\n                const nextShow = !getMergedShow();\n                doUpdateShow(nextShow);\n            }\n        }\n        function handleKeydown(e) {\n            if (!props.internalTrapFocus)\n                return;\n            if (e.code === 'Escape') {\n                clearShowTimer();\n                clearHideTimer();\n                doUpdateShow(false);\n            }\n        }\n        function setShow(value) {\n            uncontrolledShowRef.value = value;\n        }\n        function getTriggerElement() {\n            var _a;\n            return (_a = binderInstRef.value) === null || _a === void 0 ? void 0 : _a.targetRef;\n        }\n        function setBodyInstance(value) {\n            bodyInstance = value;\n        }\n        provide('NPopover', {\n            getTriggerElement,\n            handleKeydown,\n            handleMouseEnter,\n            handleMouseLeave,\n            handleClickOutside,\n            handleMouseMoveOutside,\n            setBodyInstance,\n            positionManuallyRef: positionManuallyRef,\n            isMountedRef: isMountedRef,\n            zIndexRef: toRef(props, 'zIndex'),\n            extraClassRef: toRef(props, 'internalExtraClass'),\n            internalRenderBodyRef: toRef(props, 'internalRenderBody')\n        });\n        return {\n            binderInstRef,\n            positionManually: positionManuallyRef,\n            mergedShowConsideringDisabledProp: mergedShowConsideringDisabledPropRef,\n            // if to show popover body\n            uncontrolledShow: uncontrolledShowRef,\n            mergedShowArrow: mergedShowArrowRef,\n            getMergedShow,\n            setShow,\n            handleClick,\n            handleMouseEnter,\n            handleMouseLeave,\n            handleFocus,\n            handleBlur,\n            syncPosition\n        };\n    },\n    render() {\n        var _a;\n        const { positionManually, $slots: slots } = this;\n        let triggerVNode;\n        let popoverInside = false;\n        if (!positionManually) {\n            if (slots.activator) {\n                triggerVNode = getFirstSlotVNode(slots, 'activator');\n            }\n            else {\n                triggerVNode = getFirstSlotVNode(slots, 'trigger');\n            }\n            if (triggerVNode) {\n                triggerVNode = cloneVNode(triggerVNode);\n                triggerVNode =\n                    triggerVNode.type === textVNodeType\n                        ? h('span', [triggerVNode])\n                        : triggerVNode;\n                const handlers = {\n                    onClick: this.handleClick,\n                    onMouseenter: this.handleMouseEnter,\n                    onMouseleave: this.handleMouseLeave,\n                    onFocus: this.handleFocus,\n                    onBlur: this.handleBlur\n                };\n                if ((_a = triggerVNode.type) === null || _a === void 0 ? void 0 : _a.__popover__) {\n                    popoverInside = true;\n                    // We assume that there's no DOM event handlers on popover element\n                    if (!triggerVNode.props) {\n                        triggerVNode.props = {\n                            internalSyncTargetWithParent: true,\n                            internalInheritedEventHandlers: []\n                        };\n                    }\n                    triggerVNode.props.internalSyncTargetWithParent = true;\n                    if (!triggerVNode.props.internalInheritedEventHandlers) {\n                        triggerVNode.props.internalInheritedEventHandlers = [handlers];\n                    }\n                    else {\n                        triggerVNode.props.internalInheritedEventHandlers = [\n                            handlers,\n                            ...triggerVNode.props.internalInheritedEventHandlers\n                        ];\n                    }\n                }\n                else {\n                    const { internalInheritedEventHandlers } = this;\n                    const ascendantAndCurrentHandlers = [\n                        handlers,\n                        ...internalInheritedEventHandlers\n                    ];\n                    const mergedHandlers = {\n                        onBlur: (e) => {\n                            ascendantAndCurrentHandlers.forEach((_handlers) => {\n                                _handlers.onBlur(e);\n                            });\n                        },\n                        onFocus: (e) => {\n                            ascendantAndCurrentHandlers.forEach((_handlers) => {\n                                _handlers.onFocus(e);\n                            });\n                        },\n                        onClick: (e) => {\n                            ascendantAndCurrentHandlers.forEach((_handlers) => {\n                                _handlers.onClick(e);\n                            });\n                        },\n                        onMouseenter: (e) => {\n                            ascendantAndCurrentHandlers.forEach((_handlers) => {\n                                _handlers.onMouseenter(e);\n                            });\n                        },\n                        onMouseleave: (e) => {\n                            ascendantAndCurrentHandlers.forEach((_handlers) => {\n                                _handlers.onMouseleave(e);\n                            });\n                        }\n                    };\n                    appendEvents(triggerVNode, internalInheritedEventHandlers\n                        ? 'nested'\n                        : positionManually\n                            ? 'manual'\n                            : this.trigger, mergedHandlers);\n                }\n            }\n        }\n        return (h(VBinder, { ref: \"binderInstRef\", syncTarget: !popoverInside, syncTargetWithParent: this.internalSyncTargetWithParent }, {\n            default: () => {\n                // We need to subscribe it. Sometimes rerender won't ge triggered.\n                // `mergedShowConsideringDisabledProp` is not the final disabled status.\n                // In ellpisis it's dynamic.\n                void this.mergedShowConsideringDisabledProp;\n                const mergedShow = this.getMergedShow();\n                return [\n                    this.internalTrapFocus && mergedShow\n                        ? withDirectives(h(\"div\", { style: { position: 'fixed', inset: 0 } }), [\n                            [\n                                zindexable,\n                                {\n                                    enabled: mergedShow,\n                                    zIndex: this.zIndex\n                                }\n                            ]\n                        ])\n                        : null,\n                    positionManually\n                        ? null\n                        : h(VTarget, null, {\n                            default: () => triggerVNode\n                        }),\n                    h(NPopoverBody, keep(this.$props, bodyPropKeys, Object.assign(Object.assign({}, this.$attrs), { showArrow: this.mergedShowArrow, show: mergedShow })), {\n                        default: () => { var _a, _b; return (_b = (_a = this.$slots).default) === null || _b === void 0 ? void 0 : _b.call(_a); },\n                        header: () => { var _a, _b; return (_b = (_a = this.$slots).header) === null || _b === void 0 ? void 0 : _b.call(_a); }\n                    })\n                ];\n            }\n        }));\n    }\n});\n"]},"metadata":{},"sourceType":"module"}