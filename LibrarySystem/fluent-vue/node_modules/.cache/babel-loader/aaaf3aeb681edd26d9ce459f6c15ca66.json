{"ast":null,"code":"import { h, withDirectives, Transition, ref, computed, defineComponent, provide, toRef, inject } from 'vue';\nimport { zindexable } from 'vdirs';\nimport { useIsMounted, useClicked, useClickPosition } from 'vooks';\nimport { VLazyTeleport } from 'vueuc';\nimport { dialogProviderInjectionKey } from '../../dialog/src/context';\nimport { useConfig, useTheme, useThemeClass } from '../../_mixins';\nimport { keep, call, warnOnce } from '../../_utils';\nimport { modalLight } from '../styles';\nimport { presetProps, presetPropsKeys } from './presetProps';\nimport NModalBodyWrapper from './BodyWrapper';\nimport { modalInjectionKey } from './interface';\nimport style from './styles/index.cssr';\nconst modalProps = Object.assign(Object.assign(Object.assign(Object.assign({}, useTheme.props), {\n  show: Boolean,\n  unstableShowMask: {\n    type: Boolean,\n    default: true\n  },\n  maskClosable: {\n    type: Boolean,\n    default: true\n  },\n  preset: String,\n  to: [String, Object],\n  displayDirective: {\n    type: String,\n    default: 'if'\n  },\n  transformOrigin: {\n    type: String,\n    default: 'mouse'\n  },\n  zIndex: Number,\n  autoFocus: {\n    type: Boolean,\n    default: true\n  },\n  trapFocus: {\n    type: Boolean,\n    default: true\n  },\n  closeOnEsc: {\n    type: Boolean,\n    default: true\n  }\n}), presetProps), {\n  // events\n  onEsc: Function,\n  'onUpdate:show': [Function, Array],\n  onUpdateShow: [Function, Array],\n  onAfterEnter: Function,\n  onBeforeLeave: Function,\n  onAfterLeave: Function,\n  onClose: Function,\n  onPositiveClick: Function,\n  onNegativeClick: Function,\n  onMaskClick: Function,\n  // private\n  internalDialog: Boolean,\n  internalAppear: {\n    type: Boolean,\n    default: undefined\n  },\n  // deprecated\n  overlayStyle: [String, Object],\n  onBeforeHide: Function,\n  onAfterHide: Function,\n  onHide: Function\n});\nexport default defineComponent({\n  name: 'Modal',\n  inheritAttrs: false,\n  props: modalProps,\n\n  setup(props) {\n    if (process.env.NODE_ENV !== 'production') {\n      if (props.onHide) {\n        warnOnce('modal', '`on-hide` is deprecated.');\n      }\n\n      if (props.onAfterHide) {\n        warnOnce('modal', '`on-after-hide` is deprecated, please use `on-after-leave` instead.');\n      }\n\n      if (props.onBeforeHide) {\n        warnOnce('modal', '`on-before-hide` is deprecated, please use `on-before-leave` instead.');\n      }\n\n      if (props.overlayStyle) {\n        warnOnce('modal', '`overlay-style` is deprecated, please use `style` instead.');\n      }\n    }\n\n    const containerRef = ref(null);\n    const {\n      mergedClsPrefixRef,\n      namespaceRef,\n      inlineThemeDisabled\n    } = useConfig(props);\n    const themeRef = useTheme('Modal', '-modal', style, modalLight, props, mergedClsPrefixRef);\n    const clickedRef = useClicked(64);\n    const clickedPositionRef = useClickPosition();\n    const isMountedRef = useIsMounted();\n    const NDialogProvider = props.internalDialog ? inject(dialogProviderInjectionKey, null) : null;\n\n    function doUpdateShow(show) {\n      const {\n        onUpdateShow,\n        'onUpdate:show': _onUpdateShow,\n        onHide\n      } = props;\n      if (onUpdateShow) call(onUpdateShow, show);\n      if (_onUpdateShow) call(_onUpdateShow, show); // deprecated\n\n      if (onHide && !show) onHide(show);\n    }\n\n    function handleCloseClick() {\n      const {\n        onClose\n      } = props;\n\n      if (onClose) {\n        void Promise.resolve(onClose()).then(value => {\n          if (value === false) return;\n          doUpdateShow(false);\n        });\n      } else {\n        doUpdateShow(false);\n      }\n    }\n\n    function handlePositiveClick() {\n      const {\n        onPositiveClick\n      } = props;\n\n      if (onPositiveClick) {\n        void Promise.resolve(onPositiveClick()).then(value => {\n          if (value === false) return;\n          doUpdateShow(false);\n        });\n      } else {\n        doUpdateShow(false);\n      }\n    }\n\n    function handleNegativeClick() {\n      const {\n        onNegativeClick\n      } = props;\n\n      if (onNegativeClick) {\n        void Promise.resolve(onNegativeClick()).then(value => {\n          if (value === false) return;\n          doUpdateShow(false);\n        });\n      } else {\n        doUpdateShow(false);\n      }\n    }\n\n    function handleBeforeLeave() {\n      const {\n        onBeforeLeave,\n        onBeforeHide\n      } = props;\n      if (onBeforeLeave) call(onBeforeLeave); // deprecated\n\n      if (onBeforeHide) onBeforeHide();\n    }\n\n    function handleAfterLeave() {\n      const {\n        onAfterLeave,\n        onAfterHide\n      } = props;\n      if (onAfterLeave) call(onAfterLeave); // deprecated\n\n      if (onAfterHide) onAfterHide();\n    }\n\n    function handleClickoutside(e) {\n      var _a;\n\n      const {\n        onMaskClick\n      } = props;\n\n      if (onMaskClick) {\n        onMaskClick(e);\n      }\n\n      if (props.maskClosable) {\n        if ((_a = containerRef.value) === null || _a === void 0 ? void 0 : _a.contains(e.target)) {\n          doUpdateShow(false);\n        }\n      }\n    }\n\n    function handleEsc(e) {\n      var _a;\n\n      (_a = props.onEsc) === null || _a === void 0 ? void 0 : _a.call(props);\n\n      if (props.closeOnEsc) {\n        doUpdateShow(false);\n      }\n    }\n\n    provide(modalInjectionKey, {\n      getMousePosition: () => {\n        if (NDialogProvider) {\n          const {\n            clickedRef,\n            clickPositionRef\n          } = NDialogProvider;\n\n          if (clickedRef.value && clickPositionRef.value) {\n            return clickPositionRef.value;\n          }\n        }\n\n        if (clickedRef.value) {\n          return clickedPositionRef.value;\n        }\n\n        return null;\n      },\n      mergedClsPrefixRef,\n      mergedThemeRef: themeRef,\n      isMountedRef,\n      appearRef: toRef(props, 'internalAppear'),\n      transformOriginRef: toRef(props, 'transformOrigin')\n    });\n    const cssVarsRef = computed(() => {\n      const {\n        common: {\n          cubicBezierEaseOut\n        },\n        self: {\n          boxShadow,\n          color,\n          textColor\n        }\n      } = themeRef.value;\n      return {\n        '--n-bezier-ease-out': cubicBezierEaseOut,\n        '--n-box-shadow': boxShadow,\n        '--n-color': color,\n        '--n-text-color': textColor\n      };\n    });\n    const themeClassHandle = inlineThemeDisabled ? useThemeClass('theme-class', undefined, cssVarsRef, props) : undefined;\n    return {\n      mergedClsPrefix: mergedClsPrefixRef,\n      namespace: namespaceRef,\n      isMounted: isMountedRef,\n      containerRef,\n      presetProps: computed(() => {\n        const pickedProps = keep(props, presetPropsKeys); // TODO: remove as any after vue fix the issue introduced in 3.2.27\n\n        return pickedProps;\n      }),\n      handleEsc,\n      handleAfterLeave,\n      handleClickoutside,\n      handleBeforeLeave,\n      doUpdateShow,\n      handleNegativeClick,\n      handlePositiveClick,\n      handleCloseClick,\n      cssVars: inlineThemeDisabled ? undefined : cssVarsRef,\n      themeClass: themeClassHandle === null || themeClassHandle === void 0 ? void 0 : themeClassHandle.themeClass,\n      onRender: themeClassHandle === null || themeClassHandle === void 0 ? void 0 : themeClassHandle.onRender\n    };\n  },\n\n  render() {\n    const {\n      mergedClsPrefix\n    } = this;\n    return h(VLazyTeleport, {\n      to: this.to,\n      show: this.show\n    }, {\n      default: () => {\n        var _a, _b;\n\n        (_a = this.onRender) === null || _a === void 0 ? void 0 : _a.call(this);\n        return withDirectives(h(\"div\", {\n          role: \"none\",\n          ref: \"containerRef\",\n          class: [`${mergedClsPrefix}-modal-container`, this.themeClass, this.namespace],\n          style: this.cssVars\n        }, this.unstableShowMask ? h(Transition, {\n          name: \"fade-in-transition\",\n          key: \"mask\",\n          appear: (_b = this.internalAppear) !== null && _b !== void 0 ? _b : this.isMounted\n        }, {\n          default: () => {\n            return this.show ? h(\"div\", {\n              \"aria-hidden\": true,\n              ref: \"containerRef\",\n              class: `${mergedClsPrefix}-modal-mask`\n            }) : null;\n          }\n        }) : null, h(NModalBodyWrapper, Object.assign({\n          style: this.overlayStyle\n        }, this.$attrs, {\n          ref: \"bodyWrapper\",\n          displayDirective: this.displayDirective,\n          show: this.show,\n          preset: this.preset,\n          autoFocus: this.autoFocus,\n          trapFocus: this.trapFocus\n        }, this.presetProps, {\n          onEsc: this.handleEsc,\n          onClose: this.handleCloseClick,\n          onNegativeClick: this.handleNegativeClick,\n          onPositiveClick: this.handlePositiveClick,\n          onBeforeLeave: this.handleBeforeLeave,\n          onAfterEnter: this.onAfterEnter,\n          onAfterLeave: this.handleAfterLeave,\n          onClickoutside: this.handleClickoutside\n        }), this.$slots)), [[zindexable, {\n          zIndex: this.zIndex,\n          enabled: this.show\n        }]]);\n      }\n    });\n  }\n\n});","map":{"version":3,"sources":["G:/VUE_FDS/fluent-vue/node_modules/naive-ui/es/modal/src/Modal.js"],"names":["h","withDirectives","Transition","ref","computed","defineComponent","provide","toRef","inject","zindexable","useIsMounted","useClicked","useClickPosition","VLazyTeleport","dialogProviderInjectionKey","useConfig","useTheme","useThemeClass","keep","call","warnOnce","modalLight","presetProps","presetPropsKeys","NModalBodyWrapper","modalInjectionKey","style","modalProps","Object","assign","props","show","Boolean","unstableShowMask","type","default","maskClosable","preset","String","to","displayDirective","transformOrigin","zIndex","Number","autoFocus","trapFocus","closeOnEsc","onEsc","Function","Array","onUpdateShow","onAfterEnter","onBeforeLeave","onAfterLeave","onClose","onPositiveClick","onNegativeClick","onMaskClick","internalDialog","internalAppear","undefined","overlayStyle","onBeforeHide","onAfterHide","onHide","name","inheritAttrs","setup","process","env","NODE_ENV","containerRef","mergedClsPrefixRef","namespaceRef","inlineThemeDisabled","themeRef","clickedRef","clickedPositionRef","isMountedRef","NDialogProvider","doUpdateShow","_onUpdateShow","handleCloseClick","Promise","resolve","then","value","handlePositiveClick","handleNegativeClick","handleBeforeLeave","handleAfterLeave","handleClickoutside","e","_a","contains","target","handleEsc","getMousePosition","clickPositionRef","mergedThemeRef","appearRef","transformOriginRef","cssVarsRef","common","cubicBezierEaseOut","self","boxShadow","color","textColor","themeClassHandle","mergedClsPrefix","namespace","isMounted","pickedProps","cssVars","themeClass","onRender","render","_b","role","class","key","appear","$attrs","onClickoutside","$slots","enabled"],"mappings":"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","sourcesContent":["import { h, withDirectives, Transition, ref, computed, defineComponent, provide, toRef, inject } from 'vue';\nimport { zindexable } from 'vdirs';\nimport { useIsMounted, useClicked, useClickPosition } from 'vooks';\nimport { VLazyTeleport } from 'vueuc';\nimport { dialogProviderInjectionKey } from '../../dialog/src/context';\nimport { useConfig, useTheme, useThemeClass } from '../../_mixins';\nimport { keep, call, warnOnce } from '../../_utils';\nimport { modalLight } from '../styles';\nimport { presetProps, presetPropsKeys } from './presetProps';\nimport NModalBodyWrapper from './BodyWrapper';\nimport { modalInjectionKey } from './interface';\nimport style from './styles/index.cssr';\nconst modalProps = Object.assign(Object.assign(Object.assign(Object.assign({}, useTheme.props), { show: Boolean, unstableShowMask: {\n        type: Boolean,\n        default: true\n    }, maskClosable: {\n        type: Boolean,\n        default: true\n    }, preset: String, to: [String, Object], displayDirective: {\n        type: String,\n        default: 'if'\n    }, transformOrigin: {\n        type: String,\n        default: 'mouse'\n    }, zIndex: Number, autoFocus: {\n        type: Boolean,\n        default: true\n    }, trapFocus: {\n        type: Boolean,\n        default: true\n    }, closeOnEsc: {\n        type: Boolean,\n        default: true\n    } }), presetProps), { \n    // events\n    onEsc: Function, 'onUpdate:show': [Function, Array], onUpdateShow: [Function, Array], onAfterEnter: Function, onBeforeLeave: Function, onAfterLeave: Function, onClose: Function, onPositiveClick: Function, onNegativeClick: Function, onMaskClick: Function, \n    // private\n    internalDialog: Boolean, internalAppear: {\n        type: Boolean,\n        default: undefined\n    }, \n    // deprecated\n    overlayStyle: [String, Object], onBeforeHide: Function, onAfterHide: Function, onHide: Function });\nexport default defineComponent({\n    name: 'Modal',\n    inheritAttrs: false,\n    props: modalProps,\n    setup(props) {\n        if (process.env.NODE_ENV !== 'production') {\n            if (props.onHide) {\n                warnOnce('modal', '`on-hide` is deprecated.');\n            }\n            if (props.onAfterHide) {\n                warnOnce('modal', '`on-after-hide` is deprecated, please use `on-after-leave` instead.');\n            }\n            if (props.onBeforeHide) {\n                warnOnce('modal', '`on-before-hide` is deprecated, please use `on-before-leave` instead.');\n            }\n            if (props.overlayStyle) {\n                warnOnce('modal', '`overlay-style` is deprecated, please use `style` instead.');\n            }\n        }\n        const containerRef = ref(null);\n        const { mergedClsPrefixRef, namespaceRef, inlineThemeDisabled } = useConfig(props);\n        const themeRef = useTheme('Modal', '-modal', style, modalLight, props, mergedClsPrefixRef);\n        const clickedRef = useClicked(64);\n        const clickedPositionRef = useClickPosition();\n        const isMountedRef = useIsMounted();\n        const NDialogProvider = props.internalDialog\n            ? inject(dialogProviderInjectionKey, null)\n            : null;\n        function doUpdateShow(show) {\n            const { onUpdateShow, 'onUpdate:show': _onUpdateShow, onHide } = props;\n            if (onUpdateShow)\n                call(onUpdateShow, show);\n            if (_onUpdateShow)\n                call(_onUpdateShow, show);\n            // deprecated\n            if (onHide && !show)\n                onHide(show);\n        }\n        function handleCloseClick() {\n            const { onClose } = props;\n            if (onClose) {\n                void Promise.resolve(onClose()).then((value) => {\n                    if (value === false)\n                        return;\n                    doUpdateShow(false);\n                });\n            }\n            else {\n                doUpdateShow(false);\n            }\n        }\n        function handlePositiveClick() {\n            const { onPositiveClick } = props;\n            if (onPositiveClick) {\n                void Promise.resolve(onPositiveClick()).then((value) => {\n                    if (value === false)\n                        return;\n                    doUpdateShow(false);\n                });\n            }\n            else {\n                doUpdateShow(false);\n            }\n        }\n        function handleNegativeClick() {\n            const { onNegativeClick } = props;\n            if (onNegativeClick) {\n                void Promise.resolve(onNegativeClick()).then((value) => {\n                    if (value === false)\n                        return;\n                    doUpdateShow(false);\n                });\n            }\n            else {\n                doUpdateShow(false);\n            }\n        }\n        function handleBeforeLeave() {\n            const { onBeforeLeave, onBeforeHide } = props;\n            if (onBeforeLeave)\n                call(onBeforeLeave);\n            // deprecated\n            if (onBeforeHide)\n                onBeforeHide();\n        }\n        function handleAfterLeave() {\n            const { onAfterLeave, onAfterHide } = props;\n            if (onAfterLeave)\n                call(onAfterLeave);\n            // deprecated\n            if (onAfterHide)\n                onAfterHide();\n        }\n        function handleClickoutside(e) {\n            var _a;\n            const { onMaskClick } = props;\n            if (onMaskClick) {\n                onMaskClick(e);\n            }\n            if (props.maskClosable) {\n                if ((_a = containerRef.value) === null || _a === void 0 ? void 0 : _a.contains(e.target)) {\n                    doUpdateShow(false);\n                }\n            }\n        }\n        function handleEsc(e) {\n            var _a;\n            (_a = props.onEsc) === null || _a === void 0 ? void 0 : _a.call(props);\n            if (props.closeOnEsc) {\n                doUpdateShow(false);\n            }\n        }\n        provide(modalInjectionKey, {\n            getMousePosition: () => {\n                if (NDialogProvider) {\n                    const { clickedRef, clickPositionRef } = NDialogProvider;\n                    if (clickedRef.value && clickPositionRef.value) {\n                        return clickPositionRef.value;\n                    }\n                }\n                if (clickedRef.value) {\n                    return clickedPositionRef.value;\n                }\n                return null;\n            },\n            mergedClsPrefixRef,\n            mergedThemeRef: themeRef,\n            isMountedRef,\n            appearRef: toRef(props, 'internalAppear'),\n            transformOriginRef: toRef(props, 'transformOrigin')\n        });\n        const cssVarsRef = computed(() => {\n            const { common: { cubicBezierEaseOut }, self: { boxShadow, color, textColor } } = themeRef.value;\n            return {\n                '--n-bezier-ease-out': cubicBezierEaseOut,\n                '--n-box-shadow': boxShadow,\n                '--n-color': color,\n                '--n-text-color': textColor\n            };\n        });\n        const themeClassHandle = inlineThemeDisabled\n            ? useThemeClass('theme-class', undefined, cssVarsRef, props)\n            : undefined;\n        return {\n            mergedClsPrefix: mergedClsPrefixRef,\n            namespace: namespaceRef,\n            isMounted: isMountedRef,\n            containerRef,\n            presetProps: computed(() => {\n                const pickedProps = keep(props, presetPropsKeys);\n                // TODO: remove as any after vue fix the issue introduced in 3.2.27\n                return pickedProps;\n            }),\n            handleEsc,\n            handleAfterLeave,\n            handleClickoutside,\n            handleBeforeLeave,\n            doUpdateShow,\n            handleNegativeClick,\n            handlePositiveClick,\n            handleCloseClick,\n            cssVars: inlineThemeDisabled ? undefined : cssVarsRef,\n            themeClass: themeClassHandle === null || themeClassHandle === void 0 ? void 0 : themeClassHandle.themeClass,\n            onRender: themeClassHandle === null || themeClassHandle === void 0 ? void 0 : themeClassHandle.onRender\n        };\n    },\n    render() {\n        const { mergedClsPrefix } = this;\n        return (h(VLazyTeleport, { to: this.to, show: this.show }, {\n            default: () => {\n                var _a, _b;\n                (_a = this.onRender) === null || _a === void 0 ? void 0 : _a.call(this);\n                return withDirectives(h(\"div\", { role: \"none\", ref: \"containerRef\", class: [\n                        `${mergedClsPrefix}-modal-container`,\n                        this.themeClass,\n                        this.namespace\n                    ], style: this.cssVars },\n                    this.unstableShowMask ? (h(Transition, { name: \"fade-in-transition\", key: \"mask\", appear: (_b = this.internalAppear) !== null && _b !== void 0 ? _b : this.isMounted }, {\n                        default: () => {\n                            return this.show ? (h(\"div\", { \"aria-hidden\": true, ref: \"containerRef\", class: `${mergedClsPrefix}-modal-mask` })) : null;\n                        }\n                    })) : null,\n                    h(NModalBodyWrapper, Object.assign({ style: this.overlayStyle }, this.$attrs, { ref: \"bodyWrapper\", displayDirective: this.displayDirective, show: this.show, preset: this.preset, autoFocus: this.autoFocus, trapFocus: this.trapFocus }, this.presetProps, { onEsc: this.handleEsc, onClose: this.handleCloseClick, onNegativeClick: this.handleNegativeClick, onPositiveClick: this.handlePositiveClick, onBeforeLeave: this.handleBeforeLeave, onAfterEnter: this.onAfterEnter, onAfterLeave: this.handleAfterLeave, onClickoutside: this.handleClickoutside }), this.$slots)), [\n                    [\n                        zindexable,\n                        {\n                            zIndex: this.zIndex,\n                            enabled: this.show\n                        }\n                    ]\n                ]);\n            }\n        }));\n    }\n});\n"]},"metadata":{},"sourceType":"module"}