{"ast":null,"code":"/* eslint-disable @typescript-eslint/no-non-null-assertion */\nimport { h, defineComponent, Fragment, ref, computed, watch, toRef, nextTick, watchEffect, onMounted } from 'vue';\nimport { VOverflow } from 'vueuc';\nimport { NPopover } from '../../../popover';\nimport { NTag } from '../../../tag';\nimport { useThemeClass, useTheme } from '../../../_mixins';\nimport { createKey, getTitleAttribute, render } from '../../../_utils';\nimport Suffix from '../../suffix';\nimport { internalSelectionLight } from '../styles';\nimport style from './styles/index.cssr';\nexport default defineComponent({\n  name: 'InternalSelection',\n  props: Object.assign(Object.assign({}, useTheme.props), {\n    clsPrefix: {\n      type: String,\n      required: true\n    },\n    bordered: {\n      type: Boolean,\n      default: undefined\n    },\n    active: Boolean,\n    pattern: {\n      type: String,\n      default: ''\n    },\n    placeholder: String,\n    selectedOption: {\n      type: Object,\n      default: null\n    },\n    selectedOptions: {\n      type: Array,\n      default: null\n    },\n    multiple: Boolean,\n    filterable: Boolean,\n    clearable: Boolean,\n    disabled: Boolean,\n    size: {\n      type: String,\n      default: 'medium'\n    },\n    loading: Boolean,\n    autofocus: Boolean,\n    showArrow: {\n      type: Boolean,\n      default: true\n    },\n    inputProps: Object,\n    focused: Boolean,\n    renderTag: Function,\n    onKeyup: Function,\n    onKeydown: Function,\n    onClick: Function,\n    onBlur: Function,\n    onFocus: Function,\n    onDeleteOption: Function,\n    maxTagCount: [String, Number],\n    onClear: Function,\n    onPatternInput: Function,\n    onPatternFocus: Function,\n    onPatternBlur: Function,\n    renderLabel: Function,\n    status: String,\n    inlineThemeDisabled: Boolean\n  }),\n\n  setup(props) {\n    const patternInputMirrorRef = ref(null);\n    const patternInputRef = ref(null);\n    const selfRef = ref(null);\n    const multipleElRef = ref(null);\n    const singleElRef = ref(null);\n    const patternInputWrapperRef = ref(null);\n    const counterRef = ref(null);\n    const counterWrapperRef = ref(null);\n    const overflowRef = ref(null);\n    const inputTagElRef = ref(null);\n    const showTagsPopoverRef = ref(false);\n    const patternInputFocusedRef = ref(false);\n    const hoverRef = ref(false);\n    const themeRef = useTheme('InternalSelection', '-internal-selection', style, internalSelectionLight, props, toRef(props, 'clsPrefix'));\n    const mergedClearableRef = computed(() => {\n      return props.clearable && !props.disabled && (hoverRef.value || props.active);\n    });\n    const filterablePlaceholderRef = computed(() => {\n      return props.selectedOption ? props.renderTag ? props.renderTag({\n        option: props.selectedOption,\n        handleClose: () => {}\n      }) : props.renderLabel ? props.renderLabel(props.selectedOption, true) : render(props.selectedOption.label, props.selectedOption, true) : props.placeholder;\n    });\n    const labelRef = computed(() => {\n      const option = props.selectedOption;\n      if (!option) return undefined;\n      return option.label;\n    });\n    const selectedRef = computed(() => {\n      if (props.multiple) {\n        return !!(Array.isArray(props.selectedOptions) && props.selectedOptions.length);\n      } else {\n        return props.selectedOption !== null;\n      }\n    });\n\n    function syncMirrorWidth() {\n      var _a;\n\n      const {\n        value: patternInputMirrorEl\n      } = patternInputMirrorRef;\n\n      if (patternInputMirrorEl) {\n        const {\n          value: patternInputEl\n        } = patternInputRef;\n\n        if (patternInputEl) {\n          patternInputEl.style.width = `${patternInputMirrorEl.offsetWidth}px`;\n\n          if (props.maxTagCount !== 'responsive') {\n            (_a = overflowRef.value) === null || _a === void 0 ? void 0 : _a.sync();\n          }\n        }\n      }\n    }\n\n    function hideInputTag() {\n      const {\n        value: inputTagEl\n      } = inputTagElRef;\n      if (inputTagEl) inputTagEl.style.display = 'none';\n    }\n\n    function showInputTag() {\n      const {\n        value: inputTagEl\n      } = inputTagElRef;\n      if (inputTagEl) inputTagEl.style.display = 'inline-block';\n    }\n\n    watch(toRef(props, 'active'), value => {\n      if (!value) hideInputTag();\n    });\n    watch(toRef(props, 'pattern'), () => {\n      if (props.multiple) {\n        void nextTick(syncMirrorWidth);\n      }\n    });\n\n    function doFocus(e) {\n      const {\n        onFocus\n      } = props;\n      if (onFocus) onFocus(e);\n    }\n\n    function doBlur(e) {\n      const {\n        onBlur\n      } = props;\n      if (onBlur) onBlur(e);\n    }\n\n    function doDeleteOption(value) {\n      const {\n        onDeleteOption\n      } = props;\n      if (onDeleteOption) onDeleteOption(value);\n    }\n\n    function doClear(e) {\n      const {\n        onClear\n      } = props;\n      if (onClear) onClear(e);\n    }\n\n    function doPatternInput(value) {\n      const {\n        onPatternInput\n      } = props;\n      if (onPatternInput) onPatternInput(value);\n    }\n\n    function handleFocusin(e) {\n      var _a;\n\n      if (!e.relatedTarget || !((_a = selfRef.value) === null || _a === void 0 ? void 0 : _a.contains(e.relatedTarget))) {\n        doFocus(e);\n      }\n    }\n\n    function handleFocusout(e) {\n      var _a;\n\n      if ((_a = selfRef.value) === null || _a === void 0 ? void 0 : _a.contains(e.relatedTarget)) return;\n      doBlur(e);\n    }\n\n    function handleClear(e) {\n      doClear(e);\n    }\n\n    function handleMouseEnter() {\n      hoverRef.value = true;\n    }\n\n    function handleMouseLeave() {\n      hoverRef.value = false;\n    }\n\n    function handleMouseDown(e) {\n      if (!props.active || !props.filterable) return;\n      if (e.target === patternInputRef.value) return;\n      e.preventDefault();\n    }\n\n    function handleDeleteOption(option) {\n      doDeleteOption(option);\n    }\n\n    function handlePatternKeyDown(e) {\n      if (e.code === 'Backspace' && !isCompositingRef.value) {\n        if (!props.pattern.length) {\n          const {\n            selectedOptions\n          } = props;\n\n          if (selectedOptions === null || selectedOptions === void 0 ? void 0 : selectedOptions.length) {\n            handleDeleteOption(selectedOptions[selectedOptions.length - 1]);\n          }\n        }\n      }\n    }\n\n    const isCompositingRef = ref(false); // the composition end is later than its input so we can cached the event\n    // and return the input event\n\n    let cachedInputEvent = null;\n\n    function handlePatternInputInput(e) {\n      // we should sync mirror width here\n      const {\n        value: patternInputMirrorEl\n      } = patternInputMirrorRef;\n\n      if (patternInputMirrorEl) {\n        const inputText = e.target.value;\n        patternInputMirrorEl.textContent = inputText;\n        syncMirrorWidth();\n      }\n\n      if (!isCompositingRef.value) {\n        doPatternInput(e);\n      } else {\n        cachedInputEvent = e;\n      }\n    }\n\n    function handleCompositionStart() {\n      isCompositingRef.value = true;\n    }\n\n    function handleCompositionEnd() {\n      isCompositingRef.value = false;\n      doPatternInput(cachedInputEvent);\n      cachedInputEvent = null;\n    }\n\n    function handlePatternInputFocus(e) {\n      var _a;\n\n      patternInputFocusedRef.value = true;\n      (_a = props.onPatternFocus) === null || _a === void 0 ? void 0 : _a.call(props, e);\n    }\n\n    function handlePatternInputBlur(e) {\n      var _a;\n\n      patternInputFocusedRef.value = false;\n      (_a = props.onPatternBlur) === null || _a === void 0 ? void 0 : _a.call(props, e);\n    }\n\n    function blur() {\n      var _a, _b;\n\n      if (props.filterable) {\n        patternInputFocusedRef.value = false;\n        (_a = patternInputWrapperRef.value) === null || _a === void 0 ? void 0 : _a.blur();\n        (_b = patternInputRef.value) === null || _b === void 0 ? void 0 : _b.blur();\n      } else if (props.multiple) {\n        const {\n          value: multipleEl\n        } = multipleElRef;\n        multipleEl === null || multipleEl === void 0 ? void 0 : multipleEl.blur();\n      } else {\n        const {\n          value: singleEl\n        } = singleElRef;\n        singleEl === null || singleEl === void 0 ? void 0 : singleEl.blur();\n      }\n    }\n\n    function focus() {\n      var _a, _b, _c;\n\n      if (props.filterable) {\n        patternInputFocusedRef.value = false;\n        (_a = patternInputWrapperRef.value) === null || _a === void 0 ? void 0 : _a.focus();\n      } else if (props.multiple) {\n        (_b = multipleElRef.value) === null || _b === void 0 ? void 0 : _b.focus();\n      } else {\n        (_c = singleElRef.value) === null || _c === void 0 ? void 0 : _c.focus();\n      }\n    }\n\n    function focusInput() {\n      const {\n        value: patternInputEl\n      } = patternInputRef;\n\n      if (patternInputEl) {\n        showInputTag();\n        patternInputEl.focus();\n      }\n    }\n\n    function blurInput() {\n      const {\n        value: patternInputEl\n      } = patternInputRef;\n\n      if (patternInputEl) {\n        patternInputEl.blur();\n      }\n    }\n\n    function updateCounter(count) {\n      const {\n        value\n      } = counterRef;\n\n      if (value) {\n        value.setTextContent(`+${count}`);\n      }\n    }\n\n    function getCounter() {\n      const {\n        value\n      } = counterWrapperRef;\n      return value;\n    }\n\n    function getTail() {\n      return patternInputRef.value;\n    }\n\n    let enterTimerId = null;\n\n    function clearEnterTimer() {\n      if (enterTimerId !== null) window.clearTimeout(enterTimerId);\n    }\n\n    function handleMouseEnterCounter() {\n      if (props.disabled || props.active) return;\n      clearEnterTimer();\n      enterTimerId = window.setTimeout(() => {\n        showTagsPopoverRef.value = true;\n      }, 100);\n    }\n\n    function handleMouseLeaveCounter() {\n      clearEnterTimer();\n    }\n\n    function onPopoverUpdateShow(show) {\n      if (!show) {\n        clearEnterTimer();\n        showTagsPopoverRef.value = false;\n      }\n    }\n\n    onMounted(() => {\n      watchEffect(() => {\n        const patternInputWrapperEl = patternInputWrapperRef.value;\n        if (!patternInputWrapperEl) return;\n        patternInputWrapperEl.tabIndex = props.disabled || patternInputFocusedRef.value ? -1 : 0;\n      });\n    });\n    const {\n      inlineThemeDisabled\n    } = props;\n    const cssVarsRef = computed(() => {\n      const {\n        size\n      } = props;\n      const {\n        common: {\n          cubicBezierEaseInOut\n        },\n        self: {\n          borderRadius,\n          color,\n          placeholderColor,\n          textColor,\n          paddingSingle,\n          paddingMultiple,\n          caretColor,\n          colorDisabled,\n          textColorDisabled,\n          placeholderColorDisabled,\n          colorActive,\n          boxShadowFocus,\n          boxShadowActive,\n          boxShadowHover,\n          border,\n          borderFocus,\n          borderHover,\n          borderActive,\n          arrowColor,\n          arrowColorDisabled,\n          loadingColor,\n          // form warning\n          colorActiveWarning,\n          boxShadowFocusWarning,\n          boxShadowActiveWarning,\n          boxShadowHoverWarning,\n          borderWarning,\n          borderFocusWarning,\n          borderHoverWarning,\n          borderActiveWarning,\n          // form error\n          colorActiveError,\n          boxShadowFocusError,\n          boxShadowActiveError,\n          boxShadowHoverError,\n          borderError,\n          borderFocusError,\n          borderHoverError,\n          borderActiveError,\n          // clear\n          clearColor,\n          clearColorHover,\n          clearColorPressed,\n          clearSize,\n          // arrow\n          arrowSize,\n          [createKey('height', size)]: height,\n          [createKey('fontSize', size)]: fontSize\n        }\n      } = themeRef.value;\n      return {\n        '--n-bezier': cubicBezierEaseInOut,\n        '--n-border': border,\n        '--n-border-active': borderActive,\n        '--n-border-focus': borderFocus,\n        '--n-border-hover': borderHover,\n        '--n-border-radius': borderRadius,\n        '--n-box-shadow-active': boxShadowActive,\n        '--n-box-shadow-focus': boxShadowFocus,\n        '--n-box-shadow-hover': boxShadowHover,\n        '--n-caret-color': caretColor,\n        '--n-color': color,\n        '--n-color-active': colorActive,\n        '--n-color-disabled': colorDisabled,\n        '--n-font-size': fontSize,\n        '--n-height': height,\n        '--n-padding-single': paddingSingle,\n        '--n-padding-multiple': paddingMultiple,\n        '--n-placeholder-color': placeholderColor,\n        '--n-placeholder-color-disabled': placeholderColorDisabled,\n        '--n-text-color': textColor,\n        '--n-text-color-disabled': textColorDisabled,\n        '--n-arrow-color': arrowColor,\n        '--n-arrow-color-disabled': arrowColorDisabled,\n        '--n-loading-color': loadingColor,\n        // form warning\n        '--n-color-active-warning': colorActiveWarning,\n        '--n-box-shadow-focus-warning': boxShadowFocusWarning,\n        '--n-box-shadow-active-warning': boxShadowActiveWarning,\n        '--n-box-shadow-hover-warning': boxShadowHoverWarning,\n        '--n-border-warning': borderWarning,\n        '--n-border-focus-warning': borderFocusWarning,\n        '--n-border-hover-warning': borderHoverWarning,\n        '--n-border-active-warning': borderActiveWarning,\n        // form error\n        '--n-color-active-error': colorActiveError,\n        '--n-box-shadow-focus-error': boxShadowFocusError,\n        '--n-box-shadow-active-error': boxShadowActiveError,\n        '--n-box-shadow-hover-error': boxShadowHoverError,\n        '--n-border-error': borderError,\n        '--n-border-focus-error': borderFocusError,\n        '--n-border-hover-error': borderHoverError,\n        '--n-border-active-error': borderActiveError,\n        // clear\n        '--n-clear-size': clearSize,\n        '--n-clear-color': clearColor,\n        '--n-clear-color-hover': clearColorHover,\n        '--n-clear-color-pressed': clearColorPressed,\n        // arrow-size\n        '--n-arrow-size': arrowSize\n      };\n    });\n    const themeClassHandle = inlineThemeDisabled ? useThemeClass('internal-selection', computed(() => {\n      return props.size[0];\n    }), cssVarsRef, props) : undefined;\n    return {\n      mergedTheme: themeRef,\n      mergedClearable: mergedClearableRef,\n      patternInputFocused: patternInputFocusedRef,\n      filterablePlaceholder: filterablePlaceholderRef,\n      label: labelRef,\n      selected: selectedRef,\n      showTagsPanel: showTagsPopoverRef,\n      isCompositing: isCompositingRef,\n      // dom ref\n      counterRef,\n      counterWrapperRef,\n      patternInputMirrorRef,\n      patternInputRef,\n      selfRef,\n      multipleElRef,\n      singleElRef,\n      patternInputWrapperRef,\n      overflowRef,\n      inputTagElRef,\n      handleMouseDown,\n      handleFocusin,\n      handleClear,\n      handleMouseEnter,\n      handleMouseLeave,\n      handleDeleteOption,\n      handlePatternKeyDown,\n      handlePatternInputInput,\n      handlePatternInputBlur,\n      handlePatternInputFocus,\n      handleMouseEnterCounter,\n      handleMouseLeaveCounter,\n      handleFocusout,\n      handleCompositionEnd,\n      handleCompositionStart,\n      onPopoverUpdateShow,\n      focus,\n      focusInput,\n      blur,\n      blurInput,\n      updateCounter,\n      getCounter,\n      getTail,\n      renderLabel: props.renderLabel,\n      cssVars: inlineThemeDisabled ? undefined : cssVarsRef,\n      themeClass: themeClassHandle === null || themeClassHandle === void 0 ? void 0 : themeClassHandle.themeClass,\n      onRender: themeClassHandle === null || themeClassHandle === void 0 ? void 0 : themeClassHandle.onRender\n    };\n  },\n\n  render() {\n    const {\n      status,\n      multiple,\n      size,\n      disabled,\n      filterable,\n      maxTagCount,\n      bordered,\n      clsPrefix,\n      onRender,\n      renderTag,\n      renderLabel\n    } = this;\n    onRender === null || onRender === void 0 ? void 0 : onRender();\n    const maxTagCountResponsive = maxTagCount === 'responsive';\n    const maxTagCountNumeric = typeof maxTagCount === 'number';\n    const useMaxTagCount = maxTagCountResponsive || maxTagCountNumeric;\n    const suffix = h(Suffix, {\n      clsPrefix: clsPrefix,\n      loading: this.loading,\n      showArrow: this.showArrow,\n      showClear: this.mergedClearable && this.selected,\n      onClear: this.handleClear\n    }, {\n      default: () => {\n        var _a, _b;\n\n        return (_b = (_a = this.$slots).arrow) === null || _b === void 0 ? void 0 : _b.call(_a);\n      }\n    });\n    let body;\n\n    if (multiple) {\n      const createTag = option => h(\"div\", {\n        class: `${clsPrefix}-base-selection-tag-wrapper`,\n        key: option.value\n      }, renderTag ? renderTag({\n        option,\n        handleClose: () => this.handleDeleteOption(option)\n      }) : h(NTag, {\n        size: size,\n        closable: !option.disabled,\n        disabled: disabled,\n        internalStopClickPropagation: true,\n        onClose: () => this.handleDeleteOption(option)\n      }, {\n        default: () => renderLabel ? renderLabel(option, true) : render(option.label, option, true)\n      }));\n\n      const originalTags = (maxTagCountNumeric ? this.selectedOptions.slice(0, maxTagCount) : this.selectedOptions).map(createTag);\n      const input = filterable ? h(\"div\", {\n        class: `${clsPrefix}-base-selection-input-tag`,\n        ref: \"inputTagElRef\",\n        key: \"__input-tag__\"\n      }, h(\"input\", Object.assign({}, this.inputProps, {\n        ref: \"patternInputRef\",\n        tabindex: -1,\n        disabled: disabled,\n        value: this.pattern,\n        autofocus: this.autofocus,\n        class: `${clsPrefix}-base-selection-input-tag__input`,\n        onBlur: this.handlePatternInputBlur,\n        onFocus: this.handlePatternInputFocus,\n        onKeydown: this.handlePatternKeyDown,\n        onInput: this.handlePatternInputInput,\n        onCompositionstart: this.handleCompositionStart,\n        onCompositionend: this.handleCompositionEnd\n      })), h(\"span\", {\n        ref: \"patternInputMirrorRef\",\n        class: `${clsPrefix}-base-selection-input-tag__mirror`\n      }, this.pattern)) : null; // May Overflow\n\n      const renderCounter = maxTagCountResponsive ? () => h(\"div\", {\n        class: `${clsPrefix}-base-selection-tag-wrapper`,\n        ref: \"counterWrapperRef\"\n      }, h(NTag, {\n        size: size,\n        ref: \"counterRef\",\n        onMouseenter: this.handleMouseEnterCounter,\n        onMouseleave: this.handleMouseLeaveCounter,\n        disabled: disabled\n      })) : undefined;\n      let counter;\n\n      if (maxTagCountNumeric) {\n        const rest = this.selectedOptions.length - maxTagCount;\n\n        if (rest > 0) {\n          counter = h(\"div\", {\n            class: `${clsPrefix}-base-selection-tag-wrapper`,\n            key: \"__counter__\"\n          }, h(NTag, {\n            size: size,\n            ref: \"counterRef\",\n            onMouseenter: this.handleMouseEnterCounter,\n            disabled: disabled\n          }, {\n            default: () => `+${rest}`\n          }));\n        }\n      }\n\n      const tags = maxTagCountResponsive ? filterable ? h(VOverflow, {\n        ref: \"overflowRef\",\n        updateCounter: this.updateCounter,\n        getCounter: this.getCounter,\n        getTail: this.getTail,\n        style: {\n          width: '100%',\n          display: 'flex',\n          overflow: 'hidden'\n        }\n      }, {\n        default: () => originalTags,\n        counter: renderCounter,\n        tail: () => input\n      }) : h(VOverflow, {\n        ref: \"overflowRef\",\n        updateCounter: this.updateCounter,\n        getCounter: this.getCounter,\n        style: {\n          width: '100%',\n          display: 'flex',\n          overflow: 'hidden'\n        }\n      }, {\n        default: () => originalTags,\n        counter: renderCounter\n      }) : maxTagCountNumeric ? originalTags.concat(counter) : originalTags;\n      const renderPopover = useMaxTagCount ? () => h(\"div\", {\n        class: `${clsPrefix}-base-selection-popover`\n      }, maxTagCountResponsive ? originalTags : this.selectedOptions.map(createTag)) : undefined;\n      const popoverProps = useMaxTagCount ? {\n        show: this.showTagsPanel,\n        trigger: 'hover',\n        overlap: true,\n        placement: 'top',\n        width: 'trigger',\n        onUpdateShow: this.onPopoverUpdateShow,\n        theme: this.mergedTheme.peers.Popover,\n        themeOverrides: this.mergedTheme.peerOverrides.Popover\n      } : null;\n      const showPlaceholder = this.selected ? false : this.active ? !this.pattern && !this.isCompositing : true;\n      const placeholder = showPlaceholder ? h(\"div\", {\n        class: `${clsPrefix}-base-selection-placeholder ${clsPrefix}-base-selection-overlay`\n      }, this.placeholder) : null;\n\n      if (filterable) {\n        const popoverTrigger = h(\"div\", {\n          ref: \"patternInputWrapperRef\",\n          class: `${clsPrefix}-base-selection-tags`\n        }, tags, maxTagCountResponsive ? null : input, suffix);\n        body = h(Fragment, null, useMaxTagCount ? h(NPopover, Object.assign({}, popoverProps), {\n          trigger: () => popoverTrigger,\n          default: renderPopover\n        }) : popoverTrigger, placeholder);\n      } else {\n        const popoverTrigger = h(\"div\", {\n          ref: \"multipleElRef\",\n          class: `${clsPrefix}-base-selection-tags`,\n          tabindex: disabled ? undefined : 0\n        }, tags, suffix);\n        body = h(Fragment, null, useMaxTagCount ? h(NPopover, Object.assign({}, popoverProps), {\n          trigger: () => popoverTrigger,\n          default: renderPopover\n        }) : popoverTrigger, placeholder);\n      }\n    } else {\n      if (filterable) {\n        const hasInput = this.pattern || this.isCompositing;\n        const showPlaceholder = this.active ? !hasInput : !this.selected;\n        const showSelectedLabel = this.active ? false : this.selected;\n        body = h(\"div\", {\n          ref: \"patternInputWrapperRef\",\n          class: `${clsPrefix}-base-selection-label`\n        }, h(\"input\", Object.assign({}, this.inputProps, {\n          ref: \"patternInputRef\",\n          class: `${clsPrefix}-base-selection-input`,\n          value: this.active ? this.pattern : '',\n          placeholder: \"\",\n          readonly: disabled,\n          disabled: disabled,\n          tabindex: -1,\n          autofocus: this.autofocus,\n          onFocus: this.handlePatternInputFocus,\n          onBlur: this.handlePatternInputBlur,\n          onInput: this.handlePatternInputInput,\n          onCompositionstart: this.handleCompositionStart,\n          onCompositionend: this.handleCompositionEnd\n        })), showSelectedLabel ? h(\"div\", {\n          class: `${clsPrefix}-base-selection-label__render-label ${clsPrefix}-base-selection-overlay`,\n          key: \"input\"\n        }, h(\"div\", {\n          class: `${clsPrefix}-base-selection-overlay__wrapper`\n        }, renderTag ? renderTag({\n          option: this.selectedOption,\n          handleClose: () => {}\n        }) : renderLabel ? renderLabel(this.selectedOption, true) : render(this.label, this.selectedOption, true))) : null, showPlaceholder ? h(\"div\", {\n          class: `${clsPrefix}-base-selection-placeholder ${clsPrefix}-base-selection-overlay`,\n          key: \"placeholder\"\n        }, h(\"div\", {\n          class: `${clsPrefix}-base-selection-overlay__wrapper`\n        }, this.filterablePlaceholder)) : null, suffix);\n      } else {\n        body = h(\"div\", {\n          ref: \"singleElRef\",\n          class: `${clsPrefix}-base-selection-label`,\n          tabindex: this.disabled ? undefined : 0\n        }, this.label !== undefined ? h(\"div\", {\n          class: `${clsPrefix}-base-selection-input`,\n          title: getTitleAttribute(this.label),\n          key: \"input\"\n        }, h(\"div\", {\n          class: `${clsPrefix}-base-selection-input__content`\n        }, renderTag ? renderTag({\n          option: this.selectedOption,\n          handleClose: () => {}\n        }) : renderLabel ? renderLabel(this.selectedOption, true) : render(this.label, this.selectedOption, true))) : h(\"div\", {\n          class: `${clsPrefix}-base-selection-placeholder ${clsPrefix}-base-selection-overlay`,\n          key: \"placeholder\"\n        }, this.placeholder), suffix);\n      }\n    }\n\n    return h(\"div\", {\n      ref: \"selfRef\",\n      class: [`${clsPrefix}-base-selection`, this.themeClass, status && `${clsPrefix}-base-selection--${status}-status`, {\n        [`${clsPrefix}-base-selection--active`]: this.active,\n        [`${clsPrefix}-base-selection--selected`]: this.selected || this.active && this.pattern,\n        [`${clsPrefix}-base-selection--disabled`]: this.disabled,\n        [`${clsPrefix}-base-selection--multiple`]: this.multiple,\n        // focus is not controlled by selection itself since it always need\n        // to be managed together with menu. provide :focus style will cause\n        // many redundant codes.\n        [`${clsPrefix}-base-selection--focus`]: this.focused\n      }],\n      style: this.cssVars,\n      onClick: this.onClick,\n      onMouseenter: this.handleMouseEnter,\n      onMouseleave: this.handleMouseLeave,\n      onKeyup: this.onKeyup,\n      onKeydown: this.onKeydown,\n      onFocusin: this.handleFocusin,\n      onFocusout: this.handleFocusout,\n      onMousedown: this.handleMouseDown\n    }, body, bordered ? h(\"div\", {\n      class: `${clsPrefix}-base-selection__border`\n    }) : null, bordered ? h(\"div\", {\n      class: `${clsPrefix}-base-selection__state-border`\n    }) : null);\n  }\n\n});","map":{"version":3,"sources":["G:/VUE_FDS/fluent-vue/node_modules/naive-ui/es/_internal/selection/src/Selection.js"],"names":["h","defineComponent","Fragment","ref","computed","watch","toRef","nextTick","watchEffect","onMounted","VOverflow","NPopover","NTag","useThemeClass","useTheme","createKey","getTitleAttribute","render","Suffix","internalSelectionLight","style","name","props","Object","assign","clsPrefix","type","String","required","bordered","Boolean","default","undefined","active","pattern","placeholder","selectedOption","selectedOptions","Array","multiple","filterable","clearable","disabled","size","loading","autofocus","showArrow","inputProps","focused","renderTag","Function","onKeyup","onKeydown","onClick","onBlur","onFocus","onDeleteOption","maxTagCount","Number","onClear","onPatternInput","onPatternFocus","onPatternBlur","renderLabel","status","inlineThemeDisabled","setup","patternInputMirrorRef","patternInputRef","selfRef","multipleElRef","singleElRef","patternInputWrapperRef","counterRef","counterWrapperRef","overflowRef","inputTagElRef","showTagsPopoverRef","patternInputFocusedRef","hoverRef","themeRef","mergedClearableRef","value","filterablePlaceholderRef","option","handleClose","label","labelRef","selectedRef","isArray","length","syncMirrorWidth","_a","patternInputMirrorEl","patternInputEl","width","offsetWidth","sync","hideInputTag","inputTagEl","display","showInputTag","doFocus","e","doBlur","doDeleteOption","doClear","doPatternInput","handleFocusin","relatedTarget","contains","handleFocusout","handleClear","handleMouseEnter","handleMouseLeave","handleMouseDown","target","preventDefault","handleDeleteOption","handlePatternKeyDown","code","isCompositingRef","cachedInputEvent","handlePatternInputInput","inputText","textContent","handleCompositionStart","handleCompositionEnd","handlePatternInputFocus","call","handlePatternInputBlur","blur","_b","multipleEl","singleEl","focus","_c","focusInput","blurInput","updateCounter","count","setTextContent","getCounter","getTail","enterTimerId","clearEnterTimer","window","clearTimeout","handleMouseEnterCounter","setTimeout","handleMouseLeaveCounter","onPopoverUpdateShow","show","patternInputWrapperEl","tabIndex","cssVarsRef","common","cubicBezierEaseInOut","self","borderRadius","color","placeholderColor","textColor","paddingSingle","paddingMultiple","caretColor","colorDisabled","textColorDisabled","placeholderColorDisabled","colorActive","boxShadowFocus","boxShadowActive","boxShadowHover","border","borderFocus","borderHover","borderActive","arrowColor","arrowColorDisabled","loadingColor","colorActiveWarning","boxShadowFocusWarning","boxShadowActiveWarning","boxShadowHoverWarning","borderWarning","borderFocusWarning","borderHoverWarning","borderActiveWarning","colorActiveError","boxShadowFocusError","boxShadowActiveError","boxShadowHoverError","borderError","borderFocusError","borderHoverError","borderActiveError","clearColor","clearColorHover","clearColorPressed","clearSize","arrowSize","height","fontSize","themeClassHandle","mergedTheme","mergedClearable","patternInputFocused","filterablePlaceholder","selected","showTagsPanel","isCompositing","cssVars","themeClass","onRender","maxTagCountResponsive","maxTagCountNumeric","useMaxTagCount","suffix","showClear","$slots","arrow","body","createTag","class","key","closable","internalStopClickPropagation","onClose","originalTags","slice","map","input","tabindex","onInput","onCompositionstart","onCompositionend","renderCounter","onMouseenter","onMouseleave","counter","rest","tags","overflow","tail","concat","renderPopover","popoverProps","trigger","overlap","placement","onUpdateShow","theme","peers","Popover","themeOverrides","peerOverrides","showPlaceholder","popoverTrigger","hasInput","showSelectedLabel","readonly","title","onFocusin","onFocusout","onMousedown"],"mappings":"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","sourcesContent":["/* eslint-disable @typescript-eslint/no-non-null-assertion */\nimport { h, defineComponent, Fragment, ref, computed, watch, toRef, nextTick, watchEffect, onMounted } from 'vue';\nimport { VOverflow } from 'vueuc';\nimport { NPopover } from '../../../popover';\nimport { NTag } from '../../../tag';\nimport { useThemeClass, useTheme } from '../../../_mixins';\nimport { createKey, getTitleAttribute, render } from '../../../_utils';\nimport Suffix from '../../suffix';\nimport { internalSelectionLight } from '../styles';\nimport style from './styles/index.cssr';\nexport default defineComponent({\n    name: 'InternalSelection',\n    props: Object.assign(Object.assign({}, useTheme.props), { clsPrefix: {\n            type: String,\n            required: true\n        }, bordered: {\n            type: Boolean,\n            default: undefined\n        }, active: Boolean, pattern: {\n            type: String,\n            default: ''\n        }, placeholder: String, selectedOption: {\n            type: Object,\n            default: null\n        }, selectedOptions: {\n            type: Array,\n            default: null\n        }, multiple: Boolean, filterable: Boolean, clearable: Boolean, disabled: Boolean, size: {\n            type: String,\n            default: 'medium'\n        }, loading: Boolean, autofocus: Boolean, showArrow: {\n            type: Boolean,\n            default: true\n        }, inputProps: Object, focused: Boolean, renderTag: Function, onKeyup: Function, onKeydown: Function, onClick: Function, onBlur: Function, onFocus: Function, onDeleteOption: Function, maxTagCount: [String, Number], onClear: Function, onPatternInput: Function, onPatternFocus: Function, onPatternBlur: Function, renderLabel: Function, status: String, inlineThemeDisabled: Boolean }),\n    setup(props) {\n        const patternInputMirrorRef = ref(null);\n        const patternInputRef = ref(null);\n        const selfRef = ref(null);\n        const multipleElRef = ref(null);\n        const singleElRef = ref(null);\n        const patternInputWrapperRef = ref(null);\n        const counterRef = ref(null);\n        const counterWrapperRef = ref(null);\n        const overflowRef = ref(null);\n        const inputTagElRef = ref(null);\n        const showTagsPopoverRef = ref(false);\n        const patternInputFocusedRef = ref(false);\n        const hoverRef = ref(false);\n        const themeRef = useTheme('InternalSelection', '-internal-selection', style, internalSelectionLight, props, toRef(props, 'clsPrefix'));\n        const mergedClearableRef = computed(() => {\n            return (props.clearable && !props.disabled && (hoverRef.value || props.active));\n        });\n        const filterablePlaceholderRef = computed(() => {\n            return props.selectedOption\n                ? props.renderTag\n                    ? props.renderTag({\n                        option: props.selectedOption,\n                        handleClose: () => { }\n                    })\n                    : props.renderLabel\n                        ? props.renderLabel(props.selectedOption, true)\n                        : render(props.selectedOption.label, props.selectedOption, true)\n                : props.placeholder;\n        });\n        const labelRef = computed(() => {\n            const option = props.selectedOption;\n            if (!option)\n                return undefined;\n            return option.label;\n        });\n        const selectedRef = computed(() => {\n            if (props.multiple) {\n                return !!(Array.isArray(props.selectedOptions) && props.selectedOptions.length);\n            }\n            else {\n                return props.selectedOption !== null;\n            }\n        });\n        function syncMirrorWidth() {\n            var _a;\n            const { value: patternInputMirrorEl } = patternInputMirrorRef;\n            if (patternInputMirrorEl) {\n                const { value: patternInputEl } = patternInputRef;\n                if (patternInputEl) {\n                    patternInputEl.style.width = `${patternInputMirrorEl.offsetWidth}px`;\n                    if (props.maxTagCount !== 'responsive') {\n                        (_a = overflowRef.value) === null || _a === void 0 ? void 0 : _a.sync();\n                    }\n                }\n            }\n        }\n        function hideInputTag() {\n            const { value: inputTagEl } = inputTagElRef;\n            if (inputTagEl)\n                inputTagEl.style.display = 'none';\n        }\n        function showInputTag() {\n            const { value: inputTagEl } = inputTagElRef;\n            if (inputTagEl)\n                inputTagEl.style.display = 'inline-block';\n        }\n        watch(toRef(props, 'active'), (value) => {\n            if (!value)\n                hideInputTag();\n        });\n        watch(toRef(props, 'pattern'), () => {\n            if (props.multiple) {\n                void nextTick(syncMirrorWidth);\n            }\n        });\n        function doFocus(e) {\n            const { onFocus } = props;\n            if (onFocus)\n                onFocus(e);\n        }\n        function doBlur(e) {\n            const { onBlur } = props;\n            if (onBlur)\n                onBlur(e);\n        }\n        function doDeleteOption(value) {\n            const { onDeleteOption } = props;\n            if (onDeleteOption)\n                onDeleteOption(value);\n        }\n        function doClear(e) {\n            const { onClear } = props;\n            if (onClear)\n                onClear(e);\n        }\n        function doPatternInput(value) {\n            const { onPatternInput } = props;\n            if (onPatternInput)\n                onPatternInput(value);\n        }\n        function handleFocusin(e) {\n            var _a;\n            if (!e.relatedTarget ||\n                !((_a = selfRef.value) === null || _a === void 0 ? void 0 : _a.contains(e.relatedTarget))) {\n                doFocus(e);\n            }\n        }\n        function handleFocusout(e) {\n            var _a;\n            if ((_a = selfRef.value) === null || _a === void 0 ? void 0 : _a.contains(e.relatedTarget))\n                return;\n            doBlur(e);\n        }\n        function handleClear(e) {\n            doClear(e);\n        }\n        function handleMouseEnter() {\n            hoverRef.value = true;\n        }\n        function handleMouseLeave() {\n            hoverRef.value = false;\n        }\n        function handleMouseDown(e) {\n            if (!props.active || !props.filterable)\n                return;\n            if (e.target === patternInputRef.value)\n                return;\n            e.preventDefault();\n        }\n        function handleDeleteOption(option) {\n            doDeleteOption(option);\n        }\n        function handlePatternKeyDown(e) {\n            if (e.code === 'Backspace' && !isCompositingRef.value) {\n                if (!props.pattern.length) {\n                    const { selectedOptions } = props;\n                    if (selectedOptions === null || selectedOptions === void 0 ? void 0 : selectedOptions.length) {\n                        handleDeleteOption(selectedOptions[selectedOptions.length - 1]);\n                    }\n                }\n            }\n        }\n        const isCompositingRef = ref(false);\n        // the composition end is later than its input so we can cached the event\n        // and return the input event\n        let cachedInputEvent = null;\n        function handlePatternInputInput(e) {\n            // we should sync mirror width here\n            const { value: patternInputMirrorEl } = patternInputMirrorRef;\n            if (patternInputMirrorEl) {\n                const inputText = e.target.value;\n                patternInputMirrorEl.textContent = inputText;\n                syncMirrorWidth();\n            }\n            if (!isCompositingRef.value) {\n                doPatternInput(e);\n            }\n            else {\n                cachedInputEvent = e;\n            }\n        }\n        function handleCompositionStart() {\n            isCompositingRef.value = true;\n        }\n        function handleCompositionEnd() {\n            isCompositingRef.value = false;\n            doPatternInput(cachedInputEvent);\n            cachedInputEvent = null;\n        }\n        function handlePatternInputFocus(e) {\n            var _a;\n            patternInputFocusedRef.value = true;\n            (_a = props.onPatternFocus) === null || _a === void 0 ? void 0 : _a.call(props, e);\n        }\n        function handlePatternInputBlur(e) {\n            var _a;\n            patternInputFocusedRef.value = false;\n            (_a = props.onPatternBlur) === null || _a === void 0 ? void 0 : _a.call(props, e);\n        }\n        function blur() {\n            var _a, _b;\n            if (props.filterable) {\n                patternInputFocusedRef.value = false;\n                (_a = patternInputWrapperRef.value) === null || _a === void 0 ? void 0 : _a.blur();\n                (_b = patternInputRef.value) === null || _b === void 0 ? void 0 : _b.blur();\n            }\n            else if (props.multiple) {\n                const { value: multipleEl } = multipleElRef;\n                multipleEl === null || multipleEl === void 0 ? void 0 : multipleEl.blur();\n            }\n            else {\n                const { value: singleEl } = singleElRef;\n                singleEl === null || singleEl === void 0 ? void 0 : singleEl.blur();\n            }\n        }\n        function focus() {\n            var _a, _b, _c;\n            if (props.filterable) {\n                patternInputFocusedRef.value = false;\n                (_a = patternInputWrapperRef.value) === null || _a === void 0 ? void 0 : _a.focus();\n            }\n            else if (props.multiple) {\n                (_b = multipleElRef.value) === null || _b === void 0 ? void 0 : _b.focus();\n            }\n            else {\n                (_c = singleElRef.value) === null || _c === void 0 ? void 0 : _c.focus();\n            }\n        }\n        function focusInput() {\n            const { value: patternInputEl } = patternInputRef;\n            if (patternInputEl) {\n                showInputTag();\n                patternInputEl.focus();\n            }\n        }\n        function blurInput() {\n            const { value: patternInputEl } = patternInputRef;\n            if (patternInputEl) {\n                patternInputEl.blur();\n            }\n        }\n        function updateCounter(count) {\n            const { value } = counterRef;\n            if (value) {\n                value.setTextContent(`+${count}`);\n            }\n        }\n        function getCounter() {\n            const { value } = counterWrapperRef;\n            return value;\n        }\n        function getTail() {\n            return patternInputRef.value;\n        }\n        let enterTimerId = null;\n        function clearEnterTimer() {\n            if (enterTimerId !== null)\n                window.clearTimeout(enterTimerId);\n        }\n        function handleMouseEnterCounter() {\n            if (props.disabled || props.active)\n                return;\n            clearEnterTimer();\n            enterTimerId = window.setTimeout(() => {\n                showTagsPopoverRef.value = true;\n            }, 100);\n        }\n        function handleMouseLeaveCounter() {\n            clearEnterTimer();\n        }\n        function onPopoverUpdateShow(show) {\n            if (!show) {\n                clearEnterTimer();\n                showTagsPopoverRef.value = false;\n            }\n        }\n        onMounted(() => {\n            watchEffect(() => {\n                const patternInputWrapperEl = patternInputWrapperRef.value;\n                if (!patternInputWrapperEl)\n                    return;\n                patternInputWrapperEl.tabIndex =\n                    props.disabled || patternInputFocusedRef.value ? -1 : 0;\n            });\n        });\n        const { inlineThemeDisabled } = props;\n        const cssVarsRef = computed(() => {\n            const { size } = props;\n            const { common: { cubicBezierEaseInOut }, self: { borderRadius, color, placeholderColor, textColor, paddingSingle, paddingMultiple, caretColor, colorDisabled, textColorDisabled, placeholderColorDisabled, colorActive, boxShadowFocus, boxShadowActive, boxShadowHover, border, borderFocus, borderHover, borderActive, arrowColor, arrowColorDisabled, loadingColor, \n            // form warning\n            colorActiveWarning, boxShadowFocusWarning, boxShadowActiveWarning, boxShadowHoverWarning, borderWarning, borderFocusWarning, borderHoverWarning, borderActiveWarning, \n            // form error\n            colorActiveError, boxShadowFocusError, boxShadowActiveError, boxShadowHoverError, borderError, borderFocusError, borderHoverError, borderActiveError, \n            // clear\n            clearColor, clearColorHover, clearColorPressed, clearSize, \n            // arrow\n            arrowSize, [createKey('height', size)]: height, [createKey('fontSize', size)]: fontSize } } = themeRef.value;\n            return {\n                '--n-bezier': cubicBezierEaseInOut,\n                '--n-border': border,\n                '--n-border-active': borderActive,\n                '--n-border-focus': borderFocus,\n                '--n-border-hover': borderHover,\n                '--n-border-radius': borderRadius,\n                '--n-box-shadow-active': boxShadowActive,\n                '--n-box-shadow-focus': boxShadowFocus,\n                '--n-box-shadow-hover': boxShadowHover,\n                '--n-caret-color': caretColor,\n                '--n-color': color,\n                '--n-color-active': colorActive,\n                '--n-color-disabled': colorDisabled,\n                '--n-font-size': fontSize,\n                '--n-height': height,\n                '--n-padding-single': paddingSingle,\n                '--n-padding-multiple': paddingMultiple,\n                '--n-placeholder-color': placeholderColor,\n                '--n-placeholder-color-disabled': placeholderColorDisabled,\n                '--n-text-color': textColor,\n                '--n-text-color-disabled': textColorDisabled,\n                '--n-arrow-color': arrowColor,\n                '--n-arrow-color-disabled': arrowColorDisabled,\n                '--n-loading-color': loadingColor,\n                // form warning\n                '--n-color-active-warning': colorActiveWarning,\n                '--n-box-shadow-focus-warning': boxShadowFocusWarning,\n                '--n-box-shadow-active-warning': boxShadowActiveWarning,\n                '--n-box-shadow-hover-warning': boxShadowHoverWarning,\n                '--n-border-warning': borderWarning,\n                '--n-border-focus-warning': borderFocusWarning,\n                '--n-border-hover-warning': borderHoverWarning,\n                '--n-border-active-warning': borderActiveWarning,\n                // form error\n                '--n-color-active-error': colorActiveError,\n                '--n-box-shadow-focus-error': boxShadowFocusError,\n                '--n-box-shadow-active-error': boxShadowActiveError,\n                '--n-box-shadow-hover-error': boxShadowHoverError,\n                '--n-border-error': borderError,\n                '--n-border-focus-error': borderFocusError,\n                '--n-border-hover-error': borderHoverError,\n                '--n-border-active-error': borderActiveError,\n                // clear\n                '--n-clear-size': clearSize,\n                '--n-clear-color': clearColor,\n                '--n-clear-color-hover': clearColorHover,\n                '--n-clear-color-pressed': clearColorPressed,\n                // arrow-size\n                '--n-arrow-size': arrowSize\n            };\n        });\n        const themeClassHandle = inlineThemeDisabled\n            ? useThemeClass('internal-selection', computed(() => {\n                return props.size[0];\n            }), cssVarsRef, props)\n            : undefined;\n        return {\n            mergedTheme: themeRef,\n            mergedClearable: mergedClearableRef,\n            patternInputFocused: patternInputFocusedRef,\n            filterablePlaceholder: filterablePlaceholderRef,\n            label: labelRef,\n            selected: selectedRef,\n            showTagsPanel: showTagsPopoverRef,\n            isCompositing: isCompositingRef,\n            // dom ref\n            counterRef,\n            counterWrapperRef,\n            patternInputMirrorRef,\n            patternInputRef,\n            selfRef,\n            multipleElRef,\n            singleElRef,\n            patternInputWrapperRef,\n            overflowRef,\n            inputTagElRef,\n            handleMouseDown,\n            handleFocusin,\n            handleClear,\n            handleMouseEnter,\n            handleMouseLeave,\n            handleDeleteOption,\n            handlePatternKeyDown,\n            handlePatternInputInput,\n            handlePatternInputBlur,\n            handlePatternInputFocus,\n            handleMouseEnterCounter,\n            handleMouseLeaveCounter,\n            handleFocusout,\n            handleCompositionEnd,\n            handleCompositionStart,\n            onPopoverUpdateShow,\n            focus,\n            focusInput,\n            blur,\n            blurInput,\n            updateCounter,\n            getCounter,\n            getTail,\n            renderLabel: props.renderLabel,\n            cssVars: inlineThemeDisabled ? undefined : cssVarsRef,\n            themeClass: themeClassHandle === null || themeClassHandle === void 0 ? void 0 : themeClassHandle.themeClass,\n            onRender: themeClassHandle === null || themeClassHandle === void 0 ? void 0 : themeClassHandle.onRender\n        };\n    },\n    render() {\n        const { status, multiple, size, disabled, filterable, maxTagCount, bordered, clsPrefix, onRender, renderTag, renderLabel } = this;\n        onRender === null || onRender === void 0 ? void 0 : onRender();\n        const maxTagCountResponsive = maxTagCount === 'responsive';\n        const maxTagCountNumeric = typeof maxTagCount === 'number';\n        const useMaxTagCount = maxTagCountResponsive || maxTagCountNumeric;\n        const suffix = (h(Suffix, { clsPrefix: clsPrefix, loading: this.loading, showArrow: this.showArrow, showClear: this.mergedClearable && this.selected, onClear: this.handleClear }, {\n            default: () => { var _a, _b; return (_b = (_a = this.$slots).arrow) === null || _b === void 0 ? void 0 : _b.call(_a); }\n        }));\n        let body;\n        if (multiple) {\n            const createTag = (option) => (h(\"div\", { class: `${clsPrefix}-base-selection-tag-wrapper`, key: option.value }, renderTag ? (renderTag({\n                option,\n                handleClose: () => this.handleDeleteOption(option)\n            })) : (h(NTag, { size: size, closable: !option.disabled, disabled: disabled, internalStopClickPropagation: true, onClose: () => this.handleDeleteOption(option) }, {\n                default: () => renderLabel\n                    ? renderLabel(option, true)\n                    : render(option.label, option, true)\n            }))));\n            const originalTags = (maxTagCountNumeric\n                ? this.selectedOptions.slice(0, maxTagCount)\n                : this.selectedOptions).map(createTag);\n            const input = filterable ? (h(\"div\", { class: `${clsPrefix}-base-selection-input-tag`, ref: \"inputTagElRef\", key: \"__input-tag__\" },\n                h(\"input\", Object.assign({}, this.inputProps, { ref: \"patternInputRef\", tabindex: -1, disabled: disabled, value: this.pattern, autofocus: this.autofocus, class: `${clsPrefix}-base-selection-input-tag__input`, onBlur: this.handlePatternInputBlur, onFocus: this.handlePatternInputFocus, onKeydown: this.handlePatternKeyDown, onInput: this.handlePatternInputInput, onCompositionstart: this.handleCompositionStart, onCompositionend: this.handleCompositionEnd })),\n                h(\"span\", { ref: \"patternInputMirrorRef\", class: `${clsPrefix}-base-selection-input-tag__mirror` }, this.pattern))) : null;\n            // May Overflow\n            const renderCounter = maxTagCountResponsive\n                ? () => (h(\"div\", { class: `${clsPrefix}-base-selection-tag-wrapper`, ref: \"counterWrapperRef\" },\n                    h(NTag, { size: size, ref: \"counterRef\", onMouseenter: this.handleMouseEnterCounter, onMouseleave: this.handleMouseLeaveCounter, disabled: disabled })))\n                : undefined;\n            let counter;\n            if (maxTagCountNumeric) {\n                const rest = this.selectedOptions.length - maxTagCount;\n                if (rest > 0) {\n                    counter = (h(\"div\", { class: `${clsPrefix}-base-selection-tag-wrapper`, key: \"__counter__\" },\n                        h(NTag, { size: size, ref: \"counterRef\", onMouseenter: this.handleMouseEnterCounter, disabled: disabled }, {\n                            default: () => `+${rest}`\n                        })));\n                }\n            }\n            const tags = maxTagCountResponsive ? (filterable ? (h(VOverflow, { ref: \"overflowRef\", updateCounter: this.updateCounter, getCounter: this.getCounter, getTail: this.getTail, style: {\n                    width: '100%',\n                    display: 'flex',\n                    overflow: 'hidden'\n                } }, {\n                default: () => originalTags,\n                counter: renderCounter,\n                tail: () => input\n            })) : (h(VOverflow, { ref: \"overflowRef\", updateCounter: this.updateCounter, getCounter: this.getCounter, style: {\n                    width: '100%',\n                    display: 'flex',\n                    overflow: 'hidden'\n                } }, {\n                default: () => originalTags,\n                counter: renderCounter\n            }))) : maxTagCountNumeric ? (originalTags.concat(counter)) : (originalTags);\n            const renderPopover = useMaxTagCount\n                ? () => (h(\"div\", { class: `${clsPrefix}-base-selection-popover` }, maxTagCountResponsive\n                    ? originalTags\n                    : this.selectedOptions.map(createTag)))\n                : undefined;\n            const popoverProps = useMaxTagCount\n                ? {\n                    show: this.showTagsPanel,\n                    trigger: 'hover',\n                    overlap: true,\n                    placement: 'top',\n                    width: 'trigger',\n                    onUpdateShow: this.onPopoverUpdateShow,\n                    theme: this.mergedTheme.peers.Popover,\n                    themeOverrides: this.mergedTheme.peerOverrides.Popover\n                }\n                : null;\n            const showPlaceholder = this.selected\n                ? false\n                : this.active\n                    ? !this.pattern && !this.isCompositing\n                    : true;\n            const placeholder = showPlaceholder ? (h(\"div\", { class: `${clsPrefix}-base-selection-placeholder ${clsPrefix}-base-selection-overlay` }, this.placeholder)) : null;\n            if (filterable) {\n                const popoverTrigger = (h(\"div\", { ref: \"patternInputWrapperRef\", class: `${clsPrefix}-base-selection-tags` },\n                    tags,\n                    maxTagCountResponsive ? null : input,\n                    suffix));\n                body = (h(Fragment, null,\n                    useMaxTagCount ? (h(NPopover, Object.assign({}, popoverProps), {\n                        trigger: () => popoverTrigger,\n                        default: renderPopover\n                    })) : (popoverTrigger),\n                    placeholder));\n            }\n            else {\n                const popoverTrigger = (h(\"div\", { ref: \"multipleElRef\", class: `${clsPrefix}-base-selection-tags`, tabindex: disabled ? undefined : 0 },\n                    tags,\n                    suffix));\n                body = (h(Fragment, null,\n                    useMaxTagCount ? (h(NPopover, Object.assign({}, popoverProps), {\n                        trigger: () => popoverTrigger,\n                        default: renderPopover\n                    })) : (popoverTrigger),\n                    placeholder));\n            }\n        }\n        else {\n            if (filterable) {\n                const hasInput = this.pattern || this.isCompositing;\n                const showPlaceholder = this.active ? !hasInput : !this.selected;\n                const showSelectedLabel = this.active ? false : this.selected;\n                body = (h(\"div\", { ref: \"patternInputWrapperRef\", class: `${clsPrefix}-base-selection-label` },\n                    h(\"input\", Object.assign({}, this.inputProps, { ref: \"patternInputRef\", class: `${clsPrefix}-base-selection-input`, value: this.active ? this.pattern : '', placeholder: \"\", readonly: disabled, disabled: disabled, tabindex: -1, autofocus: this.autofocus, onFocus: this.handlePatternInputFocus, onBlur: this.handlePatternInputBlur, onInput: this.handlePatternInputInput, onCompositionstart: this.handleCompositionStart, onCompositionend: this.handleCompositionEnd })),\n                    showSelectedLabel ? (h(\"div\", { class: `${clsPrefix}-base-selection-label__render-label ${clsPrefix}-base-selection-overlay`, key: \"input\" },\n                        h(\"div\", { class: `${clsPrefix}-base-selection-overlay__wrapper` }, renderTag\n                            ? renderTag({\n                                option: this.selectedOption,\n                                handleClose: () => { }\n                            })\n                            : renderLabel\n                                ? renderLabel(this.selectedOption, true)\n                                : render(this.label, this.selectedOption, true)))) : null,\n                    showPlaceholder ? (h(\"div\", { class: `${clsPrefix}-base-selection-placeholder ${clsPrefix}-base-selection-overlay`, key: \"placeholder\" },\n                        h(\"div\", { class: `${clsPrefix}-base-selection-overlay__wrapper` }, this.filterablePlaceholder))) : null,\n                    suffix));\n            }\n            else {\n                body = (h(\"div\", { ref: \"singleElRef\", class: `${clsPrefix}-base-selection-label`, tabindex: this.disabled ? undefined : 0 },\n                    this.label !== undefined ? (h(\"div\", { class: `${clsPrefix}-base-selection-input`, title: getTitleAttribute(this.label), key: \"input\" },\n                        h(\"div\", { class: `${clsPrefix}-base-selection-input__content` }, renderTag\n                            ? renderTag({\n                                option: this.selectedOption,\n                                handleClose: () => { }\n                            })\n                            : renderLabel\n                                ? renderLabel(this.selectedOption, true)\n                                : render(this.label, this.selectedOption, true)))) : (h(\"div\", { class: `${clsPrefix}-base-selection-placeholder ${clsPrefix}-base-selection-overlay`, key: \"placeholder\" }, this.placeholder)),\n                    suffix));\n            }\n        }\n        return (h(\"div\", { ref: \"selfRef\", class: [\n                `${clsPrefix}-base-selection`,\n                this.themeClass,\n                status && `${clsPrefix}-base-selection--${status}-status`,\n                {\n                    [`${clsPrefix}-base-selection--active`]: this.active,\n                    [`${clsPrefix}-base-selection--selected`]: this.selected || (this.active && this.pattern),\n                    [`${clsPrefix}-base-selection--disabled`]: this.disabled,\n                    [`${clsPrefix}-base-selection--multiple`]: this.multiple,\n                    // focus is not controlled by selection itself since it always need\n                    // to be managed together with menu. provide :focus style will cause\n                    // many redundant codes.\n                    [`${clsPrefix}-base-selection--focus`]: this.focused\n                }\n            ], style: this.cssVars, onClick: this.onClick, onMouseenter: this.handleMouseEnter, onMouseleave: this.handleMouseLeave, onKeyup: this.onKeyup, onKeydown: this.onKeydown, onFocusin: this.handleFocusin, onFocusout: this.handleFocusout, onMousedown: this.handleMouseDown },\n            body,\n            bordered ? (h(\"div\", { class: `${clsPrefix}-base-selection__border` })) : null,\n            bordered ? (h(\"div\", { class: `${clsPrefix}-base-selection__state-border` })) : null));\n    }\n});\n"]},"metadata":{},"sourceType":"module"}