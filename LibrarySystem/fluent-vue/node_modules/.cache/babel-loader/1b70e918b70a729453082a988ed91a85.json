{"ast":null,"code":"import { defineComponent, computed, onMounted, ref, watchEffect } from 'vue';\nimport { round } from 'lodash-es';\nimport { tween } from './utils';\nimport { useLocale } from '../../_mixins';\nconst numberAnimationProps = {\n  to: {\n    type: Number,\n    default: 0\n  },\n  precision: {\n    type: Number,\n    default: 0\n  },\n  showSeparator: Boolean,\n  locale: String,\n  from: {\n    type: Number,\n    default: 0\n  },\n  active: {\n    type: Boolean,\n    default: true\n  },\n  duration: {\n    type: Number,\n    default: 2000\n  }\n};\nexport default defineComponent({\n  name: 'NumberAnimation',\n  props: numberAnimationProps,\n\n  setup(props) {\n    const {\n      localeRef\n    } = useLocale('name');\n    const {\n      duration\n    } = props;\n    const displayedValueRef = ref(props.from);\n    const mergedLocaleRef = computed(() => {\n      const {\n        locale\n      } = props;\n      if (locale !== undefined) return locale;\n      return localeRef.value;\n    });\n    let animating = false;\n\n    const onUpdate = currentValue => {\n      displayedValueRef.value = currentValue;\n    };\n\n    const onFinish = () => {\n      displayedValueRef.value = props.to;\n      animating = false;\n    };\n\n    const animate = (from = props.from, to = props.to) => {\n      animating = true;\n      displayedValueRef.value = props.from;\n\n      if (from !== to) {\n        tween({\n          from,\n          to,\n          duration: duration,\n          onUpdate,\n          onFinish\n        });\n      }\n    };\n\n    const formattedValueRef = computed(() => {\n      var _a;\n\n      const formatted = round(displayedValueRef.value, props.precision).toFixed(props.precision);\n      const splitValue = formatted.split('.');\n      const numberFormatter = new Intl.NumberFormat(mergedLocaleRef.value);\n      const decimalSeparator = (_a = numberFormatter.formatToParts(0.5).find(part => part.type === 'decimal')) === null || _a === void 0 ? void 0 : _a.value;\n      const integer = props.showSeparator ? numberFormatter.format(Number(splitValue[0])) : splitValue[0];\n      const decimal = splitValue[1];\n      return {\n        integer,\n        decimal,\n        decimalSeparator\n      };\n    });\n\n    function play() {\n      if (animating) return;\n      animate();\n    }\n\n    onMounted(() => {\n      watchEffect(() => {\n        if (props.active) animate();\n      });\n    });\n    const exposedMethods = {\n      play\n    };\n    return Object.assign({\n      formattedValue: formattedValueRef\n    }, exposedMethods);\n  },\n\n  render() {\n    const {\n      formattedValue: {\n        integer,\n        decimal,\n        decimalSeparator\n      }\n    } = this;\n    return [integer, decimal ? decimalSeparator : null, decimal];\n  }\n\n});","map":{"version":3,"sources":["G:/VUE_FDS/fluent-vue/node_modules/naive-ui/es/number-animation/src/NumberAnimation.js"],"names":["defineComponent","computed","onMounted","ref","watchEffect","round","tween","useLocale","numberAnimationProps","to","type","Number","default","precision","showSeparator","Boolean","locale","String","from","active","duration","name","props","setup","localeRef","displayedValueRef","mergedLocaleRef","undefined","value","animating","onUpdate","currentValue","onFinish","animate","formattedValueRef","_a","formatted","toFixed","splitValue","split","numberFormatter","Intl","NumberFormat","decimalSeparator","formatToParts","find","part","integer","format","decimal","play","exposedMethods","Object","assign","formattedValue","render"],"mappings":"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","sourcesContent":["import { defineComponent, computed, onMounted, ref, watchEffect } from 'vue';\nimport { round } from 'lodash-es';\nimport { tween } from './utils';\nimport { useLocale } from '../../_mixins';\nconst numberAnimationProps = {\n    to: {\n        type: Number,\n        default: 0\n    },\n    precision: {\n        type: Number,\n        default: 0\n    },\n    showSeparator: Boolean,\n    locale: String,\n    from: { type: Number, default: 0 },\n    active: {\n        type: Boolean,\n        default: true\n    },\n    duration: {\n        type: Number,\n        default: 2000\n    }\n};\nexport default defineComponent({\n    name: 'NumberAnimation',\n    props: numberAnimationProps,\n    setup(props) {\n        const { localeRef } = useLocale('name');\n        const { duration } = props;\n        const displayedValueRef = ref(props.from);\n        const mergedLocaleRef = computed(() => {\n            const { locale } = props;\n            if (locale !== undefined)\n                return locale;\n            return localeRef.value;\n        });\n        let animating = false;\n        const onUpdate = (currentValue) => {\n            displayedValueRef.value = currentValue;\n        };\n        const onFinish = () => {\n            displayedValueRef.value = props.to;\n            animating = false;\n        };\n        const animate = (from = props.from, to = props.to) => {\n            animating = true;\n            displayedValueRef.value = props.from;\n            if (from !== to) {\n                tween({\n                    from,\n                    to,\n                    duration: duration,\n                    onUpdate,\n                    onFinish\n                });\n            }\n        };\n        const formattedValueRef = computed(() => {\n            var _a;\n            const formatted = round(displayedValueRef.value, props.precision).toFixed(props.precision);\n            const splitValue = formatted.split('.');\n            const numberFormatter = new Intl.NumberFormat(mergedLocaleRef.value);\n            const decimalSeparator = (_a = numberFormatter\n                .formatToParts(0.5)\n                .find((part) => part.type === 'decimal')) === null || _a === void 0 ? void 0 : _a.value;\n            const integer = props.showSeparator\n                ? numberFormatter.format(Number(splitValue[0]))\n                : splitValue[0];\n            const decimal = splitValue[1];\n            return {\n                integer,\n                decimal,\n                decimalSeparator\n            };\n        });\n        function play() {\n            if (animating)\n                return;\n            animate();\n        }\n        onMounted(() => {\n            watchEffect(() => {\n                if (props.active)\n                    animate();\n            });\n        });\n        const exposedMethods = { play };\n        return Object.assign({ formattedValue: formattedValueRef }, exposedMethods);\n    },\n    render() {\n        const { formattedValue: { integer, decimal, decimalSeparator } } = this;\n        return [integer, decimal ? decimalSeparator : null, decimal];\n    }\n});\n"]},"metadata":{},"sourceType":"module"}